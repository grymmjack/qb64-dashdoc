<!DOCTYPE html>
<html class="client-nojs" dir="ltr" lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Downloading Files - QB64 Phoenix Edition Wiki
  </title>
  <script>
   document.documentElement.className="client-js";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"Zpp7HY_rYEQRpdCCob5aWAAAAR8","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Downloading_Files","wgTitle":"Downloading Files","wgCurRevisionId":7591,"wgRevisionId":7591,"wgArticleId":23,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Downloading_Files","wgRelevantArticleId":23,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgVector2022PreviewPages":[]};RLSTATE={"site.styles":"ready",
"user.styles":"ready","user":"ready","user.options":"loading","skins.vector.styles.legacy":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.js"];
  </script>
  <script>
   (RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});
  </script>
  <link href="/qb64wiki/load.php?lang=en&amp;modules=skins.vector.styles.legacy&amp;only=styles&amp;skin=vector" rel="stylesheet"/>
  <script async="" src="/qb64wiki/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector">
  </script>
  <meta content="" name="ResourceLoaderDynamicStyles"/>
  <link href="/qb64wiki/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector" rel="stylesheet"/>
  <meta content="MediaWiki 1.39.3" name="generator"/>
  <meta content="telephone=no" name="format-detection"/>
  <meta content="width=1000" name="viewport"/>
  <link href="/favicon.ico" rel="icon"/>
  <link href="/qb64wiki/opensearch_desc.php" rel="search" title="QB64 Phoenix Edition Wiki (en)" type="application/opensearchdescription+xml"/>
  <link href="https://qb64phoenix.com/qb64wiki/api.php?action=rsd" rel="EditURI" type="application/rsd+xml"/>
  <link href="/qb64wiki/index.php?title=Special:RecentChanges&amp;feed=atom" rel="alternate" title="QB64 Phoenix Edition Wiki Atom feed" type="application/atom+xml"/>
 </head>
 <body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Downloading_Files rootpage-Downloading_Files skin-vector action-view skin-vector-legacy vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
  <div class="noprint" id="mw-page-base">
  </div>
  <div class="noprint" id="mw-head-base">
  </div>
  <div class="mw-body" id="content" role="main">
   <a id="top">
   </a>
   <div id="siteNotice">
   </div>
   <div class="mw-indicators">
   </div>
   <h1 class="firstHeading mw-first-heading" id="firstHeading">
    <span class="mw-page-title-main">
     Downloading Files
    </span>
   </h1>
   <div class="vector-body" id="bodyContent">
    <div class="noprint" id="siteSub">
     From QB64 Phoenix Edition Wiki
    </div>
    <div id="contentSub">
    </div>
    <div id="contentSub2">
    </div>
    <div id="jump-to-nav">
    </div>
    <a class="mw-jump-link" href="#mw-head">
     Jump to navigation
    </a>
    <a class="mw-jump-link" href="#searchInput">
     Jump to search
    </a>
    <div class="mw-body-content mw-content-ltr" dir="ltr" id="mw-content-text" lang="en">
     <div class="mw-parser-output">
      <p>
       <b>
        QB64-PE
       </b>
       starting in
       <b>
        v3.5.0
       </b>
       includes built-in support for making HTTP requests and receiving their responses. This functionality is implemented in
       <a href="/qb64wiki/index.php/OPENCLIENT" title="OPENCLIENT">
        _OPENCLIENT
       </a>
       , and the resulting HTTP handle can then be provided the various existing or new stream commands to interact with the response.
      </p>
      <p>
       <span style="color:red;">
        <b>
         HTTP functionality is current unstable, and requires
         <a href="/qb64wiki/index.php/$UNSTABLE" title="$UNSTABLE">
          $UNSTABLE
         </a>
         :HTTP to be able to use.
        </b>
       </span>
      </p>
      <p>
       <br/>
      </p>
      <table align="right" style="max-width:25%;">
       <tbody>
        <tr>
         <td>
          <div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation">
           <input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/>
           <div class="toctitle" dir="ltr" lang="en">
            <h2 id="mw-toc-heading">
             Contents
            </h2>
            <span class="toctogglespan">
             <label class="toctogglelabel" for="toctogglecheckbox">
             </label>
            </span>
           </div>
           <ul>
            <li class="toclevel-1 tocsection-1">
             <a href="#Starting_the_Connection">
              <span class="tocnumber">
               1
              </span>
              <span class="toctext">
               Starting the Connection
              </span>
             </a>
            </li>
            <li class="toclevel-1 tocsection-2">
             <a href="#Metadata_About_the_HTTP_Response">
              <span class="tocnumber">
               2
              </span>
              <span class="toctext">
               Metadata About the HTTP Response
              </span>
             </a>
            </li>
            <li class="toclevel-1 tocsection-3">
             <a href="#Reading_the_HTTP_Response_Content">
              <span class="tocnumber">
               3
              </span>
              <span class="toctext">
               Reading the HTTP Response Content
              </span>
             </a>
            </li>
            <li class="toclevel-1 tocsection-4">
             <a href="#Closing_The_HTTP_handle">
              <span class="tocnumber">
               4
              </span>
              <span class="toctext">
               Closing The HTTP handle
              </span>
             </a>
            </li>
            <li class="toclevel-1">
             <a href="#Examples">
              <span class="tocnumber">
               5
              </span>
              <span class="toctext">
               Examples
              </span>
             </a>
            </li>
           </ul>
          </div>
         </td>
        </tr>
       </tbody>
      </table>
      <h2>
       <span class="mw-headline" id="Starting_the_Connection">
        Starting the Connection
       </span>
      </h2>
      <p>
       <a href="/qb64wiki/index.php/OPENCLIENT" title="OPENCLIENT">
        _OPENCLIENT
       </a>
       is used to make an HTTP request, via using the
       <b>
        HTTP:
       </b>
       scheme. The string provided to
       <a href="/qb64wiki/index.php/OPENCLIENT" title="OPENCLIENT">
        _OPENCLIENT
       </a>
       should be of the form "
       <b>
        HTTP:
       </b>
       url", where
       <b>
        url
       </b>
       is the HTTP url you want to make a request too. This can include anything valid in a URL, such as a port, resource path, query string, or fragment. The call to
       <a href="/qb64wiki/index.php/OPENCLIENT" title="OPENCLIENT">
        _OPENCLIENT
       </a>
       will then return a handle to the HTTP connection which can be provided to all the rest of the commands related to HTTP requests. If the HTTP request cannot be made (for example, the domain is invalid) then zero is returned instead of a valid handle.
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Metadata_About_the_HTTP_Response">
        Metadata About the HTTP Response
       </span>
      </h2>
      <p>
       The below commands all give metadata about the HTTP response. They're ordered in terms of usefulness:
      </p>
      <ul>
       <li>
        <a href="/qb64wiki/index.php/STATUSCODE" title="STATUSCODE">
         _STATUSCODE
        </a>
        can be used to get the HTTP status code given in the HTTP response (Ex. 200, 404, 500, ...)
       </li>
       <li>
        <a href="/qb64wiki/index.php/LOF" title="LOF">
         LOF
        </a>
        will return the 'Content Length' of the HTTP response if it was provided. It gives -1 if it is not known.
       </li>
       <li>
        <a href="/qb64wiki/index.php/EOF" title="EOF">
         EOF
        </a>
        Will return whether the entire HTTP response has been read using
        <a href="/qb64wiki/index.php/GET_(HTTP_statement)" title="GET (HTTP statement)">
         GET
        </a>
        .
       </li>
       <li>
        <a class="mw-redirect" href="/qb64wiki/index.php/CONNECTIONADDRESS$" title="CONNECTIONADDRESS$">
         _CONNECTIONADDRESS$
        </a>
        can be used to get the "Effective URL" that was connected too, after taking redirects into account.
       </li>
       <li>
        <a href="/qb64wiki/index.php/CONNECTED" title="CONNECTED">
         _CONNECTED
        </a>
        can be used to determine whether the HTTP connection to the server is still open.
       </li>
      </ul>
      <p>
       In general for most HTTP responses you should ignore
       <a href="/qb64wiki/index.php/CONNECTED" title="CONNECTED">
        _CONNECTED
       </a>
       and only make use of
       <a href="/qb64wiki/index.php/EOF" title="EOF">
        EOF
       </a>
       .
       <a href="/qb64wiki/index.php/EOF" title="EOF">
        EOF
       </a>
       will continue to return false until you have read all the data from the HTTP response and the connection has been closed, where-as
       <a href="/qb64wiki/index.php/CONNECTED" title="CONNECTED">
        _CONNECTED
       </a>
       will return false even if you still have data to read.
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Reading_the_HTTP_Response_Content">
        Reading the HTTP Response Content
       </span>
      </h2>
      <p>
       <a href="/qb64wiki/index.php/GET_(HTTP_statement)" title="GET (HTTP statement)">
        GET
       </a>
       is used to read the data from the HTTP response. It should be used with a variable length string, which will then be resized by
       <a href="/qb64wiki/index.php/GET_(HTTP_statement)" title="GET (HTTP statement)">
        GET
       </a>
       so that it contains all the data current available for the HTTP response. You can then either parse the data as it comes, or collect it all together to parse later. Data is available for reading with
       <a href="/qb64wiki/index.php/GET_(HTTP_statement)" title="GET (HTTP statement)">
        GET
       </a>
       until
       <a href="/qb64wiki/index.php/EOF" title="EOF">
        EOF
       </a>
       returns true. A
       <a href="/qb64wiki/index.php/LIMIT" title="LIMIT">
        _LIMIT
       </a>
       or similar delay should be put in place when looping and using
       <a href="/qb64wiki/index.php/GET_(HTTP_statement)" title="GET (HTTP statement)">
        GET
       </a>
       so that you don't use up too much CPU time. The actual downloading happens on a separate thread in your program, so how often you call
       <a href="/qb64wiki/index.php/GET_(HTTP_statement)" title="GET (HTTP statement)">
        GET
       </a>
       has no impact on how fast the download is.
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Closing_The_HTTP_handle">
        Closing The HTTP handle
       </span>
      </h2>
      <p>
       Like any handle returned from
       <a href="/qb64wiki/index.php/OPENCLIENT" title="OPENCLIENT">
        _OPENCLIENT
       </a>
       , all HTTP handles need to be closed by using
       <a href="/qb64wiki/index.php/CLOSE" title="CLOSE">
        CLOSE
       </a>
       when you are finished with them.
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Examples">
        Examples
       </span>
      </h2>
      <dl>
       <dt>
        Example 1
       </dt>
       <dd>
        This function provides basic download functionality. The downloaded data will returned in a string, and the statuscode is provided so that you can check whether the request was successful.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">' Content of the HTTP response is returned.
' The statusCode is also assigned.
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> Download$(url <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, statusCode <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
    <a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> h <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, content <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, s <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>

    h = <a href="/qb64wiki/index.php/OPENCLIENT" title="OPENCLIENT"><span style="color:#4593D8;">_OPENCLIENT</span></a>("HTTP:" + url)

    statusCode = <a href="/qb64wiki/index.php/STATUSCODE" title="STATUSCODE"><span style="color:#4593D8;">_STATUSCODE</span></a>(h)

    <a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/NOT" title="NOT"><span style="color:#4593D8;">NOT</span></a> <a href="/qb64wiki/index.php/EOF" title="EOF"><span style="color:#4593D8;">EOF</span></a>(h)
        <a href="/qb64wiki/index.php/LIMIT" title="LIMIT"><span style="color:#4593D8;">_LIMIT</span></a> 60
        <a href="/qb64wiki/index.php/GET_(HTTP_statement)" title="GET (HTTP statement)"><span style="color:#4593D8;">GET</span></a> #h, , s
        content = content + s
    <a class="mw-redirect" href="/qb64wiki/index.php/WEND" title="WEND"><span style="color:#4593D8;">WEND</span></a>

    <a href="/qb64wiki/index.php/CLOSE" title="CLOSE"><span style="color:#4593D8;">CLOSE</span></a> #h

    Download$ = content
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <hr/>
      <dl>
       <dt>
        Example 2
       </dt>
       <dd>
        This shows how you could modify the basic usage to provide a progress bar. Note that displaying progress is only possible if the server gives a `Content-length` header back in the response, which will be indicating to you via the result of
        <a href="/qb64wiki/index.php/LOF" title="LOF">
         LOF
        </a>
        on the handle:
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> DownloadWithProgress$(url <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, statusCode <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
    <a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> h <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, content <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, s <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, length <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    <a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> progress <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/DOUBLE" title="DOUBLE"><span style="color:#4593D8;">DOUBLE</span></a>

    h = <a href="/qb64wiki/index.php/OPENCLIENT" title="OPENCLIENT"><span style="color:#4593D8;">_OPENCLIENT</span></a>("HTTP:" + url)

    statusCode = <a href="/qb64wiki/index.php/STATUSCODE" title="STATUSCODE"><span style="color:#4593D8;">_STATUSCODE</span></a>(h)

    length = <a href="/qb64wiki/index.php/LOF" title="LOF"><span style="color:#4593D8;">LOF</span></a>(h)

    <a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/NOT" title="NOT"><span style="color:#4593D8;">NOT</span></a> <a href="/qb64wiki/index.php/EOF" title="EOF"><span style="color:#4593D8;">EOF</span></a>(h)
        <a href="/qb64wiki/index.php/LIMIT" title="LIMIT"><span style="color:#4593D8;">_LIMIT</span></a> 60
        <a href="/qb64wiki/index.php/GET_(HTTP_statement)" title="GET (HTTP statement)"><span style="color:#4593D8;">GET</span></a> #h, , s
        content = content + s

        ' Display a progress bar if the Content-Length was provided
        <a class="mw-redirect" href="/qb64wiki/index.php/IF" title="IF"><span style="color:#4593D8;">IF</span></a> length &lt;&gt; -1 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
            progress = <a href="/qb64wiki/index.php/CDBL" title="CDBL"><span style="color:#4593D8;">CDBL</span></a>(<a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(content)) / length

            <a href="/qb64wiki/index.php/LOCATE" title="LOCATE"><span style="color:#4593D8;">LOCATE</span></a> 1, 1
            <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "[";
            <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(progress * 78, "*");
            <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(78 - progress * 78, " ");
            <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "]";
        <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
            <a href="/qb64wiki/index.php/LOCATE" title="LOCATE"><span style="color:#4593D8;">LOCATE</span></a> 1, 1
            <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "[ Downloading..."; <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(80 - 17, " "); "]";
        <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
    <a class="mw-redirect" href="/qb64wiki/index.php/WEND" title="WEND"><span style="color:#4593D8;">WEND</span></a>

    <a href="/qb64wiki/index.php/CLOSE" title="CLOSE"><span style="color:#4593D8;">CLOSE</span></a> #h

    Download$ = content
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <hr/>
      <dl>
       <dt>
        Example 3
       </dt>
       <dd>
        This shows processing multiple downloads at the same time, with progress for each (Again keeping in mind that progress only works if
        <a href="/qb64wiki/index.php/LOF" title="LOF">
         LOF
        </a>
        gives a valid length):
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/SUB" title="SUB"><span style="color:#4593D8;">SUB</span></a> DownloadMultipleWithProgress()
    <a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> handles(1 To 3) <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    <a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> content(1 To 3) <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
    <a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> length(1 to 3) <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    <a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> i <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, progress <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/DOUBLE" title="DOUBLE"><span style="color:#4593D8;">DOUBLE</span></a>
    <a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> EndOfFile <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, s <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>

    handles(1) = <a href="/qb64wiki/index.php/OPENCLIENT" title="OPENCLIENT"><span style="color:#4593D8;">_OPENCLIENT</span></a>("HTTP:https://www.google.com")
    handles(2) = <a href="/qb64wiki/index.php/OPENCLIENT" title="OPENCLIENT"><span style="color:#4593D8;">_OPENCLIENT</span></a>("HTTP:https://www.google.com")
    handles(3) = <a href="/qb64wiki/index.php/OPENCLIENT" title="OPENCLIENT"><span style="color:#4593D8;">_OPENCLIENT</span></a>("HTTP:https://www.google.com")

    <a href="/qb64wiki/index.php/FOR" title="FOR"><span style="color:#4593D8;">FOR</span></a> i = 1 To <a href="/qb64wiki/index.php/UBOUND" title="UBOUND"><span style="color:#4593D8;">UBOUND</span></a>(handles)
        length(i) = <a href="/qb64wiki/index.php/LOF" title="LOF"><span style="color:#4593D8;">LOF</span></a>(handles(i))
    <a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:#4593D8;">NEXT</span></a>

    <a class="mw-redirect" href="/qb64wiki/index.php/DO" title="DO"><span style="color:#4593D8;">DO</span></a>
        <a href="/qb64wiki/index.php/LIMIT" title="LIMIT"><span style="color:#4593D8;">_LIMIT</span></a> 60
        EndOfFile = -1

        <a href="/qb64wiki/index.php/FOR" title="FOR"><span style="color:#4593D8;">FOR</span></a> i = 1 To <a href="/qb64wiki/index.php/UBOUND" title="UBOUND"><span style="color:#4593D8;">UBOUND</span></a>(handles)
            <a class="mw-redirect" href="/qb64wiki/index.php/IF" title="IF"><span style="color:#4593D8;">IF</span></a> handles(i) = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/CONTINUE" title="CONTINUE"><span style="color:#4593D8;">_CONTINUE</span></a>

            <a class="mw-redirect" href="/qb64wiki/index.php/IF" title="IF"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/EOF" title="EOF"><span style="color:#4593D8;">EOF</span></a>(handles(i)) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
                <a href="/qb64wiki/index.php/CLOSE" title="CLOSE"><span style="color:#4593D8;">CLOSE</span></a> #handles(i)
                handles(i) = 0
                <a href="/qb64wiki/index.php/CONTINUE" title="CONTINUE"><span style="color:#4593D8;">_CONTINUE</span></a>
            <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

            EndOfFile = 0

            <a href="/qb64wiki/index.php/GET_(HTTP_statement)" title="GET (HTTP statement)"><span style="color:#4593D8;">GET</span></a> #handles(i), , s
            content(i) = content(i) + s

            ' Display a progress bar if the
            ' Content-Length was provided
            <a class="mw-redirect" href="/qb64wiki/index.php/IF" title="IF"><span style="color:#4593D8;">IF</span></a> length &lt;&gt; -1 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
                progress = <a href="/qb64wiki/index.php/CDBL" title="CDBL"><span style="color:#4593D8;">CDBL</span></a>(<a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(content(i))) / length(i)
                <a href="/qb64wiki/index.php/LOCATE" title="LOCATE"><span style="color:#4593D8;">LOCATE</span></a> i, 1
                <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "[";
                <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(progress * 78, "*");
                <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(78 - progress * 78, " ");
                <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "]";
            <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
                <a href="/qb64wiki/index.php/LOCATE" title="LOCATE"><span style="color:#4593D8;">LOCATE</span></a> i, 1
                <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "[ Downloading..."; <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(80 - 17, " "); "]";
            <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
        <a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:#4593D8;">NEXT</span></a>
    <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> While <a href="/qb64wiki/index.php/NOT" title="NOT"><span style="color:#4593D8;">NOT</span></a> EndOfFile

    ' The content() array now contains the results of the downloads
<a href="/qb64wiki/index.php/END_SUB" title="END SUB"><span style="color:#4593D8;">END SUB</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <hr/>
      <dl>
       <dt>
        Example 4
       </dt>
       <dd>
        This shows downloading straight to a file by providing the open file number. This approach is much more memory efficient if the HTTP response is large:
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">' Returns the status code of the HTTP response
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> DownloadToFile&amp;(url <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, fileHandle <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
    <a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> h <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, content <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, s <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>

    h = <a href="/qb64wiki/index.php/OPENCLIENT" title="OPENCLIENT"><span style="color:#4593D8;">_OPENCLIENT</span></a>("HTTP:" + url)

    DownloadToFile&amp; = <a href="/qb64wiki/index.php/STATUSCODE" title="STATUSCODE"><span style="color:#4593D8;">_STATUSCODE</span></a>(h)

    <a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/NOT" title="NOT"><span style="color:#4593D8;">NOT</span></a> <a href="/qb64wiki/index.php/EOF" title="EOF"><span style="color:#4593D8;">EOF</span></a>(h)
        <a href="/qb64wiki/index.php/LIMIT" title="LIMIT"><span style="color:#4593D8;">_LIMIT</span></a> 60
        <a href="/qb64wiki/index.php/GET_(HTTP_statement)" title="GET (HTTP statement)"><span style="color:#4593D8;">GET</span></a> #h, , s
        <a href="/qb64wiki/index.php/PUT" title="PUT"><span style="color:#4593D8;">PUT</span></a> #fileHandle, , s
    <a class="mw-redirect" href="/qb64wiki/index.php/WEND" title="WEND"><span style="color:#4593D8;">WEND</span></a>

    <a href="/qb64wiki/index.php/CLOSE" title="CLOSE"><span style="color:#4593D8;">CLOSE</span></a> #h
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <p>
       <br/>
      </p>
      <hr/>
      <center>
       <b>
        Navigation:
       </b>
      </center>
      <center>
       <a href="/qb64wiki/index.php/Main_Page" title="Main Page">
        Main Page with Articles and Tutorials
       </a>
      </center>
      <center>
       <a href="/qb64wiki/index.php/Keyword_Reference_-_Alphabetical" title="Keyword Reference - Alphabetical">
        Keyword Reference - Alphabetical
       </a>
      </center>
      <center>
       <a href="/qb64wiki/index.php/Keyword_Reference_-_By_usage" title="Keyword Reference - By usage">
        Keyword Reference - By usage
       </a>
      </center>
      <center>
       <b>
        <a class="external text" href="https://qb64phoenix.com/forum/showthread.php?tid=2800" rel="nofollow">
         Report a broken link
        </a>
       </b>
       <br/>
      </center>
      <!-- 
NewPP limit report
Cached time: 20240719142758
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.076 seconds
Real time usage: 0.092 seconds
Preprocessor visited node count: 1120/1000000
Post‐expand include size: 8458/2097152 bytes
Template argument size: 1591/2097152 bytes
Highest expansion depth: 3/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 66/5000000 bytes
-->
      <!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   36.241      1 -total
 31.26%   11.328    150 Template:Cl
  9.26%    3.357      1 Template:Text
  8.20%    2.970      1 Template:PageNavigation
  6.98%    2.528      4 Template:CodeEnd
  6.81%    2.469      1 Template:PageExamples
  6.19%    2.245      4 Template:CodeStart
-->
      <!-- Saved in parser cache with key qb64pnix_mw19894-mwmb_:pcache:idhash:23-0!canonical and timestamp 20240719142758 and revision id 7591.
 -->
     </div>
     <div class="printfooter" data-nosnippet="">
      Retrieved from "
      <a dir="ltr" href="https://qb64phoenix.com/qb64wiki/index.php?title=Downloading_Files&amp;oldid=7591">
       https://qb64phoenix.com/qb64wiki/index.php?title=Downloading_Files&amp;oldid=7591
      </a>
      "
     </div>
    </div>
    <div class="catlinks catlinks-allhidden" data-mw="interface" id="catlinks">
    </div>
   </div>
  </div>
  <div id="mw-navigation">
   <h2>
    Navigation menu
   </h2>
   <div id="mw-head">
    <nav aria-labelledby="p-personal-label" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu-legacy" id="p-personal" role="navigation">
     <h3 class="vector-menu-heading" id="p-personal-label">
      <span class="vector-menu-heading-label">
       Personal tools
      </span>
     </h3>
     <div class="vector-menu-content">
      <ul class="vector-menu-content-list">
       <li class="mw-list-item" id="pt-login">
        <a accesskey="o" href="/qb64wiki/index.php?title=Special:UserLogin&amp;returnto=Downloading+Files" title="You are encouraged to log in; however, it is not mandatory [o]">
         <span>
          Log in
         </span>
        </a>
       </li>
      </ul>
     </div>
    </nav>
    <div id="left-navigation">
     <nav aria-labelledby="p-namespaces-label" class="vector-menu mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy" id="p-namespaces" role="navigation">
      <h3 class="vector-menu-heading" id="p-namespaces-label">
       <span class="vector-menu-heading-label">
        Namespaces
       </span>
      </h3>
      <div class="vector-menu-content">
       <ul class="vector-menu-content-list">
        <li class="selected mw-list-item" id="ca-nstab-main">
         <a accesskey="c" href="/qb64wiki/index.php/Downloading_Files" title="View the content page [c]">
          <span>
           Page
          </span>
         </a>
        </li>
        <li class="new mw-list-item" id="ca-talk">
         <a accesskey="t" href="/qb64wiki/index.php?title=Talk:Downloading_Files&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]">
          <span>
           Discussion
          </span>
         </a>
        </li>
       </ul>
      </div>
     </nav>
     <nav aria-labelledby="p-variants-label" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown" id="p-variants" role="navigation">
      <input aria-haspopup="true" aria-labelledby="p-variants-label" class="vector-menu-checkbox" data-event-name="ui.dropdown-p-variants" id="p-variants-checkbox" role="button" type="checkbox"/>
      <label aria-label="Change language variant" class="vector-menu-heading" id="p-variants-label">
       <span class="vector-menu-heading-label">
        English
       </span>
      </label>
      <div class="vector-menu-content">
       <ul class="vector-menu-content-list">
       </ul>
      </div>
     </nav>
    </div>
    <div id="right-navigation">
     <nav aria-labelledby="p-views-label" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy" id="p-views" role="navigation">
      <h3 class="vector-menu-heading" id="p-views-label">
       <span class="vector-menu-heading-label">
        Views
       </span>
      </h3>
      <div class="vector-menu-content">
       <ul class="vector-menu-content-list">
        <li class="selected mw-list-item" id="ca-view">
         <a href="/qb64wiki/index.php/Downloading_Files">
          <span>
           Read
          </span>
         </a>
        </li>
        <li class="mw-list-item" id="ca-viewsource">
         <a accesskey="e" href="/qb64wiki/index.php?title=Downloading_Files&amp;action=edit" title="This page is protected.
You can view its source [e]">
          <span>
           View source
          </span>
         </a>
        </li>
        <li class="mw-list-item" id="ca-history">
         <a accesskey="h" href="/qb64wiki/index.php?title=Downloading_Files&amp;action=history" title="Past revisions of this page [h]">
          <span>
           View history
          </span>
         </a>
        </li>
       </ul>
      </div>
     </nav>
     <nav aria-labelledby="p-cactions-label" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown" id="p-cactions" role="navigation" title="More options">
      <input aria-haspopup="true" aria-labelledby="p-cactions-label" class="vector-menu-checkbox" data-event-name="ui.dropdown-p-cactions" id="p-cactions-checkbox" role="button" type="checkbox"/>
      <label class="vector-menu-heading" id="p-cactions-label">
       <span class="vector-menu-heading-label">
        More
       </span>
      </label>
      <div class="vector-menu-content">
       <ul class="vector-menu-content-list">
       </ul>
      </div>
     </nav>
     <div class="vector-search-box-vue vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box" id="p-search" role="search">
      <div>
       <h3>
        <label for="searchInput">
         Search
        </label>
       </h3>
       <form action="/qb64wiki/index.php" class="vector-search-box-form" id="searchform">
        <div class="vector-search-box-inner" data-search-loc="header-navigation" id="simpleSearch">
         <input accesskey="f" aria-label="Search QB64 Phoenix Edition Wiki" autocapitalize="sentences" class="vector-search-box-input" id="searchInput" name="search" placeholder="Search QB64 Phoenix Edition Wiki" title="Search QB64 Phoenix Edition Wiki [f]" type="search"/>
         <input name="title" type="hidden" value="Special:Search"/>
         <input class="searchButton mw-fallbackSearchButton" id="mw-searchButton" name="fulltext" title="Search the pages for this text" type="submit" value="Search"/>
         <input class="searchButton" id="searchButton" name="go" title="Go to a page with this exact name if it exists" type="submit" value="Go"/>
        </div>
       </form>
      </div>
     </div>
    </div>
   </div>
   <div id="mw-panel">
    <div id="p-logo" role="banner">
     <a class="mw-wiki-logo" href="/qb64wiki/index.php/Main_Page" title="Visit the main page">
     </a>
    </div>
    <nav aria-labelledby="p-navigation-label" class="vector-menu mw-portlet mw-portlet-navigation vector-menu-portal portal" id="p-navigation" role="navigation">
     <h3 class="vector-menu-heading" id="p-navigation-label">
      <span class="vector-menu-heading-label">
       Navigation
      </span>
     </h3>
     <div class="vector-menu-content">
      <ul class="vector-menu-content-list">
       <li class="mw-list-item" id="n-mainpage-description">
        <a accesskey="z" href="/qb64wiki/index.php/Main_Page" title="Visit the main page [z]">
         <span>
          Main page
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="n-recentchanges">
        <a accesskey="r" href="/qb64wiki/index.php/Special:RecentChanges" title="A list of recent changes in the wiki [r]">
         <span>
          Recent changes
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="n-randompage">
        <a accesskey="x" href="/qb64wiki/index.php/Special:Random" title="Load a random page [x]">
         <span>
          Random page
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="n-help-mediawiki">
        <a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents">
         <span>
          Help about MediaWiki
         </span>
        </a>
       </li>
      </ul>
     </div>
    </nav>
    <nav aria-labelledby="p-tb-label" class="vector-menu mw-portlet mw-portlet-tb vector-menu-portal portal" id="p-tb" role="navigation">
     <h3 class="vector-menu-heading" id="p-tb-label">
      <span class="vector-menu-heading-label">
       Tools
      </span>
     </h3>
     <div class="vector-menu-content">
      <ul class="vector-menu-content-list">
       <li class="mw-list-item" id="t-whatlinkshere">
        <a accesskey="j" href="/qb64wiki/index.php/Special:WhatLinksHere/Downloading_Files" title="A list of all wiki pages that link here [j]">
         <span>
          What links here
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="t-recentchangeslinked">
        <a accesskey="k" href="/qb64wiki/index.php/Special:RecentChangesLinked/Downloading_Files" rel="nofollow" title="Recent changes in pages linked from this page [k]">
         <span>
          Related changes
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="t-specialpages">
        <a accesskey="q" href="/qb64wiki/index.php/Special:SpecialPages" title="A list of all special pages [q]">
         <span>
          Special pages
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="t-print">
        <a accesskey="p" href="javascript:print();" rel="alternate" title="Printable version of this page [p]">
         <span>
          Printable version
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="t-permalink">
        <a href="/qb64wiki/index.php?title=Downloading_Files&amp;oldid=7591" title="Permanent link to this revision of this page">
         <span>
          Permanent link
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="t-info">
        <a href="/qb64wiki/index.php?title=Downloading_Files&amp;action=info" title="More information about this page">
         <span>
          Page information
         </span>
        </a>
       </li>
      </ul>
     </div>
    </nav>
   </div>
  </div>
  <footer class="mw-footer" id="footer" role="contentinfo">
   <ul id="footer-info">
    <li id="footer-info-lastmod">
     This page was last edited on 30 January 2023, at 18:22.
    </li>
   </ul>
   <ul id="footer-places">
    <li id="footer-places-privacy">
     <a href="/qb64wiki/index.php/QB64_Phoenix_Edition_Wiki:Privacy_policy">
      Privacy policy
     </a>
    </li>
    <li id="footer-places-about">
     <a href="/qb64wiki/index.php/QB64_Phoenix_Edition_Wiki:About">
      About QB64 Phoenix Edition Wiki
     </a>
    </li>
    <li id="footer-places-disclaimer">
     <a href="/qb64wiki/index.php/QB64_Phoenix_Edition_Wiki:General_disclaimer">
      Disclaimers
     </a>
    </li>
   </ul>
   <ul class="noprint" id="footer-icons">
    <li id="footer-poweredbyico">
     <a href="https://www.mediawiki.org/">
      <img alt="Powered by MediaWiki" height="31" loading="lazy" src="/qb64wiki/resources/assets/poweredby_mediawiki_88x31.png" srcset="/qb64wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /qb64wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88"/>
     </a>
    </li>
   </ul>
  </footer>
  <script>
   (RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.076","walltime":"0.092","ppvisitednodes":{"value":1120,"limit":1000000},"postexpandincludesize":{"value":8458,"limit":2097152},"templateargumentsize":{"value":1591,"limit":2097152},"expansiondepth":{"value":3,"limit":100},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":66,"limit":5000000},"timingprofile":["100.00%   36.241      1 -total"," 31.26%   11.328    150 Template:Cl","  9.26%    3.357      1 Template:Text","  8.20%    2.970      1 Template:PageNavigation","  6.98%    2.528      4 Template:CodeEnd","  6.81%    2.469      1 Template:PageExamples","  6.19%    2.245      4 Template:CodeStart"]},"cachereport":{"timestamp":"20240719142758","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":100});});
  </script>
 </body>
</html>
