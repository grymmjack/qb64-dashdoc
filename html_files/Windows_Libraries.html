<!DOCTYPE html>
<html class="client-nojs" dir="ltr" lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Windows Libraries - QB64 Phoenix Edition Wiki
  </title>
  <script>
   document.documentElement.className="client-js";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"Zp2HVIVyUtajyJ55jofDtAAAAYY","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Windows_Libraries","wgTitle":"Windows Libraries","wgCurRevisionId":8807,"wgRevisionId":8807,"wgArticleId":18,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Windows_Libraries","wgRelevantArticleId":18,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgVector2022PreviewPages":[]};RLSTATE={"site.styles":"ready",
"user.styles":"ready","user":"ready","user.options":"loading","skins.vector.styles.legacy":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","skins.vector.legacy.js"];
  </script>
  <script>
   (RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});
  </script>
  <link href="/qb64wiki/load.php?lang=en&amp;modules=skins.vector.styles.legacy&amp;only=styles&amp;skin=vector" rel="stylesheet"/>
  <script async="" src="/qb64wiki/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector">
  </script>
  <meta content="" name="ResourceLoaderDynamicStyles"/>
  <link href="/qb64wiki/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector" rel="stylesheet"/>
  <meta content="MediaWiki 1.39.3" name="generator"/>
  <meta content="telephone=no" name="format-detection"/>
  <meta content="width=1000" name="viewport"/>
  <link href="/favicon.ico" rel="icon"/>
  <link href="/qb64wiki/opensearch_desc.php" rel="search" title="QB64 Phoenix Edition Wiki (en)" type="application/opensearchdescription+xml"/>
  <link href="https://qb64phoenix.com/qb64wiki/api.php?action=rsd" rel="EditURI" type="application/rsd+xml"/>
  <link href="/qb64wiki/index.php?title=Special:RecentChanges&amp;feed=atom" rel="alternate" title="QB64 Phoenix Edition Wiki Atom feed" type="application/atom+xml"/>
 </head>
 <body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Windows_Libraries rootpage-Windows_Libraries skin-vector action-view skin-vector-legacy vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
  <div class="noprint" id="mw-page-base">
  </div>
  <div class="noprint" id="mw-head-base">
  </div>
  <div class="mw-body" id="content" role="main">
   <a id="top">
   </a>
   <div id="siteNotice">
   </div>
   <div class="mw-indicators">
   </div>
   <h1 class="firstHeading mw-first-heading" id="firstHeading">
    <span class="mw-page-title-main">
     Windows Libraries
    </span>
   </h1>
   <div class="vector-body" id="bodyContent">
    <div class="noprint" id="siteSub">
     From QB64 Phoenix Edition Wiki
    </div>
    <div id="contentSub">
    </div>
    <div id="contentSub2">
    </div>
    <div id="jump-to-nav">
    </div>
    <a class="mw-jump-link" href="#mw-head">
     Jump to navigation
    </a>
    <a class="mw-jump-link" href="#searchInput">
     Jump to search
    </a>
    <div class="mw-body-content mw-content-ltr" dir="ltr" id="mw-content-text" lang="en">
     <div class="mw-parser-output">
      <p>
       QB64 can support the
       <b>
        specific Windows Operating System Libraries
       </b>
       on your PC. They should be located in the
       <b>
        System32
       </b>
       folder. Use
       <a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY">
        DECLARE LIBRARY
       </a>
       with the appropriate
       <a href="/qb64wiki/index.php/ALIAS" title="ALIAS">
        ALIAS
       </a>
       . Loaded DLL files are NOT required to be named in the Declaration!
      </p>
      <center>
       <b>
        Note: C++ Header files should be placed in the QB64 folder and are not required after a program is compiled.
       </b>
      </center>
      <center>
       <b>
        Note: QB64 requires all DLL files to either be with the program or in the C:\WINDOWS\SYSTEM32 folder!
       </b>
      </center>
      <center>
       Maximum Windows path: MAX_PATH = drive letter + ":\" + 256 + CHR$(0) = 260 characters.
      </center>
      <center>
       <b>
        <span style="color:magenta;">
         Your code contribution using the Windows Libraries could end up here!
        </span>
       </b>
      </center>
      <table class="wikitable" width="100%">
       <tbody>
        <tr>
         <th colspan="4">
          Table of Contents
         </th>
        </tr>
        <tr>
         <td>
          1
          <a href="#Computer_Date/Time">
           Computer Date/Time
          </a>
         </td>
         <td>
          10
          <a href="#Focus">
           Focus
          </a>
         </td>
         <td>
          19
          <a href="#Open_another_Program">
           Open another Program
          </a>
         </td>
         <td>
          28
          <a href="#Window_Focus">
           Window Focus
          </a>
         </td>
        </tr>
        <tr>
         <td>
          2
          <a href="#Borderless_Window">
           Borderless Window
          </a>
         </td>
         <td>
          11
          <a href="#Folder_Dialog_Box">
           Folder Dialog Box
          </a>
         </td>
         <td>
          20
          <a href="#Play_WAV_Sounds">
           Play WAV Sounds
          </a>
         </td>
         <td>
          29
          <a href="#Windows_Menu">
           Windows Menu
          </a>
         </td>
        </tr>
        <tr>
         <td>
          3
          <a href="#Color_Dialog_Box">
           Color Dialog Box
          </a>
         </td>
         <td>
          12
          <a href="#Font_Dialog_Box">
           Font Dialog Box
          </a>
         </td>
         <td>
          21
          <a href="#Run_One_Instance">
           Run One Instance
          </a>
         </td>
         <td>
          30
          <a href="#Windows_Notification">
           Windows Notification
          </a>
         </td>
        </tr>
        <tr>
         <td>
          4
          <a href="#Desktop_Size">
           Desktop Size
          </a>
         </td>
         <td>
          13
          <a href="#Registered_Fonts">
           Registered Fonts
          </a>
         </td>
         <td>
          22
          <a href="#Send_Keys">
           Send Keys
          </a>
         </td>
         <td>
          31
          <a href="#Windows_Ports">
           Windows Ports
          </a>
         </td>
        </tr>
        <tr>
         <td>
          5
          <a href="#Directory_Environment">
           Directory Environment
          </a>
         </td>
         <td>
          14
          <a href="#Game_Pad">
           Game Pad
          </a>
         </td>
         <td>
          23
          <a href="#System_Metrics">
           System Metrics
          </a>
         </td>
         <td>
          32
          <a href="#Windows_Sounds">
           Windows Sounds
          </a>
         </td>
        </tr>
        <tr>
         <td>
          6
          <a href="#Disk_Drives">
           Disk Drives
          </a>
         </td>
         <td>
          15
          <a href="#Hot_Keys_(maximize)">
           Hot Keys (maximize)
          </a>
         </td>
         <td>
          24
          <a href="#Top_Most_Window">
           Top Most Window
          </a>
         </td>
         <td>
          33
          <a href="#Window_Transparency">
           Window Transparency
          </a>
         </td>
        </tr>
        <tr>
         <td>
          7
          <a href="#File_Attributes">
           File Attributes
          </a>
         </td>
         <td>
          16
          <a href="#Keyboard_Lock_Settings">
           Keyboard Lock Settings
          </a>
         </td>
         <td>
          25
          <a href="#Video_File_Player">
           Video File Player
          </a>
         </td>
         <td>
          34
          <a href="#Windows_User">
           Windows User
          </a>
         </td>
        </tr>
        <tr>
         <td>
          8
          <a href="#File_Open_and_Save_Dialog">
           File Open and Save Dialog
          </a>
         </td>
         <td>
          17
          <a href="#Message_Box">
           Message Box
          </a>
         </td>
         <td>
          26
          <a href="#Web_Page_Download">
           Web Page Download
          </a>
         </td>
         <td>
          35
          <a href="#Windows_Version">
           Windows Version
          </a>
         </td>
        </tr>
        <tr>
         <td>
          9
          <a href="#File_Times">
           File Times
          </a>
         </td>
         <td>
          18
          <a href="#Mouse_Area">
           Mouse Area
          </a>
         </td>
         <td>
          27
          <a href="#Windows_API">
           Windows API
          </a>
         </td>
         <td>
          36
          <a href="#Reference">
           Reference
          </a>
         </td>
        </tr>
       </tbody>
      </table>
      <table cellpadding="5px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="outputfixed"><b>                         Windows API Data Structures</b>

<b>Name            Description             Bits             QB64 Type</b>
bit            8 bits in one byte         1                <a href="/qb64wiki/index.php/BIT" title="BIT">_BIT</a>
nybble         2 nybbles in one byte      4                <a href="/qb64wiki/index.php/BIT" title="BIT">_BIT</a> * 4
byte           1 byte (2 nybbles)         8                <a href="/qb64wiki/index.php/BYTE" title="BYTE">_BYTE</a>
Boolean        1 byte (signed/unsigned)   8                <a href="/qb64wiki/index.php/BYTE" title="BYTE">_BYTE</a>
CharA(FunctA)  <a href="/qb64wiki/index.php/ASCII" title="ASCII">ASCII</a> character            8(<a href="/qb64wiki/index.php/LEN" title="LEN">LEN</a>(buffer))   <a href="/qb64wiki/index.php/BYTE" title="BYTE">_BYTE</a>
WORD           2 bytes                   16                <a href="/qb64wiki/index.php/INTEGER" title="INTEGER">INTEGER</a>
CharW(FunctW)  <a href="/qb64wiki/index.php/Unicode" title="Unicode">Unicode</a> wide character    16(<a href="/qb64wiki/index.php/LEN" title="LEN">LEN</a>(buffer)\2) <a href="/qb64wiki/index.php/INTEGER" title="INTEGER">INTEGER</a>
DWORD          4 bytes                   32                <a href="/qb64wiki/index.php/LONG" title="LONG">LONG</a>
QWORD          8 bytes                   64                <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64">_INTEGER64</a>
LP or hwnd     Short or Long Pointer     ANY <a href="/qb64wiki/index.php/INTEGER" title="INTEGER">INTEGER</a>       <a href="/qb64wiki/index.php/OFFSET" title="OFFSET">_OFFSET</a>

                  Void * in C code is also an <a href="/qb64wiki/index.php/OFFSET" title="OFFSET">_OFFSET</a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <b>
        <a class="external text" href="http://msdn.microsoft.com/en-us/library/aa383751(v=vs.85).aspx" rel="nofollow">
         Windows Data Types
        </a>
       </b>
      </center>
      <center>
       <b>
        <a class="external text" href="http://doc.pcsoft.fr/en-US/?6510001" rel="nofollow">
         Windows 32 API constant values
        </a>
       </b>
      </center>
      <p>
       <br/>
      </p>
      <h2>
       <span id="Computer_Date.2FTime">
       </span>
       <span class="mw-headline" id="Computer_Date/Time">
        Computer Date/Time
       </span>
      </h2>
      <p>
       <b>
        NOTE: You might need to run this program as Administrator
       </b>
      </p>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'=============
'DATE&amp;TIME.BAS
'=============
'A <a href="/qb64wiki/index.php/DATE$" title="DATE$"><span style="color:#4593D8;">DATE$</span></a> and <a href="/qb64wiki/index.php/TIME$" title="TIME$"><span style="color:#4593D8;">TIME$</span></a> alternative.
'Gets &amp; Sets System DATE &amp; TIME using Windows API.
'Coded for QB64 by Dav FEB/2012

'======================================================================
'NOTE: THIS DEMO WILL ATTEMPT TO CHANGE YOUR SYSTEM DATE FOR 5 SECONDS.
'     AFTER 5 SECONDS IT WILL ATTEMPT TO RESTORE ORIGINAL DATE SETTING.
'======================================================================

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> SYSTEMTIME
    wYear <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
    wMonth <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
    wDayOfWeek <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
    wDay <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
    wHour <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
    wMinute <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
    wSecond <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
    wMilliseconds <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "Kernel32"
'== NOTE: SetSystemTime&amp; returns Zero if it Fails.
'== NOTE: GetSystemTime does not return a value.
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetSystemTime&amp; (lpSystemTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> SYSTEMTIME)
    <a href="/qb64wiki/index.php/SUB" title="SUB"><span style="color:#4593D8;">SUB</span></a> GetSystemTime (lpSystemTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> SYSTEMTIME)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

' Holds current values...
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> CurrentTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> SYSTEMTIME

' For the new values to set...
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> NewTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> SYSTEMTIME

' Get &amp; Show current System Date/Time
GetSystemTime CurrentTime

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "--------------------------------"
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Current System DATE &amp; TIME is..."
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "DATE:"; CurrentTime.wMonth; "-"; CurrentTime.wDay; "-"; CurrentTime.wYear
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "TIME:"; CurrentTime.wHour; ":"; CurrentTime.wMinute; ":"; CurrentTime.wSecond
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "--------------------------------"


'=== Now Set new DATE only
'=== <a href="/qb64wiki/index.php/NOT" title="NOT"><span style="color:#4593D8;">NOT</span></a>ICE we're using CurrentTime TIME value's '&lt;==
'=== So we're just changing the DATE, not the TIME here...

NewTime.wYear = 2011     'move date back to prevent trial version expiration!
NewTime.wMonth = 12
NewTime.wDayOfWeek = -1
NewTime.wDay = 25
NewTime.wHour = CurrentTime.wHour '&lt;==
NewTime.wMinute = CurrentTime.wMinute '&lt;==
NewTime.wSecond = CurrentTime.wSecond '&lt;==
NewTime.wMilliseconds = CurrentTime.wMilliseconds '&lt;==

' Set the new values
x = SetSystemTime&amp;(NewTime)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> x = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Failed to change DATE/TIME!": <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>

' Grab new System DATE settings...
' Temporary holding space...for TIME...
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> CurrentTime2 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> SYSTEMTIME

GetSystemTime CurrentTime2

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "--------------------------------"
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Now the NEW System DATE is..."
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "DATE:"; CurrentTime2.wMonth; "-"; CurrentTime2.wDay; "-"; CurrentTime2.wYear
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "--------------------------------"
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Waiting 5 seconds! Check computer date in taskbar....."


<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a> 5

'=== Now set everything back to what it was at the beginning.
'=== Using TIME values from CurrentTime2 so we don't lose any
'=== seconds from SLEEPing....

' Grab current values again, keeps the running TIME...
GetSystemTime CurrentTime2

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Resetting DATE back..."

NewTime.wYear = CurrentTime.wYear
NewTime.wMonth = CurrentTime.wMonth
NewTime.wDayOfWeek = -1
NewTime.wDay = CurrentTime.wDay
NewTime.wHour = CurrentTime2.wHour '&lt;==
NewTime.wMinute = CurrentTime2.wMinute '&lt;==
NewTime.wSecond = CurrentTime2.wSecond '&lt;==
NewTime.wMilliseconds = CurrentTime2.wMilliseconds '&lt;==

' Set the DATE &amp; TIME values back

x = SetSystemTime&amp;(NewTime):
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> x = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Failed to change DATE/TIME!": <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>

' Now let's get &amp; show Current values, see if it worked...

GetSystemTime CurrentTime

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "--------------------------------"
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Now the System DATE &amp; TIME is..."
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "DATE:"; CurrentTime.wMonth; "-"; CurrentTime.wDay; "-"; CurrentTime.wYear
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "TIME:"; CurrentTime.wHour; ":"; CurrentTime.wMinute; ":"; CurrentTime.wSecond
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "--------------------------------"

<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code by Dav
       </span>
      </center>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Borderless_Window">
        Borderless Window
       </span>
      </h2>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'============
'NOBORDER.BAS
'============

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE CUSTOMTYPE LIBRARY</span></a>
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ClassName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, WindowName$)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "User32"
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetWindowLongA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nIndex <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetWindowLongA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nIndex <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwNewLong <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetWindowPos&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hWndInsertAfter <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> x <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> y <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> cx <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> cy <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> wFlags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

GWL_STYLE = -16
WS_BORDER = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>800000

<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> "No Border"
hwnd&amp; = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindow(0, "No Border" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0))

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Press any key for no border...": A$ = <a href="/qb64wiki/index.php/INPUT$" title="INPUT$"><span style="color:#4593D8;">INPUT$</span></a>(1)

winstyle&amp; = GetWindowLongA&amp;(hwnd&amp;, GWL_STYLE)
a&amp; = SetWindowLongA&amp;(hwnd&amp;, GWL_STYLE, winstyle&amp; <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> <a href="/qb64wiki/index.php/NOT" title="NOT"><span style="color:#4593D8;">NOT</span></a> WS_BORDER)
a&amp; = SetWindowPos&amp;(hwnd&amp;, 0, 0, 0, 0, 0, 39)

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Press any key to get back border...": <a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a>

winstyle&amp; = GetWindowLongA&amp;(hwnd&amp;, GWL_STYLE)
a&amp; = SetWindowLongA&amp;(hwnd&amp;, GWL_STYLE, winstyle&amp; <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> WS_BORDER)
a&amp; = SetWindowPos&amp;(hwnd&amp;, 0, 0, 0, 0, 0, 39)

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "The end"
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code by Dav
       </span>
      </center>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Color_Dialog_Box">
        Color Dialog Box
       </span>
      </h2>
      <center>
       The Color Dialog Box can set custom colors and alpha saturation levels.
      </center>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">' Color Dialog flag constants (use + or <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> to use more than 1 flag)
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CC_RGBINIT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1&amp; '           Sets the initial color (don't know how to set it)
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CC_FULLOPEN = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2&amp; '          Opens all dialog sections such as the custom color selector
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CC_PREVENTFULLOPEN = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>4&amp; '   Prevents the user from opening the custom color selector
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CC_SHOWHELP = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>8&amp; '          Shows the help button (USELESS!)
'----------------------------------------------------------------------------------------
<a href="/qb64wiki/index.php/$IF" title="$IF"><span style="color:#4593D8;">$IF</span></a> 32BIT <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> '                Checking for 32 bit IDE
<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> COLORDIALOGTYPE
  lStructSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '         Length of this <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> structure
  hwndOwner <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '           Dialog owner's handle
  hInstance <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '           ?
  rgbResult <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '           The RGB color the user selected
  lpCustColors <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '     Pointer to an array of 16 custom colors (will be changed by user)
  flags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '               Dialog flags
  lCustData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '           Custom data
  lpfnHook <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '            Hook
  lpTemplateName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '   Custom template
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/$ELSE" title="$ELSE"><span style="color:#4593D8;">$ELSE</span></a> '                         If the IDE is 64 bit then...
<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> COLORDIALOGTYPE
  lStructSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a> '   Length of this <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> structure
  hwndOwner <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a> '     Dialog owner's handle
  hInstance <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a> '     ?
  rgbResult <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a> '     The RGB color the user selected
  lpCustColors <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '     Pointer to an array of 16 custom colors (will be changed by user)
  flags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a> '         Dialog flags
  lCustData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a> '     Custom data
  lpfnHook <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a> '      Hook
  lpTemplateName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '   Custom template
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/$END_IF" title="$END IF"><span style="color:#4593D8;">$END IF</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> ColorString <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a> * 64
ColorString = "FFFFFFFFFF" 'not sure how this works?

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "comdlg32"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> ChooseColorA&amp; (DIALOGPARAMS <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> COLORDIALOGTYPE) '    Yet the also famous color dialog box
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ClassName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, WindowName$) ' To get hWnd handle, or use <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a>
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/SCREEN" title="SCREEN"><span style="color:#4593D8;">SCREEN</span></a> <a href="/qb64wiki/index.php/NEWIMAGE" title="NEWIMAGE"><span style="color:#4593D8;">_NEWIMAGE</span></a>(640, 480, 12) '32 or 16 or 256 color screen modes
<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> "Color Common Dialog demo" 'set Title of program
hWnd&amp; = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindow(0, "Color Common Dialog demo" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)) 'get window handle using <a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> string

clr~&amp; = ChooseColor&amp;(<a href="/qb64wiki/index.php/RGB32" title="RGB32"><span style="color:#4593D8;">_RGB32</span></a>(0, 0, 0), ColorString$, Cancel, CC_FULLOPEN, hWnd&amp;)

<a href="/qb64wiki/index.php/CLS" title="CLS"><span style="color:#4593D8;">CLS</span></a> , clr~&amp; 'make background chosen color
<a href="/qb64wiki/index.php/LOCATE" title="LOCATE"><span style="color:#4593D8;">LOCATE</span></a> 10, 31
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Cancel &lt;&gt; -1 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
  <a href="/qb64wiki/index.php/COLOR" title="COLOR"><span style="color:#4593D8;">COLOR</span></a> <a href="/qb64wiki/index.php/RGB" title="RGB"><span style="color:#4593D8;">_RGB</span></a>(255, 255, 255) 'white text
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Color:"; clr~&amp;; "<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>" + <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(clr~&amp;) '  use last color chosen
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> ColorString$ '              display user custom color values chosen
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "No color was chosen!"
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> ChooseColor&amp; (InitialColor&amp;, CustomColors$, Cancel, Flags&amp;, hWnd&amp;)
' Parameters:
'  InitialColor&amp;  - The initial color used, will take effect if CC_RGBINIT flag is specified
'  CustomColors$  - A 64-byte string where the user's custom colors will be stored (4 bytes per color in RGB0 format).
'  Cancel         - Variable where the cancel flag will be stored.
'  Flags&amp;         - Dialog flags
'  hWnd&amp;          - Your program's window handle that should be aquired by the FindWindow function.

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> ColorCall <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> COLORDIALOGTYPE

ColorCall.rgbResult = <a href="/qb64wiki/index.php/RGB32" title="RGB32"><span style="color:#4593D8;">_RGB32</span></a>(<a href="/qb64wiki/index.php/BLUE32" title="BLUE32"><span style="color:#4593D8;">_BLUE32</span></a>(InitialColor&amp;), <a href="/qb64wiki/index.php/GREEN32" title="GREEN32"><span style="color:#4593D8;">_GREEN32</span></a>(InitialColor&amp;), <a href="/qb64wiki/index.php/RED32" title="RED32"><span style="color:#4593D8;">_RED32</span></a>(InitialColor&amp;))
ColorCall.lStructSize = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(ColorCall)
ColorCall.hwndOwner = hWnd&amp;
ColorCall.flags = Flags&amp;
ColorCall.lpCustColors = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(CustomColors$)

' Do dialog call
Result = ChooseColorA(ColorCall)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Result <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
  rgbResult&amp; = ColorCall.rgbResult
  ' Swap RED and BLUE color intensity values using <a href="/qb64wiki/index.php/RGB" title="RGB"><span style="color:#4593D8;">_RGB</span></a>
  ChooseColor&amp; = <a href="/qb64wiki/index.php/RGB" title="RGB"><span style="color:#4593D8;">_RGB</span></a>(<a href="/qb64wiki/index.php/BLUE32" title="BLUE32"><span style="color:#4593D8;">_BLUE32</span></a>(rgbResult&amp;), <a href="/qb64wiki/index.php/GREEN32" title="GREEN32"><span style="color:#4593D8;">_GREEN32</span></a>(rgbResult&amp;), <a href="/qb64wiki/index.php/RED32" title="RED32"><span style="color:#4593D8;">_RED32</span></a>(rgbResult&amp;))
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
  Cancel = -1
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Adapted from code by Jobert14
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        The ChooseColor value is converted using
        <a href="/qb64wiki/index.php/RGB32" title="RGB32">
         _RGB32
        </a>
        with the Blue and Red values being swapped.
       </dd>
      </dl>
      <p>
       <br/>
      </p>
      <center>
       <b>
        Converting 32 bit Dialog Box Color values for 4 or 8 BPP Screen modes
       </b>
      </center>
      <table cellpadding="5px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="outputtext"><a href="/qb64wiki/index.php/SCREEN" title="SCREEN"><span style="color:blue;">SCREEN</span></a> <a href="/qb64wiki/index.php/NEWIMAGE" title="NEWIMAGE"><span style="color:blue;">_NEWIMAGE</span></a>(640, 480, 12) 'change from screen 12 to 32 to see the difference
rgbresult&amp; = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:blue;">&amp;H</span></a>8080FF 'Dialog box long color reverse <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:blue;">HEX$</span></a> return value
clr~&amp; = <a href="/qb64wiki/index.php/RGB" title="RGB"><span style="color:blue;">_RGB</span></a>(<a href="/qb64wiki/index.php/BLUE32" title="BLUE32"><span style="color:blue;">_BLUE32</span></a>(rgbresult&amp;), <a href="/qb64wiki/index.php/GREEN32" title="GREEN32"><span style="color:blue;">_GREEN32</span></a>(rgbresult&amp;), <a href="/qb64wiki/index.php/RED32" title="RED32"><span style="color:blue;">_RED32</span></a>(rgbresult&amp;)) 'swap red and blue
<a href="/qb64wiki/index.php/COLOR" title="COLOR"><span style="color:blue;">COLOR</span></a> clr~&amp;: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> clr~&amp;, <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:blue;">HEX$</span></a>(clr~&amp;) '_UNSIGNED LONG color values
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        The
        <a href="/qb64wiki/index.php/RGB" title="RGB">
         _RGB
        </a>
        value returned is full
        <a href="/qb64wiki/index.php/ALPHA" title="ALPHA">
         _ALPHA
        </a>
        . Use _ALPHA or
        <a href="/qb64wiki/index.php/RGBA" title="RGBA">
         _RGBA
        </a>
        to set the transparency in a program.
       </dd>
      </dl>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Desktop_Size">
        Desktop Size
       </span>
      </h2>
      <dl>
       <dd>
        Returns the Left, Top, Right and Bottom coordinates of the current desktop area.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SystemParametersInfoW&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> uiAction~&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> uiParam~&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> pvParam%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> fWinlni~&amp;)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SPI_GETWORKAREA = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>30

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> RECT
    left <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    top <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    right <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    bottom <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> Rec <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> RECT

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> 0 = SystemParametersInfoW(SPI_GETWORKAREA, 0, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(Rec), 0) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    'function failed. You may call kernel32's GetLastError for more info.
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "failed."
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> Rec.left
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> Rec.top
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> Rec.right
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> Rec.bottom
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>
scr&amp; = <a href="/qb64wiki/index.php/SCREENIMAGE" title="SCREENIMAGE"><span style="color:#4593D8;">_SCREENIMAGE</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/WIDTH_(function)" title="WIDTH (function)"><span style="color:#4593D8;">_WIDTH</span></a>(scr&amp;)
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/HEIGHT" title="HEIGHT"><span style="color:#4593D8;">_HEIGHT</span></a>(scr&amp;)
<a href="/qb64wiki/index.php/FREEIMAGE" title="FREEIMAGE"><span style="color:#4593D8;">_FREEIMAGE</span></a> scr&amp;

<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Directory_Environment">
        Directory Environment
       </span>
      </h2>
      <dl>
       <dd>
        Returns various system environment settings including the current program's EXE name.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>   'Directory Information using KERNEL32 provided by Dav
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> WINDirectory <a href="/qb64wiki/index.php/ALIAS" title="ALIAS"><span style="color:#4593D8;">ALIAS</span></a> GetWindowsDirectoryA (lpBuffer <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SYSDirectory <a href="/qb64wiki/index.php/ALIAS" title="ALIAS"><span style="color:#4593D8;">ALIAS</span></a> GetSystemDirectoryA (lpBuffer <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> CURDirectory <a href="/qb64wiki/index.php/ALIAS" title="ALIAS"><span style="color:#4593D8;">ALIAS</span></a> GetCurrentDirectoryA (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nBufferLen <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, lpBuffer <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> TempPath <a href="/qb64wiki/index.php/ALIAS" title="ALIAS"><span style="color:#4593D8;">ALIAS</span></a> GetTempPathA (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nBufferLen <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, lpBuffer <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetModuleFileNameA (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hModule <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, lpFileName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

'=== SHOW WINDOWS DIRECTORY
WinDir$ = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(144)
Result = WINDirectory(WinDir$, <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(WinDir$))
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Result <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "<a href="/qb64wiki/index.php/WINDOW" title="WINDOW"><span style="color:#4593D8;">WINDOW</span></a>S DIRECTORY: "; <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(WinDir$, Result)

'=== SHOW SYSTEM DIRECTORY
SysDir$ = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(144)
Result = SYSDirectory(SysDir$, <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(SysDir$))
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Result <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "<a href="/qb64wiki/index.php/SYSTEM" title="SYSTEM"><span style="color:#4593D8;">SYSTEM</span></a> DIRECTORY: "; <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(SysDir$, Result)

'=== SHOW CURRENT DIRECTORY
CurDir$ = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(255)
Result = CURDirectory(<a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(CurDir$), CurDir$)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Result <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "CURRENT DIRECTORY: "; <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(CurDir$, Result)

'=== SHOW TEMP DIRECTORY
TempDir$ = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(100)
Result = TempPath(<a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(TempDir$), TempDir$)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Result <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "TEMP DIRECTORY: "; <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(TempDir$, Result)

'=== SHOW CURRENT PROGRAM
FileName$ = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(256)
Result = GetModuleFileNameA(0, FileName$, <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(FileName$))
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Result <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "CURRENT PROGRAM: "; <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(FileName$, Result)
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Windows APIs courtesy of Dav
       </span>
      </center>
      <p>
       <br/>
      </p>
      <dl>
       <dd>
        Returns the DOS 8.3 path and file name. The DLL used is in the QB64 folder.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>   'Directory Information using KERNEL32
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetShortPathNameA (lpLongPath <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, lpShortPath <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> cBufferLen <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

'=== SHOW SHORT PATH NAME
FileOrPath$ = "c:\qb64\SDL_image.dll"  '&lt;&lt; change to a relevant path or file name on computer
ShortPathName$ = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(260)
Result = GetShortPathNameA(FileOrPath$ + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0), ShortPathName$, <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(ShortPathName$))
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Result <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "SHORT PATH NAME: " + ShortPathName$ <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "NOT Found!"
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Courtesy of Dav
       </span>
      </center>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Disk_Drives">
        Disk Drives
       </span>
      </h2>
      <p>
       Uses Kernel32 API to lists all available drives on system. Shows the drives type: HD/CD/DVD/RAM/NET/Removable/Unknown
      </p>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REMOVABLE = 2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FIXED = 3
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REMOTE = 4
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CDROM = 5
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> RAMDISK = 6

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetDriveTypeA&amp; (nDrive <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetLogicalDriveStringsA (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nBuff <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, lpbuff <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> DList <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, DL <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> i <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, typ <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>

i = GetLogicalDriveStringsA(0, DList) 'zero returns the drive string byte size
DList = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(i) 'set drive string length. Each drive is followed by CHR$(0)
i = GetLogicalDriveStringsA(i, DList) 'the byte size returns a string that long
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> DList

<a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:#4593D8;">FOR</span></a> n = 65 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:#4593D8;">TO</span></a> 90
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(DList, <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(n)) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    DL = <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(n) + ":\" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
    typ = GetDriveTypeA(DL)
    <a href="/qb64wiki/index.php/SELECT_CASE" title="SELECT CASE"><span style="color:#4593D8;">SELECT CASE</span></a> typ
      <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REMOVABLE: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> DL + "Removable"
      <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> FIXED: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> DL + "Fixed"
      <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REMOTE: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> DL + "Remote"
      <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> CDROM: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> DL + "CDROM"
      <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> RAMDISK: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> DL + "RAM"
    <a href="/qb64wiki/index.php/END_SELECT" title="END SELECT"><span style="color:#4593D8;">END SELECT</span></a>
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:#4593D8;">NEXT</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Adapted from code by Dav
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        The length of the string returned by
        <i>
         GetLogicalDriveStringsA
        </i>
        can be divided by 4 to tell the number of physical and ram drives.
       </dd>
      </dl>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="File_Attributes">
        File Attributes
       </span>
      </h2>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetFileAttributes&amp; (f$)
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetFileAttributes&amp; (f$, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> attrib&amp;)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> INVALID_FILE_ATTRIBUTES = -1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FILE_ATTRIBUTE_<a href="/qb64wiki/index.php/READ" title="READ"><span style="color:#4593D8;">READ</span></a>ONLY = 1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FILE_ATTRIBUTE_HIDDEN = 2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FILE_ATTRIBUTE_<a href="/qb64wiki/index.php/SYSTEM" title="SYSTEM"><span style="color:#4593D8;">SYSTEM</span></a> = 4
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FILE_ATTRIBUTE_DIRECTORY = 16
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FILE_ATTRIBUTE_ARCHIVE = 32

file$ = "temp.txt"

a = GetFileAttributes(file$)
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> a 'if no file, then you'll see a -1 here

<a href="/qb64wiki/index.php/OPEN" title="OPEN"><span style="color:#4593D8;">OPEN</span></a> file$ <a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:#4593D8;">FOR</span></a> <a class="mw-redirect" href="/qb64wiki/index.php/OUTPUT" title="OUTPUT"><span style="color:#4593D8;">OUTPUT</span></a> <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> #1
<a href="/qb64wiki/index.php/CLOSE" title="CLOSE"><span style="color:#4593D8;">CLOSE</span></a> #1

a = GetFileAttributes(file$)
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> a 'a new file, it prints 32 for me here

x = SetFileAttributes(file$, 1) 'set the read only flag
a = GetFileAttributes(file$)
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> a 'notice, it prints 1 here and not 32.  We didn't add a flag, we changed it completel
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="File_Open_and_Save_Dialog">
        File Open and Save Dialog
       </span>
      </h2>
      <center>
       <b>
        Open and Save Dialog Boxes get file names
       </b>
      </center>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">' Dialog flag constants (use + or <a href="/qb64wiki/index.php/OR" title="OR"><span style="color:#4593D8;">OR</span></a> to use more than 1 flag value)
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_ALLOWMULTISELECT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>200&amp; '  Allows the user to select more than one file, not recommended!
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_CREATEPROMPT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2000&amp; '     Prompts if a file not found should be created(GetOpenFileName only).
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_EXTENSIONDIFFERENT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>400&amp; 'Allows user to specify file extension other than default extension.
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_FILEMUSTEXIST = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1000&amp; '    Chechs File name exists(GetOpenFileName only).
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_HIDEREADONLY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>4&amp; '        Hides read-only checkbox(GetOpenFileName only)
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_NOCHANGEDIR = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>8&amp; '         Restores the current directory to original value if user changed
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_NODEREFERENCELINKS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>100000&amp; 'Returns path and file name of selected shortcut(.LNK) file instead of file referenced.
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_NONETWORKBUTTON = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>20000&amp; ' Hides and disables the Network button.
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_NOREADONLYRETURN = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>8000&amp; ' Prevents selection of read-only files, or files in read-only subdirectory.
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_NOVALIDATE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>100&amp; '        Allows invalid file name characters.
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_OVERWRITEPROMPT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2&amp; '     Prompts if file already exists(GetSaveFileName only)
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_PATHMUSTEXIST = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>800&amp; '     Checks Path name exists (set with OFN_FILEMUSTEXIST).
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_READONLY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1&amp; '            Checks read-only checkbox. Returns if checkbox is checked
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_SHAREAWARE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>4000&amp; '       Ignores sharing violations in networking
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OFN_SHOWHELP = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>10&amp; '           Shows the help button (useless!)
'--------------------------------------------------------------------------------------------

<a href="/qb64wiki/index.php/DEFINT" title="DEFINT"><span style="color:#4593D8;">DEFINT</span></a> A-Z 'not recommended to use this statement in a final application!

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> FILEDIALOGTYPE
<a href="/qb64wiki/index.php/$IF" title="$IF"><span style="color:#4593D8;">$IF</span></a> 32BIT <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
  lStructSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '        For the DLL call
  hwndOwner <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '          Dialog will hide behind window when not set correctly
  hInstance <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '          Handle to a module that contains a dialog box template.
  lpstrFilter <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '     Pointer of the string of file filters
  lpstrCustFilter <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
  nMaxCustFilter <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  nFilterIndex <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '       One based starting filter index to use when dialog is called
  lpstrFile <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '       String full of 0's for the selected file name
  nMaxFile <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '           Maximum length of the string stuffed with 0's minus 1
  lpstrFileTitle <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '  Same as lpstrFile
  nMaxFileTitle <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '      Same as nMaxFile
  lpstrInitialDir <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> ' Starting directory
  lpstrTitle <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '      Dialog title
  flags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '              Dialog flags
  nFileOffset <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a> '     Zero-based offset from path beginning to file name string pointed to by lpstrFile
  nFileExtension <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a> '  Zero-based offset from path beginning to file extension string pointed to by lpstrFile.
  lpstrDefExt <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '     Default/selected file extension
  lCustData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  lpfnHook <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  lpTemplateName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/$ELSE" title="$ELSE"><span style="color:#4593D8;">$ELSE</span></a>
  lStructSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '      For the DLL call
  hwndOwner <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '        Dialog will hide behind window when not set correctly
  hInstance <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '        Handle to a module that contains a dialog box template.
  lpstrFilter <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '      Pointer of the string of file filters
  lpstrCustFilter <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  nMaxCustFilter <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  nFilterIndex <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a> '  One based starting filter index to use when dialog is called
  lpstrFile <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '        String full of 0's for the selected file name
  nMaxFile <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '         Maximum length of the string stuffed with 0's minus 1
  lpstrFileTitle <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '   Same as lpstrFile
  nMaxFileTitle <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '    Same as nMaxFile
  lpstrInitialDir <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '  Starting directory
  lpstrTitle <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '       Dialog title
  flags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a> '         Dialog flags
  nFileOffset <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a> '   Zero-based offset from path beginning to file name string pointed to by lpstrFile
  nFileExtension <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a> 'Zero-based offset from path beginning to file extension string pointed to by lpstrFile.
  lpstrDefExt <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '      Default/selected file extension
  lCustData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a>
  lpfnHook <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER64" title="INTEGER64"><span style="color:#4593D8;">_INTEGER64</span></a>
  lpTemplateName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/$END_IF" title="$END IF"><span style="color:#4593D8;">$END IF</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "comdlg32"    ' Library declarations using _OFFSET types
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetOpenFileNameA&amp; (DIALOGPARAMS <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> FILEDIALOGTYPE) ' The Open file dialog
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetSaveFileNameA&amp; (DIALOGPARAMS <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> FILEDIALOGTYPE) ' The Save file dialog
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ClassName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, WindowName$) ' To get hWnd handle
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> "FileOpen Common Dialog demo"                           'set Title of program
hWnd&amp; = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindow(0, "Open and Save Dialog demo" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)) 'get window handle using _TITLE string

' Do the Open File dialog call!
Filter$ = "Batch files (*.bat)|*.BAT|JPEG images (*.jpg)|*.JPG|All files (*.*)|*.*"
Flags&amp; = OFN_FILEMUSTEXIST + OFN_NOCHANGEDIR + OFN_READONLY  '    add flag constants here
OFile$ = GetOpenFileName$("YEAH! Common Dialogs in QB64!!!", ".\", Filter$, 1, Flags&amp;, hWnd&amp;)

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> OFile$ = "" <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>   ' Display Open dialog results
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Shame on you! You didn't pick any file..."
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "You picked this file: "
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> OFile$
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> (Flags&amp; <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> OFN_READONLY) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Read-only checkbox checked." 'read-only value in return
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

<a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 5 ' Do the Save File dialog call!
Filter$ = "Basic files (*.bas)|*.BAS|All files (*.*)|*.*"
Flags&amp; = OFN_OVERWRITEPROMPT + OFN_NOCHANGEDIR '   add flag constants here
SFile$ = GetSaveFileName$("Save will not create a file!!!", ".\", Filter$, 1, Flags&amp;, hWnd&amp;)

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> SFile$ = "" <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>     ' Display Save dialog results
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "You didn't save the file..."
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "You saved this file: "
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> SFile$
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetOpenFileName$ (Title$, InitialDir$, Filter$, FilterIndex, Flags&amp;, hWnd&amp;)
'  Title$      - The dialog title.
'  InitialDir$ - If this left blank, it will use the directory where the last opened file is
'  located. Specify ".\" if you want to always use the current directory.
'  Filter$     - File filters separated by pipes (|) in the same format as using VB6 common dialogs.
'  FilterIndex - The initial file filter to use. Will be altered by user during the call.
'  Flags&amp;      - Dialog flags. Will be altered by the user during the call.
'  hWnd&amp;       - Your program's window handle that should be aquired by the FindWindow function.
'
' Returns: Blank when cancel is clicked otherwise, the file name selected by the user.
' FilterIndex and Flags&amp; will be changed depending on the user's selections.

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> OpenCall <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> FILEDIALOGTYPE  ' Needed for dialog call

fFilter$ = Filter$
<a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:#4593D8;">FOR</span></a> R = 1 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:#4593D8;">TO</span></a> <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(fFilter$) ' Replace the pipes with character zero
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/MID$_(function)" title="MID$ (function)"><span style="color:#4593D8;">MID$</span></a>(fFilter$, R, 1) = "|" <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/MID$" title="MID$"><span style="color:#4593D8;">MID$</span></a>(fFilter$, R, 1) = <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
<a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:#4593D8;">NEXT</span></a> R
fFilter$ = fFilter$ + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)

lpstrFile$ = <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(2048, 0) ' For the returned file name
lpstrDefExt$ = <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(10, 0) ' Extension will not be added when this is not specified
OpenCall.lStructSize = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(OpenCall)
OpenCall.hwndOwner = hWnd&amp;
OpenCall.lpstrFilter = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(fFilter$)
OpenCall.nFilterIndex = FilterIndex
OpenCall.lpstrFile = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(lpstrFile$)
OpenCall.nMaxFile = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(lpstrFile$) - 1
OpenCall.lpstrFileTitle = OpenCall.lpstrFile
OpenCall.nMaxFileTitle = OpenCall.nMaxFile
OpenCall.lpstrInitialDir = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(InitialDir$)
OpenCall.lpstrTitle = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(Title$)
OpenCall.lpstrDefExt = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(lpstrDefExt$)
OpenCall.flags = Flags&amp;

Result = GetOpenFileNameA&amp;(OpenCall) '            Do Open File dialog call!

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Result <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>   ' Trim the remaining zeros
  GetOpenFileName$ = <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(lpstrFile$, <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(lpstrFile$, <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)) - 1)
  Flags&amp; = OpenCall.flags
  FilterIndex = OpenCall.nFilterIndex
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetSaveFileName$ (Title$, InitialDir$, Filter$, FilterIndex, Flags&amp;, hWnd&amp;)
'  Title$      - The dialog title.
'  InitialDir$ - If this left blank, it will use the directory where the last opened file is
'     located. Specify ".\" if you want to always use the current directory.
'  Filter$     - File filters separated by pipes (|) in the same format as VB6 common dialogs.
'  FilterIndex - The initial file filter to use. Will be altered by user during the call.
'  Flags&amp;      - Dialog flags. Will be altered by the user during the call.
'  hWnd&amp;       - Your program's window handle that should be aquired by the FindWindow function.

' Returns: Blank when cancel is clicked otherwise, the file name entered by the user.
' FilterIndex and Flags&amp; will be changed depending on the user's selections.

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> SaveCall <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> FILEDIALOGTYPE  ' Needed for dialog call

fFilter$ = Filter$
<a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:#4593D8;">FOR</span></a> R = 1 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:#4593D8;">TO</span></a> <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(fFilter$)  ' Replace the pipes with zeros
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/MID$_(function)" title="MID$ (function)"><span style="color:#4593D8;">MID$</span></a>(fFilter$, R, 1) = "|" <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/MID$" title="MID$"><span style="color:#4593D8;">MID$</span></a>(fFilter$, R, 1) = <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
<a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:#4593D8;">NEXT</span></a> R
fFilter$ = fFilter$ + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)

lpstrFile$ = <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(2048, 0) ' For the returned file name
lpstrDefExt$ = <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(10, 0) ' Extension will not be added when this is not specified
SaveCall.lStructSize = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(SaveCall)
SaveCall.hwndOwner = hWnd&amp;
SaveCall.lpstrFilter = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(fFilter$)
SaveCall.nFilterIndex = FilterIndex
SaveCall.lpstrFile = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(lpstrFile$)
SaveCall.nMaxFile = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(lpstrFile$) - 1
SaveCall.lpstrFileTitle = SaveCall.lpstrFile
SaveCall.nMaxFileTitle = SaveCall.nMaxFile
SaveCall.lpstrInitialDir = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(InitialDir$)
SaveCall.lpstrTitle = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(Title$)
SaveCall.lpstrDefExt = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(lpstrDefExt$)
SaveCall.flags = Flags&amp;

Result&amp; = GetSaveFileNameA&amp;(SaveCall) ' Do dialog call!

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Result&amp; <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>  ' Trim the remaining zeros
  GetSaveFileName$ = <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(lpstrFile$, <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(lpstrFile$, <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)) - 1)
  Flags&amp; = SaveCall.flags
  FilterIndex = SaveCall.nFilterIndex
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Jobert14
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        The Open and Save Dialog boxes get user selections and do not actually open or create a file! Your program must do that.
       </dd>
      </dl>
      <center>
       <b>
        <a class="external text" href="http://msdn.microsoft.com/en-us/library/aa155724(v=office.10).aspx" rel="nofollow">
         Microsoft MSDN
        </a>
       </b>
       <p>
        <br/>
       </p>
       <b>
        <a class="external text" href="http://msdn.microsoft.com/en-us/library/aa259317(v=vs.60).aspx" rel="nofollow">
         Common Dialog Flag Constants
        </a>
       </b>
      </center>
      <dl>
       <dd>
        <dl>
         <dd>
          <dl>
           <dd>
            <dl>
             <dd>
              <dl>
               <dd>
                In VB6, variable-length strings in user
                <a href="/qb64wiki/index.php/TYPE" title="TYPE">
                 TYPEs
                </a>
                are actually pointer
                <a href="/qb64wiki/index.php/OFFSET" title="OFFSET">
                 _OFFSETs
                </a>
                to those strings.
               </dd>
              </dl>
             </dd>
            </dl>
           </dd>
          </dl>
         </dd>
        </dl>
       </dd>
      </dl>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="File_Times">
        File Times
       </span>
      </h2>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> GENERIC_READ = -<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80000000
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> GENERIC_WRITE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>40000000
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FILE_SHARE_READ = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FILE_SHARE_WRITE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> OPEN_EXISTING = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>3
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> INVALID_HANDLE_VALUE = -1

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> CreateFileA%&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpFileName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwDesiredAccess <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, _
<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwShareMode <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpSecurityAttributes <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, _
<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwCreationDisposition <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwFlagsAndAttributes <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, _
<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hTemplateFile <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> CloseHandle&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hObject <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetFileTime&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hFile <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpCreationTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpLastAccessTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpLastWriteTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetFileTime&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hFile <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpCreationTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpLastAccessTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpLastWriteTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FileTimeToLocalFileTime&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpFileTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpLocalFileTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> LocalFileTimeToFileTime&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpLocalFileTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpFileTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FileTimeToSystemTime&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpFileTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpSystemTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SystemTimeToFileTime&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpSystemTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpFileTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetLastError&amp; ()
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> FILETIME
  dwLowDateTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  dwHighDateTime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> SYSTEMTIME
  wYear <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
  wMonth <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
  wDayOfWeek <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
  wDay <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
  wHour <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
  wMinute <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
  wSecond <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
  wMilliseconds <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> CreateDate <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> FILETIME
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> ModifyDate <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> FILETIME
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> AccessDate <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> FILETIME

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> systime <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> SYSTEMTIME

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> FileName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> FileHandle <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>

FileName = "readme.txt" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0) '&lt;&lt;&lt;&lt;&lt;&lt; Existing file in QB64 folder. Use existing file path!

FileHandle = CreateFileA%&amp;(<a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(FileName), GENERIC_<a href="/qb64wiki/index.php/READ" title="READ"><span style="color:#4593D8;">READ</span></a>, FILE_SHARE_<a href="/qb64wiki/index.php/READ" title="READ"><span style="color:#4593D8;">READ</span></a> <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> FILE_SHARE_<a href="/qb64wiki/index.php/WRITE" title="WRITE"><span style="color:#4593D8;">WRITE</span></a>, 0, <a href="/qb64wiki/index.php/OPEN" title="OPEN"><span style="color:#4593D8;">OPEN</span></a>_EXISTING, 0, 0)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> FileHandle &lt;&gt; INVALID_HANDLE_VALUE <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetFileTime&amp;(FileHandle, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(CreateDate), <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(ModifyDate), <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(AccessDate)) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(CreateDate.dwLowDateTime) + <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(CreateDate.dwHighDateTime)
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(ModifyDate.dwLowDateTime) + <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(ModifyDate.dwHighDateTime)
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(AccessDate.dwLowDateTime) + <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(AccessDate.dwHighDateTime)
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>
    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> FileTimeToSystemTime&amp;(<a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(CreateDate), <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(systime)) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Creation time, in GMT, in decimal:"
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Year:"; systime.wYear
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Month:"; systime.wMonth, "("; <a href="/qb64wiki/index.php/MID$_(function)" title="MID$ (function)"><span style="color:#4593D8;">MID$</span></a>("JanFebMarAprMayJunJulAugSepOctNovDec", (systime.wMonth * 3) - 2, 3); ")"
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "DayOfWeek:"; systime.wDayOfWeek, "("; <a href="/qb64wiki/index.php/MID$_(function)" title="MID$ (function)"><span style="color:#4593D8;">MID$</span></a>("SunMonTueWedThuFriSat", (systime.wDayOfWeek * 3) + 1, 3); ")"
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Day"; systime.wDay
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Hour"; systime.wHour
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Minute"; systime.wMinute
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Second"; systime.wSecond
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Milliseconds"; systime.wMilliseconds
    <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "FileTimeToSystemTime failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError&amp;))
    <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "GetFileTime failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError&amp;))
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> CloseHandle&amp;(FileHandle) = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "CloseHandle failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError&amp;))
    <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "CreateFileA failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError&amp;))
  <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Michael Calkins
       </span>
      </center>
      <center>
       Use your own existing file name and path in this procedure.
      </center>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Focus">
        Focus
       </span>
      </h2>
      <dl>
       <dd>
        <b>
         Sets Focus on program with
         <i>
          SetForegroundWindow
         </i>
         after maximizing a minimized program when Shift+A is pressed.
        </b>
        (See
        <a href="/qb64wiki/index.php/Windows_Libraries#Top_Most_Window" title="Windows Libraries">
         Top Most Window
        </a>
        )
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'Uses GetKeyState Win API to monitor a Key state.
'This demo will maximize the window and focus on program when Shift+A is pressed.

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindowA%&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ClassName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, WindowName$) 'find process handle by title
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetKeyState% (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nVirtKey <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>) 'Windows virtual key presses
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> ShowWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nCmdShow <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>) 'maximize process
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetForegroundWindow%&amp; 'find currently focused process handle
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetForegroundWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>) 'set foreground window process(focus)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

title$ = "Cheapo Hotkey (Shift+A)" 'title of program window
<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> title$ 'set program title
hwnd%&amp; = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindowA(0, title$ + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)) 'find this program's process handle

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Minimize window, click another then Press Shift+A to bring it back up."

'=== below minimizes it for you
<a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 4
x&amp; = ShowWindow&amp;(hwnd%&amp;, 2)
'===========================

DO
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetKeyState(16) &lt; 0 <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> GetKeyState(<a href="/qb64wiki/index.php/ASC_(function)" title="ASC (function)"><span style="color:#4593D8;">ASC</span></a>("A")) &lt; 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> '&lt;==== Shift+A
    FGwin%&amp; = GetForegroundWindow%&amp; 'get current process in focus
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Program Handle:"; hwnd%&amp;; "Focus handle:"; FGwin%&amp;

    y&amp; = ShowWindow&amp;(hwnd%&amp;, 1) 'maximize minimized program

    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> FGwin%&amp; &lt;&gt; hwnd%&amp; <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> z&amp; = SetForegroundWindow&amp;(hwnd%&amp;) 'set focus when necessary

    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "That is all. Return values:"; x&amp;; y&amp;; z&amp;

    'PUT PROGRAM CODE OR SUB CALLS HERE!
    '=== below minimizes it for you again after code is done
    '<a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 4
    'x&amp; = ShowWindow&amp;(hwnd%&amp;, 2)
    '===========================
    <a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 5: <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> 'delay allows user to not minimize the window
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

  <a href="/qb64wiki/index.php/LIMIT" title="LIMIT"><span style="color:#4593D8;">_LIMIT</span></a> 30 'save CPU usage while waiting for key press

<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Adapted by Ted Weissgerber from code by Dav
       </span>
      </center>
      <center>
       The
       <i>
        <a href="/qb64wiki/index.php/Windows_Libraries#Window_Focus" title="Windows Libraries">
         GetForegroundWindow
        </a>
       </i>
       function finds the process currently in focus. See:
       <a href="/qb64wiki/index.php/Windows_Libraries#Hot_Keys_(maximize)" title="Windows Libraries">
        Hot Keys for Windows Virtual Keys
       </a>
      </center>
      <p>
       <br/>
      </p>
      <dl>
       <dd>
        <b>
         Always brings unfocused or minimized program to the top with focus when Shift+A hotkey combination is pressed.
        </b>
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'===========
'HOTKEYS.BAS
'===========
'Windows Hotkey example.
'This demo sets Shift+A hotkey to maximize the program window when minimized.
'Returns focus to the program.
'Coded by Dav JULY/2012


<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE CUSTOMTYPE LIBRARY</span></a>
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ClassName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, WindowName$)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> ShowWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nCmdShow <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SendMessageA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> wMsg <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> wParam <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lParam <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> DefWindowProcA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> wMsg <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> wParam <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lParam <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> "My Focus Program"
hwnd = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindow(0, "My Focus Program" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)) 'get Windows program ID by title

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> WM_SETHOTKEY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>32
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> WM_SHOWWINDOW = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>18
'SendMessage function key combination values
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HK_SHIFT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>100 'NOTE: Send Message values are different than HotKey
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HK_CTRL = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>200  'All other keys are the same as the HotKey values.
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HK_ALT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>400

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Press Shift+A to maximize or bring this window to top..."
<a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 3

'=== Tell windows what hotkey you want to use.
hot&amp; = SendMessageA&amp;(hwnd, WM_SETHOTKEY, HK_SHIFT + ASC("A"), 0) 'use uppercase second key
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> hot&amp;;
'=== See if hotkey set ok...
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> hot&amp; &lt;&gt; 1 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Hotkey not set." + "Error: "; hot&amp;
  <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

'===  minimize program with this
'a&amp; = ShowWindow&amp;(hwnd, 6)

'=== Below tells Windows what to do when hotkey is pressed.
'===(it maximizes the program window and returns focus over and over).
top&amp; = DefWindowProcA&amp;(hwnd, WM_SHOWWINDOW, 0, 0)

<a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>: <a href="/qb64wiki/index.php/LIMIT" title="LIMIT"><span style="color:#4593D8;">_LIMIT</span></a> 1
  'do your program stuff here....
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> hot&amp;; top&amp;;
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a> = <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(27)
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Adapted from code by Dav
       </span>
      </center>
      <dl>
       <dd>
        <b>
         Note:
        </b>
        The
        <i>
         SetHotKey
        </i>
        message tells the designated Windows program ID when to do
        <i>
         DefWondowProcA
        </i>
        to focus the window.
       </dd>
      </dl>
      <center>
       <b>
        This can also focus on other program IDs! See also:
        <a href="/qb64wiki/index.php/Windows_Libraries#Hot_Keys_(maximize)" title="Windows Libraries">
         Hot Keys for Windows Virtual Keys
        </a>
       </b>
      </center>
      <p>
       <br/>
      </p>
      <center>
       Note: Minimized programs will always lose focus when minimized unless clicked in taskbar.
      </center>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Folder_Dialog_Box">
        Folder Dialog Box
       </span>
      </h2>
      <dl>
       <dd>
        The SHBrowseForFolder function receives information about the folder selected by the user in Windows XP to 7.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE CUSTOMTYPE LIBRARY</span></a>
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ClassName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, WindowName$)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> "Super Window"
hwnd&amp; = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindow(0, "Super Window" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0))

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> BROWSEINFO  'typedef struct _browseinfo 'Microsoft MSDN
  hwndOwner <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '              '  HWND
  pidlRoot <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '             '  PCIDLIST_ABSOLUTE
  pszDisplayName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '      '  LPTSTR
  lpszTitle <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '           '  LPCTSTR
  ulFlags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>        '  UINT
  lpfn <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '                '  BFFCALLBACK
  lParam <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> '              '  LPARAM
  iImage <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '                 '  int
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>  'BROWSEINFO, *PBROWSEINFO, *LPBROWSEINFO;

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "shell32"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SHBrowseForFolder%&amp; (x <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> BROWSEINFO) 'Microsoft MSDN
  <a href="/qb64wiki/index.php/SUB" title="SUB"><span style="color:#4593D8;">SUB</span></a> SHGetPathFromIDList (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpItem <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> szDir <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>) 'Microsoft MSDN
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> b <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> BROWSEINFO
b.hwndOwner = hwnd
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> s <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a> * 1024
b.pszDisplayName = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(s$)
a$ = "Choose a folder!!!" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
b.lpszTitle = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(a$)
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> o <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
o = SHBrowseForFolder(b)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> o <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(s$, <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(s$, <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)) - 1)
    <a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> s2 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a> * 1024
    SHGetPathFromIDList o, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(s2$)
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(s2$, <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(s2$, <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)) - 1)
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Cancel?"
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code by Galleon
       </span>
      </center>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Font_Dialog_Box">
        Font Dialog Box
       </span>
      </h2>
      <center>
       This dialog box does not return the actual font file name. Refer to the
       <a href="/qb64wiki/index.php/Windows_Libraries#Registered_Fonts" title="Windows Libraries">
        Registered Fonts File
       </a>
       procedure below this one.
      </center>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">' Constants assigned to Flags. A LONG numerical suffix defines those constants as LONG
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_APPLY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>200&amp; '             Displays Apply button
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_ANSIONLY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>400&amp; '          list ANSI fonts only
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_BOTH = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>3&amp; '                list both Screen and Printer fonts
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_EFFECTS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>100&amp;  '          Display Underline and Strike Through boxes
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_ENABLEHOOK = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>8&amp; '          set hook to custom template
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_ENABLETEMPLATE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>10&amp; '     enable custom template
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_ENABLETEMPLATEHANDLE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>20&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_FIXEDPITCHONLY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>4000&amp;  '  list only fixed-pitch fonts
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_FORCEFONTEXIST = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>10000&amp; '  indicate error when font not listed is chosen
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_INACTIVEFONTS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2000000&amp; ' display hidden fonts in Win 7 only
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_INITTOLOGFONTSTRUCT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>40&amp; 'use the structure pointed to by the lpLogFont member
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_LIMITSIZE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2000&amp; '        select font sizes only within nSizeMin and nSizeMax members
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_NOOEMFONTS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>800&amp; '        should not allow vector font selections
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_NOFACESEL = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80000&amp; '       prevent displaying initial selection in font name combo box.
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_NOSCRIPTSEL = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>800000&amp; '    Disables the Script combo box
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_NOSIMULATIONS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1000&amp; '    Disables selection of font simulations
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_NOSIZESEL = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>200000&amp;  '     Disables Point Size selection
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_NOSTYLESEL = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>100000&amp; '     Disables Style selection
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_NOVECTORFONTS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>800&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_NOVERTFONTS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1000000&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_OEMTEXT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>7&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_PRINTERFONTS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2&amp; '        list fonts only supported by printer associated with the device
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_SCALABLEONLY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>20000&amp; '    select only vector fonts, scalable printer fonts, and TrueType fonts
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_SCREENFONTS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1&amp;  '        lists only the screen fonts supported by system
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_SCRIPTSONLY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>400&amp; '       lists all non-OEM, Symbol and ANSI sets only
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_SELECTSCRIPT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>400000&amp;  '  can only use set specified in the Scripts combo box
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_SHOWHELP = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>4&amp;  '           displays Help button reference
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_TTONLY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>40000&amp;  '         True Type only
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_USESTYLE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80&amp; '           copies style data for the user's selection to lpszStyle buffer
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CF_WYSIWYG = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>8000&amp; '          only list fonts available on both the printer and display
' Font Types returned by nFontType
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> BOLD_FONTTYPE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>100&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> ITALIC_FONTTYPE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>200&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> PRINTER_FONTTYPE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>4000&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REGULAR_FONTTYPE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>400&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SCREEN_FONTTYPE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2000&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SIMULATED_FONTTYPE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>8000&amp;
' Font Weights assigned to lfWeight
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FW_DONTCARE = 0
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FW_THIN = 100
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FW_ULTRALIGHT = 200
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FW_LIGHT = 300
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FW_REGULAR = 400
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FW_MEDIUM = 500
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FW_SEMIBOLD = 600
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FW_BOLD = 700
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FW_ULTRABOLD = 800
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FW_HEAVY = 900

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> DEFAULT_CHARSET = 1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> LF_DEFAULT = 0
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> FF_ROMAN = 16
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> LF_FACESIZE = 32
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> GMEM_MOVEABLE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> GMEM_ZEROINIT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>40
'-------------------------------------------------------------------------------------------

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindowA%&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ClassName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> WindowName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "comdlg32"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> ChooseFontA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpcf <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> CommDlgExtendedError&amp; () '                'dialog box error checking procedure
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> CHOOSEFONT
  lStructSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  hwndOwner <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
  HDC <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
  lpLogFont <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
  iPointSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  Flags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  rgbColors <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  lCustData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
  lpfnHook <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
  lpTemplateName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
  hInstance <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
  lpszStyle <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
  nFontType <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> '  if used as Unsigned Integer add Integer padder below
  'padder <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a> ' use only when nFontType is designated as Unsigned Integer
  nSizeMin <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  nSizeMax <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> LOGFONT
  lfHeight <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  lfWidth <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  lfEscapement <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  lfOrientation <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  lfWeight <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  lfItalic <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/BYTE" title="BYTE"><span style="color:#4593D8;">_BYTE</span></a> '    not 0 when user selected
  lfUnderline <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/BYTE" title="BYTE"><span style="color:#4593D8;">_BYTE</span></a> ' not 0 when user selected
  lfStrikeOut <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/BYTE" title="BYTE"><span style="color:#4593D8;">_BYTE</span></a> ' not 0 when user selected
  lfCharSet <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/BYTE" title="BYTE"><span style="color:#4593D8;">_BYTE</span></a>
  lfOutPrecision <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/BYTE" title="BYTE"><span style="color:#4593D8;">_BYTE</span></a>
  lfClipPrecision <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/BYTE" title="BYTE"><span style="color:#4593D8;">_BYTE</span></a>
  lfQuality <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/BYTE" title="BYTE"><span style="color:#4593D8;">_BYTE</span></a>
  lfPitchAndFamily <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/BYTE" title="BYTE"><span style="color:#4593D8;">_BYTE</span></a>
  lfFaceName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a> * 32 'contains name listed in dialog
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> hWnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a> 'must <a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> or hWnd won't work
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> Title <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a> 'keeps Dialog with program window

<a href="/qb64wiki/index.php/SCREEN" title="SCREEN"><span style="color:#4593D8;">SCREEN</span></a> <a href="/qb64wiki/index.php/NEWIMAGE" title="NEWIMAGE"><span style="color:#4593D8;">_NEWIMAGE</span></a>(640, 480, 12) '32 bit, 16 or 256 color screen modes
Title$ = "Choose Font Dialog"
<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> Title$ 'set Title of program
<a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 1
hWnd = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindowA%&amp;(0, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(Title)) 'get window handle

Font$ = ShowFont$(hWnd) '           call Dialog Box and get the font selection
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> Font$, <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(FontColor&amp;), FontType$; FontEff$, PointSize&amp; 'other values <a href="/qb64wiki/index.php/SHARED" title="SHARED"><span style="color:#4593D8;">SHARED</span></a> by function
<a href="/qb64wiki/index.php/COLOR" title="COLOR"><span style="color:#4593D8;">COLOR</span></a> FontColor&amp;: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Font Color Selected"
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> ShowFont$ (hWnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> cf <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> CHOOSEFONT
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> lfont <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> LOGFONT
<a href="/qb64wiki/index.php/SHARED" title="SHARED"><span style="color:#4593D8;">SHARED</span></a> FontColor&amp;, FontType$, FontEff$, PointSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> 'shared with main program
lfont.lfHeight = LF_DEFAULT ' determine default height '       set dailog box defaults
lfont.lfWidth = LF_DEFAULT ' determine default width
lfont.lfEscapement = LF_DEFAULT ' angle between baseline and escapement vector
lfont.lfOrientation = LF_DEFAULT ' angle between baseline and orientation vector
lfont.lfWeight = FW_REGULAR ' normal weight i.e. not bold
lfont.lfCharSet = DEFAULT_CHARSET ' use default character set
lfont.lfOutPrecision = LF_DEFAULT ' default precision mapping
lfont.lfClipPrecision = LF_DEFAULT ' default clipping precision
lfont.lfQuality = LF_DEFAULT ' default quality setting
lfont.lfPitchAndFamily = LF_DEFAULT <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> FF_ROMAN ' default pitch, proportional with serifs
lfont.lfFaceName = "Times New Roman" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0) ' string must be null-terminated
cf.lStructSize = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(cf) ' size of structure
cf.hwndOwner = hWnd ' window opening the dialog box
'cf.HDC = Printer.hDC ' device context of default printer (using VB's mechanism)
cf.lpLogFont = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(lfont)
cf.iPointSize = 120 ' 12 point font (in units of 1/10 point)
cf.Flags = CF_BOTH <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> CF_EFFECTS <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> CF_<a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:#4593D8;">FOR</span></a>CEFONTEXIST <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> CF_INITTOLOGFONTSTRUCT <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> CF_LIMITSIZE
cf.rgbColors = <a href="/qb64wiki/index.php/RGB" title="RGB"><span style="color:#4593D8;">_RGB</span></a>(0, 0, 0) ' black
cf.nFontType = REGULAR_FONTTYPE ' regular font type i.e. not bold or anything
cf.nSizeMin = 10 ' minimum point size
cf.nSizeMax = 72 ' maximum point size

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> ChooseFontA&amp;(<a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(cf)) &lt;&gt; 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> '    'Initiate Dialog and Read user selections
  ShowFont = <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(lfont.lfFaceName, <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(lfont.lfFaceName, <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)) - 1)
  'returns closest color attribute or 32 bit value and swaps red and blue color values
  FontColor&amp; = <a href="/qb64wiki/index.php/RGB" title="RGB"><span style="color:#4593D8;">_RGB</span></a>(<a href="/qb64wiki/index.php/BLUE32" title="BLUE32"><span style="color:#4593D8;">_BLUE32</span></a>(cf.rgbColors), <a href="/qb64wiki/index.php/GREEN32" title="GREEN32"><span style="color:#4593D8;">_GREEN32</span></a>(cf.rgbColors), <a href="/qb64wiki/index.php/RED32" title="RED32"><span style="color:#4593D8;">_RED32</span></a>(cf.rgbColors))
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> cf.nFontType <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> BOLD_FONTTYPE <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> FontType$ = "Bold"
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> cf.nFontType <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> ITALIC_FONTTYPE <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> FontType$ = FontType$ + "Italic"
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> cf.nFontType <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> REGULAR_FONTTYPE <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> FontType$ = "Regular"
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> lfont.lfUnderline <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> FontEff$ = "Underline"
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> lfont.lfStrikeOut <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> FontEff$ = FontStyle$ + "Strikeout"
  PointSize = cf.iPointSize \ 10
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> CommDlgExtendedError&amp; <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "ChooseFontA failed. Error: 0x"; <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(CommDlgExtendedError&amp;))
  <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Entry was cancelled!"
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code by Michael Calkins and Ted Weissgerber
       </span>
      </center>
      <center>
       <b>
        Warning! This dialog box may error for no apparent reason! See
        <a class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms646916(v=vs.85).aspx" rel="nofollow">
         CommDlgExtendedError
        </a>
        for more info!
       </b>
      </center>
      <p>
       <br/>
      </p>
      <dl>
       <dd>
        <i>
         Snippet:
        </i>
        Shows how to compare a Font Dialog Box request with
        <a href="/qb64wiki/index.php/STRING" title="STRING">
         STRING
        </a>
        file data created by the
        <a href="/qb64wiki/index.php/Windows_Libraries#Registered_Fonts" title="Windows Libraries">
         Registry Font Library
        </a>
        below:
       </dd>
      </dl>
      <table cellpadding="5px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="outputtext">' procedure assumes that all fonts have been loaded into an array as below:
RegFont$(1) = "Times New Roman (TrueType) = TIMES.TTF" 'array simulates registry data from file
RegFont$(2) = "Times New Roman Bold (TrueType) = TIMESBD.TTF"
RegFont$(3) = "Times New Roman Bold Italic (TrueType) = TIMESBI.TTF"
RegFont$(4) = "Times New Roman Italic (TrueType) = TIMESI.TTF"
Font$ = "Times New Roman Bold Italic" 'font name returned by Font Dialog box
File$ = ""

<a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:blue;">FOR</span></a> n = 1 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:blue;">TO</span></a> 4 'numFiles% 'actual number of font file registry records
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:blue;">INSTR</span></a>$(RegFont$(n), Font$) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a> 'check for match of Dialog Box font name "Times New Roman"
  FontFile$ = <a href="/qb64wiki/index.php/MID$_(function)" title="MID$ (function)"><span style="color:blue;">MID$</span></a>(RegFont$(n), <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "=") + 2)   'get each file name value
  <a href="/qb64wiki/index.php/SELECT_CASE" title="SELECT CASE"><span style="color:blue;">SELECT CASE</span></a> FontType$   'check for user requested font type to get file name
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:blue;">CASE</span></a> "Bold"
    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Bold") <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:blue;">AND</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Italic") = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a> File$ = FontFile$
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:blue;">CASE</span></a> "Italic"
    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Italic") <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:blue;">AND</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Bold") = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a> File$ = FontFile$
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:blue;">CASE</span></a> "BoldItalic"
    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Bold") <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:blue;">AND</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Italic") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a> File$ = FontFile$
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE_ELSE" title="CASE ELSE"><span style="color:blue;">CASE ELSE</span></a> 'regular font as default
    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Bold") = 0 <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:blue;">AND</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:blue;">INSTR</span></a>(RegFont$(n), "Italic") = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a> File$ = FontFile$
  <a href="/qb64wiki/index.php/END_SELECT" title="END SELECT"><span style="color:blue;">END SELECT</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:blue;">END IF</span></a>
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:blue;">LEN</span></a>(File$) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a> <a href="/qb64wiki/index.php/EXIT_FOR" title="EXIT FOR"><span style="color:blue;">EXIT FOR</span></a>  'quit searching
<a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:blue;">NEXT</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        The Font Dialog name will not normally have descriptions such as Regular, Bold, Italics or (TrueType) so it ignores them.
       </dd>
      </dl>
      <p>
       <br/>
      </p>
      <center>
       <b>
        <a class="external text" href="http://www.functionx.com/win32/Lesson14.htm" rel="nofollow">
         GDI Tools - Font Guidlines
        </a>
       </b>
      </center>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Registered_Fonts">
        Registered Fonts
       </span>
      </h2>
      <dl>
       <dd>
        The Registry lists the Font Names and associated TTF file names that are needed with the
        <a href="/qb64wiki/index.php/Windows_Libraries#Font_Dialog_Box" title="Windows Libraries">
         Font Dialog Box
        </a>
        in a program.
       </dd>
       <dd>
        The following program uses Registry functions from
        <i>
         advapi32.dll
        </i>
        to read the list of registered fonts and put them into a file.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">' winreg.h
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HKEY_CLASSES_ROOT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80000000~&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HKEY_CURRENT_USER = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80000001~&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HKEY_LOCAL_MACHINE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80000002~&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HKEY_USERS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80000003~&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HKEY_PERFORMANCE_DATA = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80000004~&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HKEY_CURRENT_CONFIG = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80000005~&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HKEY_DYN_DATA = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80000006~&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_OPTION_VOLATILE = 1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_OPTION_NON_VOLATILE = 0
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_CREATED_NEW_KEY = 1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_OPENED_EXISTING_KEY = 2

' <b><a class="external free" href="http://msdn.microsoft.com/en-us/library/ms724884(v=VS.85).aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/ms724884(v=VS.85).aspx</a></b>
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_NONE = 0
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_SZ = 1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_EXPAND_SZ = 2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_BINARY = 3
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_DWORD_LITTLE_ENDIAN = 4  '   value is defined REG_DWORD in Windows header files
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_DWORD = 4 '                  32-bit number
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_DWORD_BIG_ENDIAN = 5 '       some UNIX systems support big-endian architectures
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_LINK = 6
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_MULTI_SZ = 7
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_RESOURCE_LIST = 8
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_FULL_RESOURCE_DESCRIPTOR = 9
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_RESOURCE_REQUIREMENTS_LIST = 10
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_QWORD_LITTLE_ENDIAN = 11  '  64-bit number in little-endian format
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_QWORD = 11 '                 64-bit number
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_NOTIFY_CHANGE_NAME = 1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_NOTIFY_CHANGE_ATTRIBUTES = 2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_NOTIFY_CHANGE_LAST_SET = 4
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> REG_NOTIFY_CHANGE_SECURITY = 8

' <b><a class="external free" href="http://msdn.microsoft.com/en-us/library/ms724878(v=VS.85).aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/ms724878(v=VS.85).aspx</a></b>
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_ALL_ACCESS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>F003F&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_CREATE_LINK = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0020&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_CREATE_SUB_KEY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0004&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_ENUMERATE_SUB_KEYS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0008&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_EXECUTE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>20019&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_NOTIFY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0010&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_QUERY_VALUE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0001&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_READ = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>20019&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_SET_VALUE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0002&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_WOW64_32KEY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0200&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_WOW64_64KEY = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0100&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEY_WRITE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>20006&amp;

' winerror.h
' <b><a class="external free" href="http://msdn.microsoft.com/en-us/library/ms681382(v=VS.85).aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/ms681382(v=VS.85).aspx</a></b>
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> ERROR_SUCCESS = 0
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> ERROR_FILE_NOT_FOUND = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> ERROR_INVALID_HANDLE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>6&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> ERROR_MORE_DATA = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>EA&amp;
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> ERROR_NO_MORE_ITEMS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>103&amp;
'---------------------------------------------------------------------------------------------
' REGSAM is an ACCESS_MASK (winreg.h), which is a DWORD (winnt.h)

'Note: All of these functions, except RegCloseKey, have both ANSI (ending in A)
'and Unicode (ending in W) versions. I am not aware of any reason why both
'versions could not be used in the same program. To add the Unicode version,
'duplicate the function declaration, but change the ending A to W. Be sure that
'you know how to use the <a href="/qb64wiki/index.php/Unicode" title="Unicode"><span style="color:#4593D8;">Unicode</span></a> version! ANSI versions tested, sort of:

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "advapi32"

  ' <b><a class="external free" href="http://msdn.microsoft.com/en-us/library/ms724897(v=VS.85).aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/ms724897(v=VS.85).aspx</a></b>
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> RegOpenKeyExA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hKey <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpSubKey <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ulOptions <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> samDesired <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> phkResult <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)

  ' <b><a class="external free" href="http://msdn.microsoft.com/en-us/library/ms724837(v=VS.85).aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/ms724837(v=VS.85).aspx</a></b>
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> RegCloseKey&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hKey <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)

  ' <b><a class="external free" href="http://msdn.microsoft.com/en-us/library/ms724865(v=VS.85).aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/ms724865(v=VS.85).aspx</a></b>
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> RegEnumValueA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hKey <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwIndex <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpValueName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>,_
 <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpcchValueName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpReserved <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpType <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>,_
 <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpcbData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> hKey <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> Ky <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> SubKey <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> Value <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> bData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> t <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> dwType <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> numBytes <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> numTchars <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> l <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> dwIndex <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>

<a href="/qb64wiki/index.php/OPEN" title="OPEN"><span style="color:#4593D8;">OPEN</span></a> "F0NTList.INF" <a href="/qb64wiki/index.php/FOR" title="FOR"><span style="color:#4593D8;">FOR</span></a> <a class="mw-redirect" href="/qb64wiki/index.php/OUTPUT" title="OUTPUT"><span style="color:#4593D8;">OUTPUT</span></a> <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> #1  'create a new file for font data
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "This key lists the registered fonts available to all users:"
Ky = HKEY_LOCAL_MACHINE
SubKey = "SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
Value = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(261) 'ANSI Value name limit 260 chars + 1 null
bData = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>7FFF) 'arbitrary

l = RegOpenKeyExA(Ky, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(SubKey), 0, KEY_READ, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(hKey))
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> l <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "RegOpenKeyExA failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(l))
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> whatKey$(Ky) + "\" + SubKey
  dwIndex = 0
  DO
    <a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> .1
    numBytes = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(bData)
    numTchars = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(Value)
    l = RegEnumValueA(hKey, dwIndex, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(Value), <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(numTchars), 0, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(dwType), <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(bData), <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(numBytes))
    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> l <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
      <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> l &lt;&gt; ERROR_NO_MORE_ITEMS <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
        <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "RegEnumValueA failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(l))
      <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
      <a href="/qb64wiki/index.php/EXIT_DO" title="EXIT DO"><span style="color:#4593D8;">EXIT DO</span></a>
    <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> whatType(dwType) + " " + <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(Value, numTchars) + " = " + formatData(dwType, numBytes, bData)
      <a href="/qb64wiki/index.php/PRINT_(file_statement)" title="PRINT (file statement)"><span style="color:#4593D8;">PRINT</span></a> #1, <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(Value, numTchars) + " = " + formatData(dwType, numBytes, bData)
    <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
    dwIndex = dwIndex + 1
  <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a>
  <a href="/qb64wiki/index.php/CLOSE" title="CLOSE"><span style="color:#4593D8;">CLOSE</span></a> #1
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> dwIndex; "Values."
  l = RegCloseKey(hKey)
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> l <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "RegCloseKey failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(l))
    <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> whatType$ (dwType <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/SELECT_CASE" title="SELECT CASE"><span style="color:#4593D8;">SELECT CASE</span></a> dwType
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_SZ: whatType = "REG_SZ"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_EXPAND_SZ: whatType = "REG_EXPAND_SZ"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_BINARY: whatType = "REG_BINARY"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_DWORD: whatType = "REG_DWORD"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_DWORD_BIG_ENDIAN: whatType = "REG_DWORD_BIG_ENDIAN"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_LINK: whatType = "REG_LINK"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_MULTI_SZ: whatType = "REG_MULTI_SZ"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_RESOURCE_LIST: whatType = "REG_RESOURCE_LIST"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_FULL_RESOURCE_DESCRIPTOR: whatType = "REG_FULL_RESOURCE_DESCRIPTOR"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_RESOURCE_REQUIREMENTS_LIST: whatType = "REG_RESOURCE_REQUIREMENTS_LIST"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_QWORD: whatType = "REG_QWORD"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE_ELSE" title="CASE ELSE"><span style="color:#4593D8;">CASE ELSE</span></a>: whatType = "unknown"
<a href="/qb64wiki/index.php/END_SELECT" title="END SELECT"><span style="color:#4593D8;">END SELECT</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> whatKey$ (hKey <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/SELECT_CASE" title="SELECT CASE"><span style="color:#4593D8;">SELECT CASE</span></a> hKey
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> HKEY_CLASSES_ROOT: whatKey = "HKEY_CLASSES_ROOT"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> HKEY_CURRENT_USER: whatKey = "HKEY_CURRENT_USER"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> HKEY_LOCAL_MACHINE: whatKey = "HKEY_LOCAL_MACHINE"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> HKEY_USERS: whatKey = "HKEY_USERS"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> HKEY_PERFORMANCE_DATA: whatKey = "HKEY_PERFORMANCE_DATA"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> HKEY_CURRENT_CONFIG: whatKey = "HKEY_CURRENT_CONFIG"
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> HKEY_DYN_DATA: whatKey = "HKEY_DYN_DATA"
<a href="/qb64wiki/index.php/END_SELECT" title="END SELECT"><span style="color:#4593D8;">END SELECT</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> formatData$ (dwType <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, numBytes <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, bData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>)
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> t <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> ul <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> b <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/BYTE" title="BYTE"><span style="color:#4593D8;">_BYTE</span></a>
<a href="/qb64wiki/index.php/SELECT_CASE" title="SELECT CASE"><span style="color:#4593D8;">SELECT CASE</span></a> dwType
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_SZ, REG_EXPAND_SZ, REG_MULTI_SZ
    formatData = <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(bData, numBytes - 1)
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> REG_DWORD
    t = <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(<a href="/qb64wiki/index.php/CVL" title="CVL"><span style="color:#4593D8;">CVL</span></a>(<a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(bData, 4))))
    formatData = "0x" + <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(8 - <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(t), <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>30) + t
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE_ELSE" title="CASE ELSE"><span style="color:#4593D8;">CASE ELSE</span></a>
    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> numBytes <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
      b = <a href="/qb64wiki/index.php/ASC_(function)" title="ASC (function)"><span style="color:#4593D8;">ASC</span></a>(<a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(bData, 1))
      <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> b &lt; <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>10 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
        t = t + "0" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(b))
      <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
        t = t + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(b))
      <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
    <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
    <a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:#4593D8;">FOR</span></a> ul = 2 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:#4593D8;">TO</span></a> numBytes
      b = <a href="/qb64wiki/index.php/ASC_(function)" title="ASC (function)"><span style="color:#4593D8;">ASC</span></a>(<a href="/qb64wiki/index.php/MID$_(function)" title="MID$ (function)"><span style="color:#4593D8;">MID$</span></a>(bData, ul, 1))
      <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> b &lt; <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>10 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
        t = t + " 0" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(b))
      <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
        t = t + " " + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(b))
      <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
    <a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:#4593D8;">NEXT</span></a>
    formatData = t
<a href="/qb64wiki/index.php/END_SELECT" title="END SELECT"><span style="color:#4593D8;">END SELECT</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Michael Calkins
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        The names used in a Font Dialog Box and the actual file names are saved to the
        <i>
         F0NTList.INF
        </i>
        (name uses zero) file to be compared with user entries. To check for
        <i>
         Bold
        </i>
        and
        <i>
         Italics
        </i>
        or combined types of font requests see
        <a href="/qb64wiki/index.php/Windows_Libraries#Font_Dialog_Box" title="Windows Libraries">
         Font Dialog Box Library
        </a>
        above.
       </dd>
      </dl>
      <center>
       <b>
        Note: The above procedure only reads the Registry.
        <span style="color:red;">
         Edit or alter the Registry at your own peril!
        </span>
       </b>
      </center>
      <p>
       <br/>
      </p>
      <center>
       <a href="/qb64wiki/index.php/Windows_Registry_Access" title="Windows Registry Access">
        Windows Registry Libraries
       </a>
      </center>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Game_Pad">
        Game Pad
       </span>
      </h2>
      <dl>
       <dd>
        Function
        <i>
         joyGetPosEx
        </i>
        allows for more buttons and dual analog multiple sticks
       </dd>
      </dl>
      <table cellpadding="5px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="outputtext"><a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:blue;">DECLARE DYNAMIC LIBRARY</span></a> "winmm"
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> joyGetNumDevs% () ' Number of joysticks supported on system
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> joyGetPosEx&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:blue;">BYVAL</span></a> uJoyID <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>)
<a class="mw-redirect" href="/qb64wiki/index.php/END_DECLARE" title="END DECLARE"><span style="color:blue;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:blue;">TYPE</span></a> JOYINFOEX
    dwSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwFlags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwXpos <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwYpos <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwZpos <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwRpos <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwUpos <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwVpos <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwButtons <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwButtonNumber <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwPOV <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwReserved1 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    dwReserved2 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:blue;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:blue;">TYPE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:blue;">DIM</span></a> Joy1 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFOEX
Joy1.dwSize = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:blue;">LEN</span></a>(Joy1)

DO
    x&amp; = joyGetPosEx(0, Joy1.dwSize)

    <a href="/qb64wiki/index.php/LOCATE" title="LOCATE"><span style="color:blue;">LOCATE</span></a> 1, 1:
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwSize
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwFlags
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwXpos
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwYpos
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwZpos
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwRpos
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwUpos
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> Joy1.dwVpos

<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:blue;">INKEY$</span></a> &lt;&gt; ""
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Unseenmachine
       </span>
      </center>
      <table cellpadding="5px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="outputtext"><a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:blue;">DECLARE DYNAMIC LIBRARY</span></a> "winmm"
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> joyGetNumDevs% () ' Number of joysticks supported on system
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> joyGetPos&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:blue;">BYVAL</span></a> uJoyID <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:blue;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:blue;">TYPE</span></a> JOYINFO
    wXpos <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    wYpos <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    wZpos <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    wButtons <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:blue;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:blue;">TYPE</span></a>

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:blue;">TYPE</span></a> PadCalibration
    IsAnalog <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    XMin <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    YMin <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    XMax <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    YMax <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    XNorm <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    YNorm <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:blue;">LONG</span></a>
    Button1 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    Button2 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    Button3 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    Button4 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    Button5 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
    Button6 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:blue;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:blue;">TYPE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:blue;">DIM</span></a> MyJoyCal <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> PadCalibration, MyJoy <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFO


'// Simple calibration.

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 1 (A on XBox | X on PS3) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &gt; 0
MyJoyCal.Button1 = MyJoy.wButtons
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 2 (B on XBox | Circle on PS3) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &lt;&gt; 0
MyJoyCal.Button2 = MyJoy.wButtons
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 3 (X on XBox | Square on PS3) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &lt;&gt; 0
MyJoyCal.Button3 = MyJoy.wButtons
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 4 (Y on XBox | Triangle on PS3) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &lt;&gt; 0
MyJoyCal.Button4 = MyJoy.wButtons
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 5 (R1) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &lt;&gt; 0
MyJoyCal.Button5 = MyJoy.wButtons
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Press button 6 (L1) "
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons &lt;&gt; 0
MyJoyCal.Button6 = MyJoy.wButtons
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Leave the joystick in its central position and press button 1"
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons = MyJoyCal.Button1
MyJoyCal.XNorm = MyJoy.wXpos
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Push the joystick as far left as possible and press button 1"
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons = MyJoyCal.Button1
MyJoyCal.XMin = MyJoy.wXpos
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Push the joystick as far right as possible and press button 1"
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons = MyJoyCal.Button1
MyJoyCal.XMax = MyJoy.wXpos
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Push the joystick as far up as possible and press button 1"
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons = MyJoyCal.Button1
MyJoyCal.YMin = MyJoy.wXpos
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Push the joystick as far down as possible and press button 1"
DO
    d% = JoyButtons(0, MyJoy, MyJoyCal)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> MyJoy.wButtons = MyJoyCal.Button1
MyJoyCal.YMax = MyJoy.wXpos
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:blue;">SLEEP</span></a> 1

<a href="/qb64wiki/index.php/CLS" title="CLS"><span style="color:blue;">CLS</span></a>

'//How to get the gamepads status.

DO
    a% = StickXPos(0, MyJoy, MyJoyCal)
    b% = StickYPos(0, MyJoy, MyJoyCal)
    c% = StickZPos(0, MyJoy, MyJoyCal)
    d% = JoyButton1(0, MyJoy, MyJoyCal)
    e% = JoyButton2(0, MyJoy, MyJoyCal)
    f% = JoyButton3(0, MyJoy, MyJoyCal)
    g% = JoyButton4(0, MyJoy, MyJoyCal)
    h% = JoyButton5(0, MyJoy, MyJoyCal)
    i% = JoyButton6(0, MyJoy, MyJoyCal)

    <a href="/qb64wiki/index.php/LOCATE" title="LOCATE"><span style="color:blue;">LOCATE</span></a> 1, 1: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "X axis : ", MyJoy.wXpos
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Y axis : ", MyJoy.wYpos
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Z axis : ", MyJoy.wZpos
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 1 : ", d%
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 2 : ", e%
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 3 : ", f%
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 4 : ", g%
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 5 : ", h%
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:blue;">PRINT</span></a> "Button 6 : ", i%

<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:blue;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:blue;">UNTIL</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:blue;">INKEY$</span></a> &lt;&gt; ""


'// Functions

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> StickXPos (Index <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
StickXPos = Joyref.wXpos
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> StickYPos (Index <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
StickYPos = Joyref.wYpos
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> StickZPos (Index <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
StickZPos = Joyref.wZpos
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButtons (Index <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
JoyButtons = Joyref.wButtons
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton1 (Index <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button1 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton1 = -1
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton1 = 0
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:blue;">END IF</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton2 (Index <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button2 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton2 = -1
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton2 = 0
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:blue;">END IF</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton3 (Index <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button3 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton3 = -1
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton3 = 0
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:blue;">END IF</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton4 (Index <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button4 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton4 = -1
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton4 = 0
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:blue;">END IF</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton5 (Index <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button5 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton5 = -1
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton5 = 0
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:blue;">END IF</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:blue;">FUNCTION</span></a> JoyButton6 (Index <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:blue;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:blue;">INTEGER</span></a>, Joyref <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> JOYINFO, JoyCal <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:blue;">AS</span></a> PadCalibration)
x = joyGetPos(Index, Joyref.wXpos)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:blue;">IF</span></a> Joyref.wButtons = JoyCal.Button6 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:blue;">THEN</span></a>
    JoyButton6 = -1
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:blue;">ELSE</span></a>
    JoyButton6 = 0
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:blue;">END IF</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:blue;">END FUNCTION</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span id="Hot_Keys_.28maximize.29">
       </span>
       <span class="mw-headline" id="Hot_Keys_(maximize)">
        Hot Keys (maximize)
       </span>
      </h2>
      <dl>
       <dd>
        <b>
         Maximizing a minimized program window not in focus using Shift + A as read by the Windows
         <i>
          GetKeyState
         </i>
         function.
        </b>
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'=================
'CHEAPO-HOTKEY.BAS
'=================
'Uses GetKeyState Win API to monitor a Key state.
'This demo will maximize the window when Shift+A is pressed at any time.

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindowA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ClassName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, WindowName$) 'handle by title
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetKeyState% (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nVirtKey <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>) 'reads Windows key presses independently
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> ShowWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nCmdShow <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>) 'minimize or maximize
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

title$ = "Cheapo Hotkey (Shift+A)" 'string variable avoids title typo's
<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> title$
hwnd&amp; = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindowA(0, title$ + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0))

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Minimize this window, then Press Shift+A to bring it back up."

'=== below minimizes it for you
'<a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 4
'x&amp; = ShowWindow&amp;(hwnd&amp;, 2)
'===========================

DO
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetKeyState(16) &lt; 0 <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> GetKeyState(<a href="/qb64wiki/index.php/ASC_(function)" title="ASC (function)"><span style="color:#4593D8;">ASC</span></a>("A")) &lt; 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> '&lt;==== Shift+A
      y&amp; = ShowWindow&amp;(hwnd&amp;, 1)
      <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "That is all. Hoped it worked."; x&amp;; y&amp;
      <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

  <a href="/qb64wiki/index.php/LIMIT" title="LIMIT"><span style="color:#4593D8;">_LIMIT</span></a> 30 'Don't be a hog
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Dav
       </span>
      </center>
      <dl>
       <dd>
        <b>
         Note:
        </b>
        Virtual Hot keys can be used when a QB64 program is
        <b>
         not in focus
        </b>
        too! See
        <b>
         <a href="/qb64wiki/index.php/Windows_Libraries#Focus" title="Windows Libraries">
          Focus
         </a>
        </b>
        to bring a QB64 program into focus.
       </dd>
      </dl>
      <table cellpadding="5px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="outputfixed">'                                  <b>Virtual KeyState Codes</b>
'
' <b> Esc  F1  F2  F3  F4  F5  F6  F7  F8  F9  F10  F11 F12   Sys ScL Pause</b>
'  27   112 113 114 115 116 117 118 119 120 121  122 123   44  145 19
' <b> `~  1!  2@  3#  4$  5%  6^  7&amp;  8* 9(  0) -_  =+  BkS   Ins Hme PUp   NumL  /   *    -</b>
'  192 49  50  51  52  53  54  55  56  57 48 189 187  8    45  36  33    144  111  106 109
' <b> Tab Q   W   E   R   T   Y   U   I   O   P  [{  ]}  \|   Del End PDn   7Hme 8/▲  9PU  +</b>
'   9  81  87  69  82  84  89  85  73  79  80 219 221 120  46  35  34    103  104  105 107
' <b> CapL  A   S   D   F   G   H   J   K   L   ;:  '" Enter                4/◄-  5   6/-► E</b>
'   20   65  83  68  70  71  72  74  75  76 186 222  13                  100  101  102  <b>n</b>
' <b> Shift  Z   X   C   V   B   N   M   ,&lt;  .&gt;  /?    Shift       ▲        1End 2/▼  3PD  t</b>
'  16/160 90  88  67  86  66  78  77 188  190 191   16/161      38       97   98   99   <b>e</b>
' <b> Ctrl   Win   Alt       Spacebar      Alt Win Menu Ctrl   ◄-  ▼   -►   0Ins     .Del  r</b>
'  17/162 91  18/164        32        18/165 92  93 17/163  37  40  39   96        110  13
'
'      Num Lock On values shown. Off values same as functions and arrows, 5 = code 12.
'
'  <b>Mouse click returns: LB = 1, RB = 2, MB = 4, etc. <a class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx" rel="nofollow">Special keys</a> may also work.</b>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        NOTE: The above commented table can be copied and pasted directly into the QB64 IDE
       </span>
      </center>
      <p>
       <br/>
      </p>
      <dl>
       <dd>
        <b>
         Invisible key and mouse logger that does not require program focus. Press ESCape key to view the logged activity.
        </b>
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/$CONSOLE" title="$CONSOLE"><span style="color:#4593D8;">$CONSOLE</span></a>
<a href="/qb64wiki/index.php/DEST" title="DEST"><span style="color:#4593D8;">_DEST</span></a> <a href="/qb64wiki/index.php/CONSOLE" title="CONSOLE"><span style="color:#4593D8;">_CONSOLE</span></a> ' for demonstration only
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "The actual program is hiding. Type some stuff!"
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Press ESC to quit logging keys and see results.":
<a href="/qb64wiki/index.php/DEST" title="DEST"><span style="color:#4593D8;">_DEST</span></a> 0
'====================== End Demo Console Code ===============================
<a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a> : <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> <a href="/qb64wiki/index.php/SCREENEXISTS" title="SCREENEXISTS"><span style="color:#4593D8;">_SCREENEXISTS</span></a> 'to prevent unexpected freezing
<a href="/qb64wiki/index.php/SCREENHIDE" title="SCREENHIDE"><span style="color:#4593D8;">_SCREENHIDE</span></a> 'makes the program invisible to the user. Escape key displays log!

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>  'function is already used by QB64 so "User32" is not required
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetAsyncKeyState% (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> vkey <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> theitem$(1000)

<a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>: <a href="/qb64wiki/index.php/LIMIT" title="LIMIT"><span style="color:#4593D8;">_LIMIT</span></a> 100
  <a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:#4593D8;">FOR</span></a> thekey = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>30 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:#4593D8;">TO</span></a> <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>5A
    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetAsyncKeyState(thekey) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
      theitem$(a) = theitem$(a) + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(thekey)
      <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>
      <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> GetAsyncKeyState(thekey) = 0
    <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:#4593D8;">NEXT</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetAsyncKeyState(1) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    a = a + 1
    theitem$(a) = "{MOUSE LEFT}"
    <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>
    <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> GetAsyncKeyState(1) = 0
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetAsyncKeyState(2) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    a = a + 1
    theitem$(a) = "{MOUSE RIGHT}"
    <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>
    <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> GetAsyncKeyState(2) = 0
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetAsyncKeyState(4) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    a = a + 1
    theitem$(a) = "{MOUSE MIDDLE}"
    <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>
    <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> GetAsyncKeyState(4) = 0
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetAsyncKeyState(8) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    theitem$(a) = theitem$(a) + "{BS}"
    <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>
    <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> GetAsyncKeyState(8) = 0
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetAsyncKeyState(9) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    theitem$(a) = theitem$(a) + "{TAB}"
    <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>
    <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> GetAsyncKeyState(9) = 0
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetAsyncKeyState(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>D) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    a = a + 1
    theitem$(a) = "{ENTER}"
    <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>
    <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> GetAsyncKeyState(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>D) = 0
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetAsyncKeyState(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>14) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    theitem$(a) = theitem$(a) + "{CAPS <a href="/qb64wiki/index.php/LOCK" title="LOCK"><span style="color:#4593D8;">LOCK</span></a>}"
    <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>
    <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> GetAsyncKeyState(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>14) = 0
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetAsyncKeyState(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>20) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    theitem$(a) = theitem$(a) + " "
    <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>
    <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> GetAsyncKeyState(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>20) = 0
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> GetAsyncKeyState(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1B) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    theitem$(a) = theitem$(a) + "{ESC}"
    <a href="/qb64wiki/index.php/EXIT_DO" title="EXIT DO"><span style="color:#4593D8;">EXIT DO</span></a> 'ESC key exits loop and prints logged key presses
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a>

<a href="/qb64wiki/index.php/SCREENSHOW" title="SCREENSHOW"><span style="color:#4593D8;">_SCREENSHOW</span></a> 'makes program visible with ESC key press
<a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:#4593D8;">FOR</span></a> b = 0 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:#4593D8;">TO</span></a> a
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> theitem$(b)
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> b <a href="/qb64wiki/index.php/MOD" title="MOD"><span style="color:#4593D8;">MOD</span></a> 20 = 19 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/COLOR" title="COLOR"><span style="color:#4593D8;">COLOR</span></a> 12: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "press any key": <a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a>: <a href="/qb64wiki/index.php/COLOR" title="COLOR"><span style="color:#4593D8;">COLOR</span></a> 7
<a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:#4593D8;">NEXT</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code by Cyperium
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        The program will run invisibly without a program icon appearing in the task bar until the ESC key is pressed and the log will be displayed.
       </dd>
      </dl>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Keyboard_Lock_Settings">
        Keyboard Lock Settings
       </span>
      </h2>
      <p>
       Change Cap Lock, Scroll Lock and Number Lock settings and respective lights or onscreen indicators.
      </p>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'public domain, 2012 april, michael calkins
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> INPUT_KEYBOARD = 1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEYEVENTF_KEYDOWN = 0
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEYEVENTF_KEYUP = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> VK_CAPITAL = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>14
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> VK_NUMLOCK = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>90
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> VK_SCROLL = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>91

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> scCapital = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>3A
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> scNumlock = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>45
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> scScroll = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>46

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetLastError~&amp; ()
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SendInput~&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nInputs~&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> pInputs%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> cbSize&amp;)
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetMessageExtraInfo%&amp; ()
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> KeyInputStruc
 type <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
 wVk <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
 wScan <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>
 dwFlags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
 time <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
 dwExtraInfo <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
 pad0 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a> 'to accomodate the size of a MOUSEINPUT
 pad1 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> ki(0 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:#4593D8;">TO</span></a> 1) <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> KeyInputStruc '2 index array will be zero initialized

ki(0).type = INPUT_KEYBOARD
ki(1).type = INPUT_KEYBOARD
ki(0).dwFlags = KEYEVENTF_KEYDOWN
ki(1).dwFlags = KEYEVENTF_KEYUP
ki(0).dwExtraInfo = GetMessageExtraInfo 'read function value
ki(1).dwExtraInfo = ki(0).dwExtraInfo   'assign same value

<a href="/qb64wiki/index.php/RANDOMIZE" title="RANDOMIZE"><span style="color:#4593D8;">RANDOMIZE</span></a> <a href="/qb64wiki/index.php/TIMER_(function)" title="TIMER (function)"><span style="color:#4593D8;">TIMER</span></a>
<a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a> = <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1B)
 <a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 2
 <a href="/qb64wiki/index.php/SELECT_CASE" title="SELECT CASE"><span style="color:#4593D8;">SELECT CASE</span></a> <a href="/qb64wiki/index.php/INT" title="INT"><span style="color:#4593D8;">INT</span></a>(<a href="/qb64wiki/index.php/RND" title="RND"><span style="color:#4593D8;">RND</span></a> * 3)
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 0
   ki(0).wVk = VK_NUMLOCK
   ki(1).wVk = VK_NUMLOCK
   ki(0).wScan = scNumlock
   ki(1).wScan = scNumlock
   <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Num lock..."
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 1
   ki(0).wVk = VK_CAPITAL
   ki(1).wVk = VK_CAPITAL
   ki(0).wScan = scCapital
   ki(1).wScan = scCapital
   <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Caps lock..."
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 2
   ki(0).wVk = VK_SCROLL
   ki(1).wVk = VK_SCROLL
   ki(0).wScan = scScroll
   ki(1).wScan = scScroll
   <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Scroll lock..."
 <a href="/qb64wiki/index.php/END_SELECT" title="END SELECT"><span style="color:#4593D8;">END SELECT</span></a>
 l = SendInput(2, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(ki(0)), <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(ki(0))) '2 tells function to read two indices(0 and 1)
 <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> l &lt;&gt; 2 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> l
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError))
 <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code by Michael Calkins
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        In QB64 the number pad lock does not affect the
        <a href="/qb64wiki/index.php/INP" title="INP">
         INP
        </a>
        (&amp;H60) release code returns of the
        <a href="/qb64wiki/index.php/Extended_keys" title="Extended keys">
         extended keys
        </a>
        like it did in QBasic.
       </dd>
      </dl>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Message_Box">
        Message Box
       </span>
      </h2>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'Message Box Constant values as defined by Microsoft (MBType)
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_OK&amp; = 0                'OK button only
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_OKCANCEL&amp; = 1          'OK &amp; Cancel
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_ABORTRETRYIGNORE&amp; = 2  'Abort, Retry &amp; Ignore
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_YESNOCANCEL&amp; = 3       'Yes, No &amp; Cancel
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_YESNO&amp; = 4             'Yes &amp; No
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_RETRYCANCEL&amp; = 5       'Retry &amp; Cancel
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_CANCELTRYCONTINUE&amp; = 6 'Cancel, Try Again &amp; Continue
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_ICONSTOP&amp; = 16         'Error stop sign icon
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_ICONQUESTION&amp; = 32     'Question-mark icon
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_ICONEXCLAMATION&amp; = 48  'Exclamation-point icon
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_ICONINFORMATION&amp; = 64  'Letter i in a circle icon
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_DEFBUTTON1&amp; = 0        '1st button default(left)
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_DEFBUTTON2&amp; = 256      '2nd button default
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_DEFBUTTON3&amp; = 512      '3rd button default(right)
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_APPLMODAL&amp; = 0         'Message box applies to application only
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_SYSTEMMODAL&amp; = 4096    'Message box on top of all other windows
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_SETFOCUS&amp; = 65536      'Set message box as focus
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDOK&amp; = 1                 'OK button pressed
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDCANCEL&amp; = 2             'Cancel button pressed
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDABORT&amp; = 3              'Abort button pressed
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDRETRY&amp; = 4              'Retry button pressed
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDIGNORE&amp; = 5             'Ignore button pressed
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDYES&amp; = 6                'Yes button pressed
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDNO&amp; = 7                 'No button pressed
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDTRYAGAIN&amp; = 10          'Try again button pressed
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDCONTINUE&amp; = 1           'Continue button pressed
'----------------------------------------------------------------------------------------

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>
<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> MessageBox&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> Zer0 <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, Message <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, Title <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> MBType <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

DO
  msg&amp; = 0: icon&amp; = 0: DB&amp; = 0
  <a href="/qb64wiki/index.php/INPUT" title="INPUT"><span style="color:#4593D8;">INPUT</span></a> "Enter Message Box type(0 to 6 other Quits): ", BOX&amp;
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> BOX&amp; &lt; 0 <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> BOX&amp; &gt; 6 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/EXIT_DO" title="EXIT DO"><span style="color:#4593D8;">EXIT DO</span></a>

  <a href="/qb64wiki/index.php/INPUT" title="INPUT"><span style="color:#4593D8;">INPUT</span></a> "Enter Icon&amp;(0=none, 1=stop, 2=?, 3=!, 4=info): ", Icon&amp;

  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> BOX&amp; <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a class="mw-redirect" href="/qb64wiki/index.php/INPUT_(file_mode)" title="INPUT (file mode)"><span style="color:#4593D8;">INPUT</span></a> "Enter Default Button(1st, 2nd or 3rd): ", DB&amp;
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> DB&amp; <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> DB&amp; = DB&amp; - 1     'adjust value to 0, 1, or 2
  msg&amp; = MsgBox&amp;("Box Title", "Box text message", BOX&amp;, Icon&amp;, DB&amp;, 4096) 'on top of all windows

  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Button ="; msg&amp;
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> MsgBox&amp; (Title$, Message$, BoxType&amp;, Icon&amp;, DBtn&amp;, Mode&amp;)
<a href="/qb64wiki/index.php/SELECT_CASE" title="SELECT CASE"><span style="color:#4593D8;">SELECT CASE</span></a> Icon&amp;
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 1: Icon&amp; = MB_ICONSTOP&amp;          'warning X-sign icon
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 2: Icon&amp; = MB_ICONQUESTION&amp;      'question-mark icon
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 3: Icon&amp; = MB_ICONEXCLAMATION&amp;   'exclamation-point icon
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 4: Icon&amp; = MB_ICONINFORMATION&amp;   'lowercase letter i in circle
  <a class="mw-redirect" href="/qb64wiki/index.php/CASE_ELSE" title="CASE ELSE"><span style="color:#4593D8;">CASE ELSE</span></a>: Icon&amp; = 0 'no icon
<a href="/qb64wiki/index.php/END_SELECT" title="END SELECT"><span style="color:#4593D8;">END SELECT</span></a>
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> BoxType&amp; &gt; 0 <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> DBtn&amp; &gt; 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> 'set default button as 2nd(256) or 3rd(512)
  <a href="/qb64wiki/index.php/SELECT_CASE" title="SELECT CASE"><span style="color:#4593D8;">SELECT CASE</span></a> BoxType&amp;
    <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 2, 3, 6
     <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> DBtn&amp; = 2 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> Icon&amp; = Icon&amp; + MB_DEFBUTTON3&amp; <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a> Icon&amp; = Icon&amp; + MB_DEFBUTTON2&amp; '3 button
    <a class="mw-redirect" href="/qb64wiki/index.php/CASE_ELSE" title="CASE ELSE"><span style="color:#4593D8;">CASE ELSE</span></a>: Icon&amp; = Icon&amp; + MB_DEFBUTTON2&amp; '2nd button default
  <a href="/qb64wiki/index.php/END_SELECT" title="END SELECT"><span style="color:#4593D8;">END SELECT</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
Focus&amp; = MB_SetFocus&amp;
MsgBox&amp; = MessageBox&amp;(0, Message$, Title$, BoxType&amp; + Icon&amp; + Mode&amp; + Focus&amp;) 'focus on button
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <dl>
       <dd>
        <b>
         Note:
        </b>
        The demo above can show all of the possible message box options. The actual code necessary is quite simple.
       </dd>
      </dl>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Mouse_Area">
        Mouse Area
       </span>
      </h2>
      <dl>
       <dd>
        Program limits the mouse to a box portion of the Windows desktop using the Rectangle
        <a href="/qb64wiki/index.php/TYPE" title="TYPE">
         TYPE
        </a>
        to define the mouse area.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> Rectangle
  left <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  top <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  right <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
  bottom <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> Rec <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> Rectangle


<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "User32"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> ClipCursor%% (Rect <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> Rectangle) 'sets mouse box work area on desktop
  <a href="/qb64wiki/index.php/SUB" title="SUB"><span style="color:#4593D8;">SUB</span></a> SetCursorPos (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> x <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> y <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>) 'move cursor position
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/SCREEN" title="SCREEN"><span style="color:#4593D8;">SCREEN</span></a> <a href="/qb64wiki/index.php/NEWIMAGE" title="NEWIMAGE"><span style="color:#4593D8;">_NEWIMAGE</span></a>(320, 200, 32)
SetCursorPos 40, 36  'move cursor to left side of desktop

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Press a key and the mouse is boxed in!"
K$ = <a href="/qb64wiki/index.php/INPUT$" title="INPUT$"><span style="color:#4593D8;">INPUT$</span></a>(1)

Rec.left = 600
Rec.top = 400
Rec.bottom = 700
Rec.right = 800
work%% = ClipCursor(Rec)

<a href="/qb64wiki/index.php/CLS" title="CLS"><span style="color:#4593D8;">CLS</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> work%%
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Click the mouse and window to quit!"
DO
  m = <a href="/qb64wiki/index.php/MOUSEINPUT" title="MOUSEINPUT"><span style="color:#4593D8;">_MOUSEINPUT</span></a>

<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> <a href="/qb64wiki/index.php/MOUSEBUTTON" title="MOUSEBUTTON"><span style="color:#4593D8;">_MOUSEBUTTON</span></a>(2) <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> <a href="/qb64wiki/index.php/MOUSEBUTTON" title="MOUSEBUTTON"><span style="color:#4593D8;">_MOUSEBUTTON</span></a>(1)
SetCursorPos 40, 36 'attempts to move mouse to left

<a href="/qb64wiki/index.php/SYSTEM" title="SYSTEM"><span style="color:#4593D8;">SYSTEM</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        The left and top positions must be less than the bottom and right pixel position values. Click mouse to exit box area. Click program window to quit.
       </dd>
      </dl>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Open_another_Program">
        Open another Program
       </span>
      </h2>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'Uses Kernel32 WinAPI to execute a program in a QB64 program.  Coded by Dav

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>
  Function WinExec (lpCmdLine AS <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nCmdShow AS <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

Winmode% = 1

'0 = Hides the window and activates another window.
'1 = Activates and displays a normal sized window.
'2 = Activates the window and minimized to taskbar.
'3 = Activates the window and displays it as a maximized window.

'NOTE: If you do 0 (hide), you'll have to Kill the process using your TaskManager!!!

'=== Open notepad and load samples.txt in the QB64 directory

Filename$ = "notepad.exe samples.txt" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)

'NOTE: EXE filename must be a NULL terminates..<a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)...

Result = WinExec(Filename$, Winmode%)

'=== Show results ...

<a href="/qb64wiki/index.php/SELECT_CASE" title="SELECT CASE"><span style="color:#4593D8;">SELECT CASE</span></a> Result
   <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 0: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "System out of memory or resources."
   <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 2: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "The specified file was not found."
   <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 3: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "The specified path was not found."
   <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE</span></a> 11: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "The file is invalid (non-Win32 .EXE or error in .EXE image)."
   <a class="mw-redirect" href="/qb64wiki/index.php/CASE" title="CASE"><span style="color:#4593D8;">CASE IS</span></a> &gt; 31: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Program opened normally."
   <a class="mw-redirect" href="/qb64wiki/index.php/CASE_ELSE" title="CASE ELSE"><span style="color:#4593D8;">CASE ELSE</span></a>: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Unknown error: "; Result
<a href="/qb64wiki/index.php/END_SELECT" title="END SELECT"><span style="color:#4593D8;">END SELECT</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code by Dav
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        The Library file can only run valid Windows executable programs. Not DOS console EXE programs!
       </dd>
      </dl>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Play_WAV_Sounds">
        Play WAV Sounds
       </span>
      </h2>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SND_SYNC = 0 'Windows controlled
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SND_ASYNC = 1 'user controlled
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SND_NODEFAULT = 2 'only plays sound file requested
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SND_LOOP = 8 'loops the sound. Use ASYNC also to stop later
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SND_NOSTOP = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>10 'does not allow a sound to be stopped
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SND_NOWAIT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2000 'will not play sound if driver is busy
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SND_PURGE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>40 'stop any sound playing

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "winmm"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> PlaySound% <a href="/qb64wiki/index.php/ALIAS" title="ALIAS"><span style="color:#4593D8;">ALIAS</span></a> PlaySoundA (lpszName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hModule <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwFlags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/LINE_INPUT" title="LINE INPUT"><span style="color:#4593D8;">LINE INPUT</span></a> "Enter WAV sound file name: ", FileName$
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Play asynchronously?(Y/N) ";
K$ = <a href="/qb64wiki/index.php/UCASE$" title="UCASE$"><span style="color:#4593D8;">UCASE$</span></a>(<a href="/qb64wiki/index.php/INPUT$" title="INPUT$"><span style="color:#4593D8;">INPUT$</span></a>(1))
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> K$
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> K$ = "Y" <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> Synch = SND_ASYNC <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a> Synch = SND_SYNC

retval% = PlaySound(FileName$, 0, Synch)
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code by Ted Weissgerber
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        ASYNC allows the program to stop the sound by sending a null file name. Flag constants can be added so loop and ASYNC would total 9.
       </dd>
      </dl>
      <p>
       <br/>
      </p>
      <center>
       <b>
        <a class="external text" href="http://msdn.microsoft.com/en-us/library/ms712636" rel="nofollow">
         WINMM.DLL Functions
        </a>
       </b>
      </center>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Run_One_Instance">
        Run One Instance
       </span>
      </h2>
      <p>
       Program catches another instance of the program descriptor label running and closes it
      </p>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> ERROR_ALREADY_EXISTS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>B7

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> CreateMutexA%&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpMutexAttributes%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> bInitialOwner&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpName%&amp;)
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetLastError~&amp; ()
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> t <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>

t = "Global\Some name unique to your program" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
' see: <a class="external free" href="http://msdn.microsoft.com/en-us/library/ms682411%28v=vs.85%29" rel="nofollow">http://msdn.microsoft.com/en-us/library/ms682411%28v=vs.85%29</a>

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> 0 = CreateMutexA(0, 0, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(t)) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
 <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "CreateMutexA failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError))
 <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> ERROR_ALREADY_EXISTS = GetLastError <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
 <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Sorry. There can be only one."
 <a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a> 2
 <a href="/qb64wiki/index.php/SYSTEM" title="SYSTEM"><span style="color:#4593D8;">SYSTEM</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "But the most wonderful thing about tiggers is I'm the only one."
<a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a> = <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1B)
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a>
<a href="/qb64wiki/index.php/SYSTEM" title="SYSTEM"><span style="color:#4593D8;">SYSTEM</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Michael Calkins
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Explanation:
        </i>
        The same identification string is used in both instances of the running program. Compile example, run the EXE and try to compile and run another instance. 'Sorry. There can be only one.' will be printed to the screen and then it will close.
       </dd>
      </dl>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Send_Keys">
        Send Keys
       </span>
      </h2>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'============
'SENDKEYS.BAS
'============
'A kind of SENDKEYS clone for QB64. Sends keystrokes to active application.
'Coded for QB64 by Dav, JAN/2013


<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
    <a href="/qb64wiki/index.php/SUB" title="SUB"><span style="color:#4593D8;">SUB</span></a> SENDKEYS <a href="/qb64wiki/index.php/ALIAS" title="ALIAS"><span style="color:#4593D8;">ALIAS</span></a> keybd_event (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> bVk <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> bScan <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwFlags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwExtraInfo <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> KEYEVENTF_KEYUP = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> VK_SNAPSHOT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2C 'PrtScn key
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> VK_MENU = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>12 'Alt key
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> VK_SHIFT = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>10 'Shift key
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> VK_LWIN = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>5B

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> ""
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "SENDKEYS clone example.  Press ENTER to begin..."
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>

<a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a> &lt;&gt; <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(13): <a class="mw-redirect" href="/qb64wiki/index.php/WEND" title="WEND"><span style="color:#4593D8;">WEND</span></a>

'=== Capture Active window to Clipoard as image (Like Alt+PrtSc)
SENDKEYS VK_MENU, 0, 0, 0
SENDKEYS VK_SNAPSHOT, 0, 0, 0
SENDKEYS VK_SNAPSHOT, 0, KEYEVENTF_KEYUP, 0
SENDKEYS VK_MENU, 0, KEYEVENTF_KEYUP, 0

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "SENDKEYS just sent a Alt+PrtSc keyboard press."
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "A screen-cap of this EXE <a href="/qb64wiki/index.php/WINDOW" title="WINDOW"><span style="color:#4593D8;">WINDOW</span></a> was just sent to your clipboard."
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Go ahead, check it now, then come back here and press ENTER..."

<a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a> &lt;&gt; <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(13): <a class="mw-redirect" href="/qb64wiki/index.php/WEND" title="WEND"><span style="color:#4593D8;">WEND</span></a>

'=== Capture Desktop screen to Clipoard as image (Like Shift+PrtSc)
SENDKEYS VK_SHIFT, 0, 0, 0
SENDKEYS VK_SNAPSHOT, 0, 0, 0
SENDKEYS VK_SNAPSHOT, 0, KEYEVENTF_KEYUP, 0
SENDKEYS VK_SHIFT, 0, KEYEVENTF_KEYUP, 0

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Now SENDKEYS just sent a Shift+PrtSc keyboard press."
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "A screen-cap of your DESKTOP was just sent to your clipboard."
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Go ahead, check it now, then come back here and press ENTER..."
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>

<a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a> &lt;&gt; <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(13): <a class="mw-redirect" href="/qb64wiki/index.php/WEND" title="WEND"><span style="color:#4593D8;">WEND</span></a>

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Now 'Notepad.exe' will open and SENDKEYS will send text to it."
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Press ENTER to do that now, then close notepad, come back here,"
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "and press ENTER to continue..."

<a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a> &lt;&gt; <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(13): <a class="mw-redirect" href="/qb64wiki/index.php/WEND" title="WEND"><span style="color:#4593D8;">WEND</span></a>

<a href="/qb64wiki/index.php/SHELL" title="SHELL"><span style="color:#4593D8;">SHELL</span></a> <a href="/qb64wiki/index.php/DONTWAIT" title="DONTWAIT"><span style="color:#4593D8;">_DONTWAIT</span></a> "notepad.exe"

<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a> 1 'give time to make notepad the active window...

'=== Say Hi...
SENDKEYS <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>48, 0, 0, 0: SENDKEYS <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>48, 0, KEYEVENTF_KEYUP, 0 'H
SENDKEYS <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>49, 0, 0, 0: SENDKEYS <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>49, 0, KEYEVENTF_KEYUP, 0 'i

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Now press ENTER for SENDKEYS to Minimize all your windows..."
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>

<a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a> &lt;&gt; <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(13): <a class="mw-redirect" href="/qb64wiki/index.php/WEND" title="WEND"><span style="color:#4593D8;">WEND</span></a>

'=== Minimize windows shortcut
SENDKEYS VK_LWIN, 0, 0, 0
SENDKEYS <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>4D, 0, 0, 0
SENDKEYS VK_LWIN, 0, KEYEVENTF_KEYUP, 0

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "That's all. have a nice day."

<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Dav
       </span>
      </center>
      <table cellpadding="5px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="outputfixed">'                                  <b>Virtual KeyState Codes</b>
'
' <b> Esc  F1  F2  F3  F4  F5  F6  F7  F8  F9  F10  F11 F12   Sys ScL Pause</b>
'  27   112 113 114 115 116 117 118 119 120 121  122 123   44  145 19
' <b> `~  1!  2@  3#  4$  5%  6^  7&amp;  8* 9(  0) -_  =+  BkS   Ins Hme PUp   NumL  /   *    -</b>
'  192 49  50  51  52  53  54  55  56  57 48 189 187  8    45  36  33    144  111  106 109
' <b> Tab Q   W   E   R   T   Y   U   I   O   P  [{  ]}  \|   Del End PDn   7Hme 8/▲  9PU  +</b>
'   9  81  87  69  82  84  89  85  73  79  80 219 221 120  46  35  34    103  104  105 107
' <b> CapL  A   S   D   F   G   H   J   K   L   ;:  '" Enter                4/◄-  5   6/-► E</b>
'   20   65  83  68  70  71  72  74  75  76 186 222  13                  100  101  102  <b>n</b>
' <b> Shift  Z   X   C   V   B   N   M   ,&lt;  .&gt;  /?    Shift       ▲        1End 2/▼  3PD  t</b>
'  16/160 90  88  67  86  66  78  77 188  190 191   16/161      38       97   98   99   <b>e</b>
' <b> Ctrl   Win   Alt       Spacebar      Alt Win Menu Ctrl   ◄-  ▼   -►   0Ins     .Del  r</b>
'  17/162 91  18/164        32        18/165 92  93 17/163  37  40  39   96        110  13
'
'      Num Lock On values shown. Off values same as functions and arrows, 5 = code 12.
'
'  <b>Mouse click returns: LB = 1, RB = 2, MB = 4, etc. <a class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx" rel="nofollow">Special keys</a> may also work.</b>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        NOTE: The above commented table can be copied and pasted directly into the QB64 IDE
       </span>
      </center>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="System_Metrics">
        System Metrics
       </span>
      </h2>
      <dl>
       <dd>
        Returns the dimensions of the current user's desktop. Can be used to get various Windows settings.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXSCREEN = 0 'Width of user desktop
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYSCREEN = 1 'Height of user desktop
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXFULLSCREEN = 16 ' Width of window client area
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYFULLSCREEN = 17 ' Height of window client area
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYMENU = 15 ' Height of menu
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYCAPTION = 4 ' Height of caption or title
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXFRAME = 32 ' Width of window frame
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYFRAME = 33 ' Height of window frame
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXHSCROLL = 21 ' Width of arrow bitmap on horizontal scroll bar
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYHSCROLL = 3 ' Height of arrow bitmap on horizontal scroll bar
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXVSCROLL = 2 ' Width of arrow bitmap on vertical scroll bar
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYVSCROLL = 20 ' Height of arrow bitmap on vertical scroll bar
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXSIZE = 30 ' Width of bitmaps in title bar
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYSIZE = 31 ' Height of bitmaps in title bar
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXCURSOR = 13 ' Width of cursor
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYCURSOR = 14 ' Height of cursor
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXBORDER = 5 ' Width of window frame that cannot be sized
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYBORDER = 6 ' Height of window frame that cannot be sized
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXDOUBLECLICK = 36 ' Width of rectangle around the location of the first click.
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYDOUBLECLICK = 37 ' Height of rectangle around the location of the first click.
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXDLGFRAME = 7 ' Width of dialog frame window
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYDLGFRAME = 8 ' Height of dialog frame window
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXICON = 11 ' Width of icon
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYICON = 12 ' Height of icon
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXICONSPACING = 38 ' Width of rectangles the system uses to position tiled icons
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYICONSPACING = 39 ' Height of rectangles the system uses to position tiled icons
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXMIN = 28 ' Minimum width of window
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYMIN = 29 ' Minimum height of window
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXMINTRACK = 34 ' Minimum tracking width of window
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYMINTRACK = 35 ' Minimum tracking height of window
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CXHTHUMB = 10 ' Width of scroll box (thumb) on horizontal scroll bar
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_CYVTHUMB = 9 ' Width of scroll box (thumb) on vertical scroll bar
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_DBCSENABLED = 42 ' Returns a non-zero if the current Windows version uses double-byte characters, otherwise zero
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_DEBUG = 22 ' Returns non-zero if the Windows version is a debugging version
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_MENUDROPALIGNMENT = 40 'Alignment of pop-up menus.
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_MOUSEPRESENT = 19 ' Non-zero if mouse hardware is installed
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_PENWINDOWS = 41 ' Handle of Pen Windows dynamic link library if Pen Windows is installed
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SM_SWAPBUTTON = 23 ' Non-zero if the left and right mouse buttons are swapped

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetSystemMetrics&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> n <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> trimstr$(GetSystemMetrics(SM_CXSCREEN)); "x"; trimstr$(GetSystemMetrics(SM_CYSCREEN))

s&amp; = <a href="/qb64wiki/index.php/SCREENIMAGE" title="SCREENIMAGE"><span style="color:#4593D8;">_SCREENIMAGE</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/WIDTH_(function)" title="WIDTH (function)"><span style="color:#4593D8;">_WIDTH</span></a>(s&amp;); "X"; <a href="/qb64wiki/index.php/HEIGHT" title="HEIGHT"><span style="color:#4593D8;">_HEIGHT</span></a>(s&amp;)

<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> 3

<a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> trimstr$ (whatever)
trimstr = <a href="/qb64wiki/index.php/LTRIM$" title="LTRIM$"><span style="color:#4593D8;">LTRIM$</span></a>(<a href="/qb64wiki/index.php/RTRIM$" title="RTRIM$"><span style="color:#4593D8;">RTRIM$</span></a>(<a href="/qb64wiki/index.php/STR$" title="STR$"><span style="color:#4593D8;">STR$</span></a>(whatever)))
<a class="mw-redirect" href="/qb64wiki/index.php/END_FUNCTION" title="END FUNCTION"><span style="color:#4593D8;">END FUNCTION</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Top_Most_Window">
        Top Most Window
       </span>
      </h2>
      <dl>
       <dd>
        This Windows only procedure will make the program window always stay on top of other windows, but not always in focus. (See
        <a href="/qb64wiki/index.php/Windows_Libraries#Focus" title="Windows Libraries">
         Windows Focus
        </a>
        )
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'public domain

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_NOSIZE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0001      'ignores cx and cy size parameters
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_NOMOVE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0002      'ignores x and y position parameters
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_NOZORDER = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0004    'keeps z order and ignores hWndInsertAfter parameter
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_NOREDRAW = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0008    'does not redraw window changes
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_NOACTIVATE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0010  'does not activate window
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_FRAMECHANGED = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0020
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_SHOWWINDOW = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0040
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_HIDEWINDOW = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0080
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_NOCOPYBITS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0100
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_NOOWNERZORDER = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0200
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_NOSENDCHANGING = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0400
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_DRAWFRAME = SWP_FRAMECHANGED
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_NOREPOSITION = SWP_NOOWNERZORDER
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_DEFERERASE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2000
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_ASYNCWINDOWPOS = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>4000
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HWND_TOP = 0        'window at top of z order no focus
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HWND_BOTTOM = 1     'window at bottom of z order no focus
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HWND_TOPMOST = -1   'window above all others no focus unless active
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HWND_NOTOPMOST = -2 'window below active no focus

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindowA%&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpClassName%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpWindowName%&amp;)
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetWindowPos&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hWnd%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hWndInsertAfter%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> X&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> Y&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> cx&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> cy&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> uFlags~&amp;)
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetForegroundWindow%&amp;
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetLastError~&amp; ()
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> t <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> hWnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>

<a href="/qb64wiki/index.php/RANDOMIZE" title="RANDOMIZE"><span style="color:#4593D8;">RANDOMIZE</span></a> <a href="/qb64wiki/index.php/TIMER_(function)" title="TIMER (function)"><span style="color:#4593D8;">TIMER</span></a>
t = <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(<a href="/qb64wiki/index.php/RND" title="RND"><span style="color:#4593D8;">RND</span></a> * <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1000000) 'random title for FindWindowA
<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> t
t = t + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
hWnd = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindowA(0, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(t))
<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> "This Window will always be on Top" 'any title

<a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 4 'delay allows user to click focus on other windows

'set as topmost window and move without sizing or activation
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> 0 = SetWindowPos(hWnd, HWND_TOPMOST, 200, 200, 0, 0, SWP_NOSIZE <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> SWP_NOACTIVATE) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
 <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "SetWindowPos failed. 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError))
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

x%&amp; = GetForegroundWindow%&amp; 'find currently focused process handle

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Program handle:"; hWnd; "Focus handle:"; x%&amp;
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> hWnd &lt;&gt; x%&amp; <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/SCREENCLICK" title="SCREENCLICK"><span style="color:#4593D8;">_SCREENCLICK</span></a> 240, 240 'add 40 to x and y to focus on positioned window

<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Adapted from code by Michael Calkins
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Explanation:
        </i>
        When other windows are clicked on, this program window will stay on top. Click it to return focus.
        <dl>
         <dd>
          <i>
           SetWindowPos
          </i>
          can also move the window's TLC corner position and re-size the window when not flagged.
         </dd>
         <dd>
          When the window is moved to a position,
          <a href="/qb64wiki/index.php/SCREENCLICK" title="SCREENCLICK">
           _SCREENCLICK
          </a>
          can be used to focus on the program window.
         </dd>
        </dl>
       </dd>
      </dl>
      <center>
       <b>
        <i>
         <a href="/qb64wiki/index.php/Windows_Libraries#Focus" title="Windows Libraries">
          SetForegroundWindow
         </a>
        </i>
        will not work with the
        <i>
         SetWindowPos
        </i>
        !
       </b>
      </center>
      <p>
       <br/>
      </p>
      <center>
       <a class="external text" href="http://msdn.microsoft.com/en-us/library/ms633545%28v=vs.85%29" rel="nofollow">
        http://msdn.microsoft.com/en-us/library/ms633545%28v=vs.85%29
       </a>
      </center>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Video_File_Player">
        Video File Player
       </span>
      </h2>
      <p>
       Video player for MPG or AVI video files:
      </p>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "WINMM"
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> mciSendStringA% (lpstrCommand <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, lpstrReturnString <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> uReturnLength <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwndCallback <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>)
    ' mciSendStringA function plays media files and returns the following:
    ' 0 = command sucessful
    ' - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    ' lpstrCommand is the MCI command string (and optional flags) to send.
    ' lpstrReturnString is a string that holds any return information.
    ' uReturnLength is the length of the lpstrReturnString string passed.
    ' <a href="/qb64wiki/index.php/NOT" title="NOT"><span style="color:#4593D8;">NOT</span></a>E: If lpstrCommand given doesn't retun a value then lpstrReturnString
    '       can be empty and uReturnLength can be set to 0.
    ' hwndCallback contains a callback window handle (only if the Notify flag used in lpstrCommand)
    '====================================================================
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> mciGetErrorStringA% (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwError <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>, lpstrBuffer <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> uLength <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>)
    ' mciGetErrorStringA returns error info if the mciSendStringA failed.
    ' dwError is the return value from the mciSendString function.
    ' lpstrBuffer string holds the error information returned by the function.
    ' uLength is the length of the lpstrBuffer string buffer.
    '====================================================================
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE CUSTOMTYPE LIBRARY</span></a>
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ClassName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, WindowName$)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>


handle&amp; = <a href="/qb64wiki/index.php/NEWIMAGE" title="NEWIMAGE"><span style="color:#4593D8;">_NEWIMAGE</span></a>(800, 600, 256)
<a href="/qb64wiki/index.php/SCREEN" title="SCREEN"><span style="color:#4593D8;">SCREEN</span></a> handle&amp;


<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> "QB64 Video"
hwnd&amp; = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindow(0, "QB64 Video" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0))

ReturnString$ = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(255)
ErrorString$ = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(255)
filename$ = "c:\DavPiano.mpg" '&lt;========== video file to play

a% = mciSendStringA%("open " + filename$ + " style popup", ReturnString$, <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(ReturnString$), 0)

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> a% <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    x% = mciGetErrorStringA%(a%, ErrorString$, <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(ErrorString$))
    <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> ErrorString$
    <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
<a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
    a2% = mciSendStringA%("window " + filename$ + " handle " + <a href="/qb64wiki/index.php/STR$" title="STR$"><span style="color:#4593D8;">STR$</span></a>(hwnd&amp;), ReturnString$, <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(ReturnString$), 0)
    b% = mciSendStringA%("play " + filename$, "", 0, 0)
    <a href="/qb64wiki/index.php/SCREENMOVE" title="SCREENMOVE"><span style="color:#4593D8;">_SCREENMOVE</span></a> <a href="/qb64wiki/index.php/SCREENMOVE" title="SCREENMOVE"><span style="color:#4593D8;">_MIDDLE</span></a>
    '=== Play video...
    <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>: <a href="/qb64wiki/index.php/LIMIT" title="LIMIT"><span style="color:#4593D8;">_LIMIT</span></a> 30: <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a> &lt;&gt; ""

    x% = mciSendStringA%("stop " + filename$, "", 0, 0)
    x% = mciSendStringA%("close " + filename$, "", 0, 0)
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Dav
       </span>
      </center>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Web_Page_Download">
        Web Page Download
       </span>
      </h2>
      <dl>
       <dd>
        Downloads the contents of a web page as an HTML or text file. Text can be edited for page information.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "urlmon"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> URLDownloadToFileA% (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> pCaller <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, szURL <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, szFileName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwReserved <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpfnCB <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

'=== URL to grab (page or a file)
URL$ = "http://www.qbasicnews.com/dav/"
'=== File to save URL as
URLfile$ = "DavsIndex.html"

'=== Download it.  Returns 0 if succeeded
a% = URLDownloadToFileA%(0, URL$, URLfile$, 0, 0)

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Grabbing : "; URL$: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Saving as: "; URLfile$
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Sleeping 7 secs to do the deed..."
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a> 7
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> a%
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Dav
       </span>
      </center>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Windows_API">
        Windows API
       </span>
      </h2>
      <dl>
       <dd>
        Program finds the window handle by the
        <a href="/qb64wiki/index.php/TITLE" title="TITLE">
         title
        </a>
        and then does various things with the window using that handle
        <a href="/qb64wiki/index.php/OFFSET" title="OFFSET">
         _OFFSET
        </a>
        value.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HWND_BOTTOM = 1     'places the window at the bottom of the Z order
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HWND_TOP = 0        'places the window at the top of the Z order
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HWND_TOPMOST = -1   'places the window above all non-topmost windows
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HWND_NOTOPMOST = -2 'places the window behind all topmost windows

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindowA%&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> class <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, Title$)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> CloseWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> OpenIcon&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetWindowTextA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, NewTitle$)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetWindowThreadProcessId&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> null <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetWindowPos&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> Zorder&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> X&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> Y&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> cx&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> cy&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> flag&amp;)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> "Windows Test"

'// Get the window handle (as a long)
hwnd%&amp; = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindowA(0, "Windows Test" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0))
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Handle:"; hwnd%&amp;
<a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 3

'// Minimize the window - places program on the task bar
ret&amp; = CloseWindow(hwnd%&amp;)
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Minimize"; ret&amp;
<a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 3 '// wait a few seconds

'// Restore the window
ret&amp; = OpenIcon(hwnd%&amp;)
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Restore"; ret&amp;
<a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 3

'// Sets window priority as TOPMOST and moves the window position column 200, row 0
ret&amp; = SetWindowPos(hwnd%&amp;, HWND_TOPMOST, 200, 0, 0, 0, 0)
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Position"; ret&amp;
<a href="/qb64wiki/index.php/DELAY" title="DELAY"><span style="color:#4593D8;">_DELAY</span></a> 3

'// Change the title of window header to new name
ret&amp; = SetWindowTextA(hwnd%&amp;, "Windows API Test")
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Title"; ret&amp;

'// Get and display the process id for the window using new title name
PID&amp; = GetWindowThreadProcessId(hwnd%&amp;, 0)
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Process ID:"; PID&amp;

<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Adapted from header code by Cyperium and Unseenmachine
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        <i>
         SetWindowPos&amp;
        </i>
        function sets the pixel location on the desktop and the window dimensions. It can also set the window's Z order priority.
       </dd>
      </dl>
      <center>
       <b>
        The window handle value and process ID never change! Even when the title is changed.
       </b>
      </center>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Window_Focus">
        Window Focus
       </span>
      </h2>
      <p>
       Windows API routine can tell a program when it has lost focus by the user clicking on a different program window or the desktop.
      </p>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetForegroundWindow%&amp; ()
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindowA%&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpClassName%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpWindowName%&amp;)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> title <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> hWnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>

title = "Whatever you actually want the title to be"
<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> title
title = title + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0) 'always add character zero to FindWindowA string parameter
hWnd = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindowA(0, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(title))

<a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(<a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a>)
    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> hWnd = GetForegroundWindow <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "foreground" <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "not foreground"
    <a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a> 1
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Adapted from code by Michael Calkins
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        <a href="/qb64wiki/index.php/CHR$" title="CHR$">
         CHR$
        </a>
        (0) could actually be added to the original title string and it wouldn't hurt anything. Compared values are
        <a href="/qb64wiki/index.php/OFFSET" title="OFFSET">
         _OFFSETs
        </a>
        .
       </dd>
      </dl>
      <center>
       <b>
        See
        <a href="/qb64wiki/index.php/Windows_Libraries#Focus" title="Windows Libraries">
         SetForegroundWindow to set Focus
        </a>
        on program.
       </b>
      </center>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Windows_Menu">
        Windows Menu
       </span>
      </h2>
      <center>
       <b>
        Creates a menu bar in the program window with a name that can be clicked on to execute a procedure.
       </b>
      </center>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/DEFLNG" title="DEFLNG"><span style="color:#4593D8;">DEFLNG</span></a> A-Z

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MIIM_STATE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MIIM_ID = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MIIM_TYPE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>10
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MFT_SEPARATOR = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>800
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MFT_STRING = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MFS_ENABLED = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>0
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MFS_CHECKED = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>8

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HWND_TOPMOST = -1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> HWND_NOTOPMOST = -2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_NOMOVE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SWP_NOSIZE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1
'-----------------------------------------------------------------------------------

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> MENUITEMINFO
    cbSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    fMask <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    fType <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    fState <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    wID <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    hSubMenu <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    hbmpChecked <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    hbmpUnchecked <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
    dwItemData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
    dwTypeData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
    cch <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ClassName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, WindowName$) ' To get hWnd handle
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> CreateMenu&amp; ()
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> DrawMenuBar (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hWnd&amp;)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetMenu&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hWnd&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hMenu&amp;)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> InsertMenuItemA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hMenu&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> uItem&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> fByPosition&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpmii <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetMenuItemCount&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hMenu&amp;)
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetMenuItemInfoA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hMenu&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> uItem&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> fByPosition&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpmii <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> hWnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> hMenu <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> MenuItem <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> MENUITEMINFO, BlankMenuItem <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> MENUITEMINFO
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> TypeData <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a> * 1000

<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> "Menu bar API demo"
hWnd = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindow(0, "Menu bar API demo" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0))

hMenu = CreateMenu: BlankMenuItem.cbSize = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(BlankMenuItem)

<a href="/qb64wiki/index.php/COLOR" title="COLOR"><span style="color:#4593D8;">COLOR</span></a> 7, 1: <a href="/qb64wiki/index.php/CLS" title="CLS"><span style="color:#4593D8;">CLS</span></a>

'Add a separator bar
count = GetMenuItemCount(hMenu): <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "MenuItemCount:"; count
MenuItem = BlankMenuItem
MenuItem.fMask = MIIM_ID <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> MIIM_<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>
MenuItem.fType = MFT_SEPARATOR
MenuItem.wID = count
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> InsertMenuItemA(hMenu, count, 1, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(MenuItem)) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Successfully added menu item!" <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Failed to add menu item!": <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>

'Add a button
MenuItem = BlankMenuItem
count = GetMenuItemCount(hMenu): <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "MenuItemCount:"; count
MenuItem.fMask = MIIM_STATE <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> MIIM_ID <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> MIIM_TYPE
MenuItem.fType = MFT_STRING
MenuItem.fState = MFS_ENABLED
MenuItem.wID = count
TypeData = "&amp;Fire Laser!" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
MenuItem.dwTypeData = <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(TypeData)
MenuItem.cch = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(MenuItem.dwTypeData)
MyButton = MenuItem.wID
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> InsertMenuItemA(hMenu, count, 1, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(MenuItem)) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Successfully added menu item!" <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Failed to add menu item!": <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> SetMenu(hWnd, hMenu) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Successfully set menu!": <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Menu handle is:"; hMenu <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Failed to set menu!": <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>

<a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a>: <a href="/qb64wiki/index.php/LIMIT" title="LIMIT"><span style="color:#4593D8;">_LIMIT</span></a> 70
    prev_state = new_state
    ok = GetMenuItemInfoA(hMenu, MyButton, 1, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(MenuItem))
    new_state = MenuItem.fState <a href="/qb64wiki/index.php/AND" title="AND"><span style="color:#4593D8;">AND</span></a> 128
    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> prev_state = 0 <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> new_state &lt;&gt; 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Ouch! ";
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a> = ""
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code by Galleon
       </span>
      </center>
      <dl>
       <dd>
        Links/References:
       </dd>
       <dd>
        <a class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms647980%28v=vs.85%29.aspx" rel="nofollow">
         http://msdn.microsoft.com/en-us/library/windows/desktop/ms647980%28v=vs.85%29.aspx
        </a>
       </dd>
      </dl>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Windows_Notification">
        Windows Notification
       </span>
      </h2>
      <p>
       The following code creates a pop-up notification balloon in the Windows task bar or from the Windows 10 side bar.
      </p>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">

'public domain, 2012 feb, michael calkins

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> NIM_ADD = 0
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> NIM_MODIFY = 1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> NIM_DELETE = 2

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> NIF_ICON = 2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> NIF_TIP = 4
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> NIF_INFO = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>10

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> NIIF_NONE = 0
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> NIIF_INFO = 1
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> NIIF_WARNING = 2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> NIIF_ERROR = 3
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> NIIF_USER = 4

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDI_APPLICATION = 32512
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDI_HAND = 32513
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDI_QUESTION = 32514
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDI_EXCLAMATION = 32515
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> IDI_ASTERISK = 32516

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetLastError~&amp; ()
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindowA%&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpClassName%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpWindowName%&amp;)
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> LoadIconA%&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hInstance%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpIconName%&amp;)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "shell32"
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> Shell_NotifyIconA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwMessage~&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpdata%&amp;)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a> <a href="/qb64wiki/index.php/NOT" title="NOT"><span style="color:#4593D8;">NOT</span></a>IFYICONDATA
 cbSize <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
 hWnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
 uID <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
 uFlags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
 uCallbackMessage <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
 hIcon <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
 szTip <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a> * 128
 dwState <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
 dwStateMask <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
 szInfo <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a> * 256
 uTimeout <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
 szInfoTitle <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a> * 64
 dwInfoFlags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a> <a href="/qb64wiki/index.php/TYPE" title="TYPE"><span style="color:#4593D8;">TYPE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> hWnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> hIcon <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> t <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> notifydata <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> NOTIFYICONDATA
notifydata.cbSize = <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(notifydata)

t = "qb64 notification test"
<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> t
t = t + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
hWnd = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindowA(0, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(t)) 'find window ID
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> hWnd = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
 <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "FindWindowA failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError))
 <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

hIcon = LoadIconA(0, IDI_ASTERISK)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> hIcon = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
 <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "LoadIconA failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError))
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
'first notification
notifydata.hWnd = hWnd
notifydata.uID = 0
notifydata.uFlags = NIF_ICON <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> NIF_TIP <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> NIF_INFO
notifydata.hIcon = hIcon
notifydata.szTip = "Connect charger!" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0) 'tool tip
notifydata.szInfo = "Recharge" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0) 'information
notifydata.uTimeout = 10000 'milliseconds
notifydata.szInfoTitle = "Low Battery" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0) 'balloon title FALSE LOW BATTERY warning
notifydata.dwInfoFlags = NIIF_INFO

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> 0 = Shell_NotifyIconA(NIM_ADD, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(notifydata)) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
 <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Shell_NotifyIconA failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError))
 <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Press any key to modify it."
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a>: <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a> <a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(<a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a>): <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a>

hIcon = LoadIconA(0, IDI_HAND)
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> hIcon = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
 <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "LoadIconA failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError))
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
'second notification
notifydata.uFlags = NIF_ICON <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> NIF_TIP <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> NIF_INFO
notifydata.hIcon = hIcon
notifydata.szTip = "hahaha" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
notifydata.szInfo = ":-)" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
notifydata.uTimeout = 10000 'milliseconds
notifydata.szInfoTitle = "Howdy." + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)
notifydata.dwInfoFlags = NIIF_WARNING

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> 0 = Shell_NotifyIconA(NIM_MODIFY, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(notifydata)) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
 <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Shell_NotifyIconA failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError))
 <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>


<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Press any key to delete the notification icon."
<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a>: <a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a> <a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(<a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a>): <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a>

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> 0 = Shell_NotifyIconA(NIM_DELETE, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(notifydata)) <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
 <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Shell_NotifyIconA failed. Error: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(GetLastError))
 <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Adapted from code by Michael Calkins
       </span>
      </center>
      <center>
       <b>
        NOTE: The program emulates a FALSE Low Battery warning!
       </b>
      </center>
      <p>
       <br/>
      </p>
      <dl>
       <dd>
        <i>
         MSDN References:
        </i>
       </dd>
      </dl>
      <center>
       <a class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499%28v=vs.85%29.aspx" rel="nofollow">
        http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499%28v=vs.85%29.aspx
       </a>
       <p>
        <a class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms648072%28v=vs.85%29.aspx" rel="nofollow">
         http://msdn.microsoft.com/en-us/library/windows/desktop/ms648072%28v=vs.85%29.aspx
        </a>
       </p>
       <p>
        <a class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb762159%28v=vs.85%29.aspx" rel="nofollow">
         http://msdn.microsoft.com/en-us/library/windows/desktop/bb762159%28v=vs.85%29.aspx
        </a>
       </p>
       <a class="external text" href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb773352%28v=vs.85%29.aspx" rel="nofollow">
        http://msdn.microsoft.com/en-us/library/windows/desktop/bb773352%28v=vs.85%29.aspx
       </a>
      </center>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Windows_Ports">
        Windows Ports
       </span>
      </h2>
      <dl>
       <dd>
        The following library uses QueryDosDeviceA to find the COM or LPT ports on a Windows computer only.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'this example uses QueryDosDeviceA to enumerate COM ports.
'public domain, sept 2011, michael calkins

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "kernel32"
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> QueryDosDeviceA~&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpDeviceName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> lpTargetPath <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ucchMax <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetLastError~&amp; ()
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> sizeofbuffer <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> buffer <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> i <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> x <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> n <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
sizeofbuffer = 1024
buffer = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(sizeofbuffer)

DO
 x = 0
 <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> QueryDosDeviceA~&amp;(0, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(buffer), sizeofbuffer) = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
  x = GetLastError~&amp;
  <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> x = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>7A <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
   sizeofbuffer = sizeofbuffer + 1024
   buffer = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(sizeofbuffer)
  <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
   <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Error: 0x"; <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(x)
   <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
  <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
 <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> x = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>7A

i = 1
n = 0
<a href="/qb64wiki/index.php/DO...LOOP" title="DO...LOOP"><span style="color:#4593D8;">DO</span></a> <a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> <a href="/qb64wiki/index.php/ASC_(function)" title="ASC (function)"><span style="color:#4593D8;">ASC</span></a>(<a href="/qb64wiki/index.php/MID$_(function)" title="MID$ (function)"><span style="color:#4593D8;">MID$</span></a>(buffer, i, 1))
 x = <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(i, buffer, <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0))
 <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/MID$_(function)" title="MID$ (function)"><span style="color:#4593D8;">MID$</span></a>(buffer, i, x - i)
 <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/MID$_(function)" title="MID$ (function)"><span style="color:#4593D8;">MID$</span></a>(buffer, i, 3) = "COM" <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> 'change to "LPT" for parallel ports
  <a href="/qb64wiki/index.php/REDIM" title="REDIM"><span style="color:#4593D8;">REDIM</span></a> <a href="/qb64wiki/index.php/PRESERVE" title="PRESERVE"><span style="color:#4593D8;">_PRESERVE</span></a> comports(0 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:#4593D8;">TO</span></a> (n * 2) + 1) <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
  comports(n * 2) = <a href="/qb64wiki/index.php/MID$_(function)" title="MID$ (function)"><span style="color:#4593D8;">MID$</span></a>(buffer, i, (x - i) + 1)
  n = n + 1
 <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
 i = x + 1
<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a>

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a>
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> n; "COM ports:"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> n <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
 <a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:#4593D8;">FOR</span></a> i = 0 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:#4593D8;">TO</span></a> n - 1
  DO
   x = 0
   <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> QueryDosDeviceA~&amp;(<a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(comports(i * 2)), <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(buffer), sizeofbuffer) = 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
    x = GetLastError~&amp;
    <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> x = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>7A <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
     sizeofbuffer = sizeofbuffer + 1024
     buffer = <a href="/qb64wiki/index.php/SPACE$" title="SPACE$"><span style="color:#4593D8;">SPACE$</span></a>(sizeofbuffer)
    <a href="/qb64wiki/index.php/ELSE" title="ELSE"><span style="color:#4593D8;">ELSE</span></a>
     <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Error: 0x"; <a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(x)
     <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
    <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
   <a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>
  <a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a class="mw-redirect" href="/qb64wiki/index.php/WHILE" title="WHILE"><span style="color:#4593D8;">WHILE</span></a> x = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>7A
  comports((i * 2) + 1) = <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(buffer, <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(buffer, <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)) - 1)
  comports(i * 2) = <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(comports(i * 2), <a href="/qb64wiki/index.php/LEN" title="LEN"><span style="color:#4593D8;">LEN</span></a>(comports(i * 2)) - 1)
  <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>22); comports(i * 2); <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>22); " is mapped to: "; <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>22); comports((i * 2) + 1); <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>22)
 <a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:#4593D8;">NEXT</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

buffer = ""

<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Michael Calkins
       </span>
      </center>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Windows_Sounds">
        Windows Sounds
       </span>
      </h2>
      <dl>
       <dd>
        MessageBeep plays Windows alert sound files located in the
        <i>
         C:\windows\media
        </i>
        folder. Some may not be set!
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_OK = 0 'beep
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_ICONERROR = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>10
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_ICONQUESTION = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>20
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_ICONWARNING = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>30
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MB_ICONASTERISK = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>40

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>
  <a href="/qb64wiki/index.php/SUB" title="SUB"><span style="color:#4593D8;">SUB</span></a> MessageBeep (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> alert <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "OK"
MessageBeep MB_OK

<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a> 2
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Error"
MessageBeep MB_ICONERROR

<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a> 2
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "?"
MessageBeep MB_ICONQUESTION

<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a> 2
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Warning"
MessageBeep MB_ICONWARNING

<a href="/qb64wiki/index.php/SLEEP" title="SLEEP"><span style="color:#4593D8;">SLEEP</span></a> 2
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Asterisk"
MessageBeep MB_ICONASTERISK
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code by Ted Weissgerber
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        The sounds can be set in
        <i>
         Control Panel: Sounds and Audio Devices/Sounds
        </i>
        settings tab if not already assigned.
       </dd>
      </dl>
      <p>
       <br/>
      </p>
      <dl>
       <dd>
        PlaySound plays Windows System sounds on most PC's:
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'SDL-SPECIFIC CHANGES! GL only needs DECLARE LIBRARY without DLL name

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "Winmm"
    <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> PlaySound (pszSound <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hmod <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> fdwSound <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/INTEGER" title="INTEGER"><span style="color:#4593D8;">INTEGER</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SND_<a href="/qb64wiki/index.php/ALIAS" title="ALIAS"><span style="color:#4593D8;">ALIAS</span></a> = 65536
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SND_ASYNC = 1

x = PlaySound("SystemExclamation" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0), 0, SND_<a href="/qb64wiki/index.php/ALIAS" title="ALIAS"><span style="color:#4593D8;">ALIAS</span></a> + SND_ASYNC)
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <dl>
       <dd>
        Use "SystemDefault", "SystemExclamation", "SystemExit", "SystemHand", "SystemQuestion", "SystemStart" or "SystemWelcome"
       </dd>
      </dl>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Window_Transparency">
        Window Transparency
       </span>
      </h2>
      <dl>
       <dd>
        Program changes transparency of the window. Plus key increases visibility while minus key can make it completely invisible.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/DEFINT" title="DEFINT"><span style="color:#4593D8;">DEFINT</span></a> A-Z

' Declare windows API functions
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "user32"
   <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetLayeredWindowAttributes&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> crKey <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> bAlpha <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/UNSIGNED" title="UNSIGNED"><span style="color:#4593D8;">_UNSIGNED</span></a> <a href="/qb64wiki/index.php/BYTE" title="BYTE"><span style="color:#4593D8;">_BYTE</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwFlags <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
   <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetWindowLong&amp; <a href="/qb64wiki/index.php/ALIAS" title="ALIAS"><span style="color:#4593D8;">ALIAS</span></a> "GetWindowLongA" (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nIndex <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
   <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SetWindowLong&amp; <a href="/qb64wiki/index.php/ALIAS" title="ALIAS"><span style="color:#4593D8;">ALIAS</span></a> "SetWindowLongA" (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nIndex <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwNewLong <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

' Needed for acquiring the hWnd of the window
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>
   <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> FindWindow&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> ClassName <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/OFFSET" title="OFFSET"><span style="color:#4593D8;">_OFFSET</span></a>, WindowName$) ' To get hWnd handle
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>


<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> MyHwnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>

' Get hWnd value
<a href="/qb64wiki/index.php/TITLE" title="TITLE"><span style="color:#4593D8;">_TITLE</span></a> "Translucent window test"
MyHwnd = <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE"><span style="color:#4593D8;">_WINDOWHANDLE</span></a> 'FindWindow(0, "Translucent window test" + <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0))


' Set screen and draw a simple fractal which looks cooler than a black translucent window
<a href="/qb64wiki/index.php/SCREEN" title="SCREEN"><span style="color:#4593D8;">SCREEN</span></a> <a href="/qb64wiki/index.php/NEWIMAGE" title="NEWIMAGE"><span style="color:#4593D8;">_NEWIMAGE</span></a>(640, 480, 32)

<a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:#4593D8;">FOR</span></a> Py = 0 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:#4593D8;">TO</span></a> 479
   <a href="/qb64wiki/index.php/FOR...NEXT" title="FOR...NEXT"><span style="color:#4593D8;">FOR</span></a> Px = 0 <a href="/qb64wiki/index.php/TO" title="TO"><span style="color:#4593D8;">TO</span></a> 639
      <a href="/qb64wiki/index.php/PSET" title="PSET"><span style="color:#4593D8;">PSET</span></a> (Px, Py), <a href="/qb64wiki/index.php/RGB32" title="RGB32"><span style="color:#4593D8;">_RGB32</span></a>((Px <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> Py) <a href="/qb64wiki/index.php/MOD" title="MOD"><span style="color:#4593D8;">MOD</span></a> 256, (Px + Py) <a href="/qb64wiki/index.php/MOD" title="MOD"><span style="color:#4593D8;">MOD</span></a> 256, Py <a href="/qb64wiki/index.php/MOD" title="MOD"><span style="color:#4593D8;">MOD</span></a> 256)
   <a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:#4593D8;">NEXT</span></a> Px
<a href="/qb64wiki/index.php/NEXT" title="NEXT"><span style="color:#4593D8;">NEXT</span></a> Py


' Main loop
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Press +/- to change opacity"

Level = 127
SetWindowOpacity MyHwnd, Level
DO
   Press$ = <a href="/qb64wiki/index.php/INKEY$" title="INKEY$"><span style="color:#4593D8;">INKEY$</span></a>
   <a href="/qb64wiki/index.php/LOCATE" title="LOCATE"><span style="color:#4593D8;">LOCATE</span></a> 2, 1: <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Opacity:"; Level

   ' Change window opacity whenever +/- are pressed
   <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Press$ = "+" <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> Level &lt; 255 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> Level = Level + 1: SetWindowOpacity MyHwnd, Level
   <a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> Press$ = "-" <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> Level &gt; 0 <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> Level = Level - 1: SetWindowOpacity MyHwnd, Level

   <a href="/qb64wiki/index.php/LIMIT" title="LIMIT"><span style="color:#4593D8;">_LIMIT</span></a> 60

<a href="/qb64wiki/index.php/LOOP" title="LOOP"><span style="color:#4593D8;">LOOP</span></a> <a href="/qb64wiki/index.php/UNTIL" title="UNTIL"><span style="color:#4593D8;">UNTIL</span></a> Press$ = <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(27)
<a href="/qb64wiki/index.php/SYSTEM" title="SYSTEM"><span style="color:#4593D8;">SYSTEM</span></a>


'====================================================================\
<a href="/qb64wiki/index.php/SUB" title="SUB"><span style="color:#4593D8;">SUB</span></a> SetWindowOpacity (hWnd <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>, Level)
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> Msg <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> G = -20
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> LWA_ALPHA = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>2
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> WS_EX_LAYERED = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80000

Msg = GetWindowLong(hWnd, G)
Msg = Msg <a href="/qb64wiki/index.php/OR_(boolean)" title="OR (boolean)"><span style="color:#4593D8;">OR</span></a> WS_EX_LAYERED
Crap = SetWindowLong(hWnd, G, Msg)
Crap = SetLayeredWindowAttributes(hWnd, 0, Level, LWA_ALPHA)

<a href="/qb64wiki/index.php/END_SUB" title="END SUB"><span style="color:#4593D8;">END SUB</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code by Jobert
       </span>
      </center>
      <p>
       <br/>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Windows_User">
        Windows User
       </span>
      </h2>
      <dl>
       <dd>
        Finds the current user's
        <i>
         My Documents
        </i>
        folder as a
        <a href="/qb64wiki/index.php/STRING" title="STRING">
         STRING
        </a>
        value. Other environmental constants are listed below code.
       </dd>
      </dl>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide">'public domain

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> MAX_PATH = 260             'maximum length of path string
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> CSIDL_PERSONAL = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>5       'User's My Documents path. See environmental constants below
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> SHGFP_TYPE_CURRENT = 0

<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> S_OK = 0                   'environmental value found
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> S_FALSE = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>1              'folder does not exist
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> E_FAILED = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80004005&amp;     'folder does not exist
<a href="/qb64wiki/index.php/CONST" title="CONST"><span style="color:#4593D8;">CONST</span></a> E_INVALIDARG = <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>80070057&amp; 'invalid argument parameter

<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE DYNAMIC LIBRARY</span></a> "shell32"
 <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> SHGetFolderPathA&amp; (<a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hwndOwner%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> nFolder&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> hToken%&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> dwFlags~&amp;, <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL"><span style="color:#4593D8;">BYVAL</span></a> pszPath%&amp;)
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> path <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/STRING" title="STRING"><span style="color:#4593D8;">STRING</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> hr <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>
<a href="/qb64wiki/index.php/DIM" title="DIM"><span style="color:#4593D8;">DIM</span></a> n <a href="/qb64wiki/index.php/AS" title="AS"><span style="color:#4593D8;">AS</span></a> <a href="/qb64wiki/index.php/LONG" title="LONG"><span style="color:#4593D8;">LONG</span></a>

path = <a href="/qb64wiki/index.php/STRING$" title="STRING$"><span style="color:#4593D8;">STRING$</span></a>(MAX_PATH, 0) 'enlarge the string to MAX_PATH

hr = SHGetFolderPathA(0, CSIDL_PERSONAL, 0, SHGFP_TYPE_CURRENT, <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)"><span style="color:#4593D8;">_OFFSET</span></a>(path))
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> hr <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a>
 <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "hresult: 0x" + <a href="/qb64wiki/index.php/LCASE$" title="LCASE$"><span style="color:#4593D8;">LCASE$</span></a>(<a href="/qb64wiki/index.php/HEX$" title="HEX$"><span style="color:#4593D8;">HEX$</span></a>(hr)) 'function returns non-zero error code
 <a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
<a class="mw-redirect" href="/qb64wiki/index.php/END_IF" title="END IF"><span style="color:#4593D8;">END IF</span></a>

n = <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(path, <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(0)) 'find terminating null

path = <a href="/qb64wiki/index.php/LEFT$" title="LEFT$"><span style="color:#4593D8;">LEFT$</span></a>(path, n - 1) 'shrink the string (probably creates a temp string)
<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>22); path; <a href="/qb64wiki/index.php/CHR$" title="CHR$"><span style="color:#4593D8;">CHR$</span></a>(<a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>22)
<a href="/qb64wiki/index.php/END" title="END"><span style="color:#4593D8;">END</span></a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Michael Calkins
       </span>
      </center>
      <dl>
       <dd>
        <i>
         Note:
        </i>
        When the SHGetFolderPathA&amp; function returns a non-zero value, the 0x hexadecimal error number is printed instead.
       </dd>
      </dl>
      <center>
       <b>
        <a class="external text" href="http://msdn.microsoft.com/en-us/library/bb776911(v=vs.85)" rel="nofollow">
         Vista and newer versions of Windows can also use SHGetKnownFolderPath and similar Constant values
        </a>
       </b>
      </center>
      <table cellpadding="5px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="outputfixed">                              <b>Windows CSIDL Environmental <a href="/qb64wiki/index.php/LONG" title="LONG">LONG</a> Constants</b>

 CONST CSIDL_DESKTOP = &amp;H0                  '&lt;user name&gt;\desktop
 CONST CSIDL_INTERNET = &amp;H1                 'Internet Explorer(icon on desktop)
 CONST CSIDL_PROGRAMS = &amp;H2                 '&lt;user name&gt;\Start Menu\Programs
 CONST CSIDL_CONTROLS = &amp;H3                 'My Computer\Control Panel icon group
 CONST CSIDL_PRINTERS = &amp;H4                 'My Computer\Printers (installed)
 CONST CSIDL_PERSONAL = &amp;H5                 '&lt;user name&gt;\My Documents
 CONST CSIDL_FAVORITES = &amp;H6                '&lt;user name&gt;\Favorites
 CONST CSIDL_STARTUP = &amp;H7                  '&lt;user name&gt;\Start Menu\Programs\Startup
 CONST CSIDL_RECENT = &amp;H8                   '&lt;user name&gt;\Recent
 CONST CSIDL_SENDTO = &amp;H9                   '&lt;user name&gt;\SendTo
 CONST CSIDL_BITBUCKET = &amp;HA                '&lt;user desktop&gt;\Recycle Bin
 CONST CSIDL_STARTMENU = &amp;HB                '&lt;user name&gt;\Start Menu
 CONST CSIDL_MYDOCUMENTS = &amp;HC              'logical "My Documents" desktop icon
 CONST CSIDL_MYMUSIC = &amp;HD                  '&lt;user name&gt;\My Documents\My Music folder
 CONST CSIDL_MYVIDEO = &amp;HE                  '&lt;user name&gt;\My Documents\My Videos folder
 CONST CSIDL_DESKTOPDIRECTORY = &amp;H10        '&lt;user name&gt;\Desktop
 CONST CSIDL_DRIVES = &amp;H11                  'My Computer
 CONST CSIDL_NETWORK = &amp;H12                 'Network Neighborhood (My Network Places)
 CONST CSIDL_NETHOOD = &amp;H13                 '&lt;user name&gt;\nethood
 CONST CSIDL_FONTS = &amp;H14                   'windows\fonts
 CONST CSIDL_TEMPLATES = &amp;H15               'templates
 CONST CSIDL_COMMON_STARTMENU = &amp;H16        'All Users\Start Menu
 CONST CSIDL_COMMON_PROGRAMS = &amp;H17         'All Users\Start Menu\Programs
 CONST CSIDL_COMMON_STARTUP = &amp;H18          'All Users\Startup
 CONST CSIDL_COMMON_DESKTOPDIRECTORY = &amp;H19 'All Users\Startup
 CONST CSIDL_APPDATA = &amp;H1A                 '&lt;user name&gt;\Application Data
 CONST CSIDL_PRINTHOOD = &amp;H1B               '&lt;user name&gt;\PrintHood
 CONST CSIDL_LOCAL_APPDATA = &amp;H1C           '&lt;user name&gt;\Local Settings\Application Data
 CONST CSIDL_ALTSTARTUP = &amp;H1D              'non-localized startup(Vista only)
 CONST CSIDL_COMMON_ALTSTARTUP = &amp;H1E       'common startup
 CONST CSIDL_COMMON_FAVORITES = &amp;H1F        'common startup
 CONST CSIDL_INTERNET_CACHE = &amp;H20          'common startup
 CONST CSIDL_COOKIES = &amp;H21                 'common startup
 CONST CSIDL_HISTORY = &amp;H22                 'common startup
 CONST CSIDL_COMMON_APPDATA = &amp;H23          'All Users\Application Data
 CONST CSIDL_WINDOWS = &amp;H24                 'GetWindowsDirectory()
 CONST CSIDL_SYSTEM = &amp;H25                  'GetSystemDirectory()
 CONST CSIDL_PROGRAM_FILES = &amp;H26           'C:\Program Files
 CONST CSIDL_MYPICTURES = &amp;H27              '&lt;user name&gt;\My Documents\My Pictures
 CONST CSIDL_PROFILE = &amp;H28                 'USERPROFILE
 CONST CSIDL_SYSTEMX86 = &amp;H29               'x86 C:\Windows\System32 or <a href="/qb64wiki/index.php/SysWOW64" title="SysWOW64">SysWOW64</a>(64 bit PC)
 CONST CSIDL_PROGRAM_FILESX86 = &amp;H2A        'x86 C:\Program Files on RISC
 CONST CSIDL_PROGRAM_FILES_COMMON = &amp;H2B    'C:\Program Files\Common
 CONST CSIDL_PROGRAM_FILES_COMMONX86 = &amp;H2C 'x86 Program Files\Common on RISC
 CONST CSIDL_COMMON_TEMPLATES = &amp;H2D        'All Users\Templates
 CONST CSIDL_COMMON_DOCUMENTS = &amp;H2E        'All Users\Documents
 CONST CSIDL_COMMON_ADMINTOOLS = &amp;H2F       'All Users\Start Menu\Programs\Administrative Tools
 CONST CSIDL_ADMINTOOLS = &amp;H30              '&lt;user name&gt;\Start Menu\Programs\Administrative Tools
 CONST CSIDL_CONNECTIONS = &amp;H31             'Network and Dial-up Connections
 CONST CSIDL_COMMON_MUSIC = &amp;H35            'All Users\My Music
 CONST CSIDL_COMMON_PICTURES = &amp;H36         'All Users\My Pictures
 CONST CSIDL_COMMON_VIDEO = &amp;H37            'All Users\My Video
 CONST CSIDL_RESOURCES = &amp;H38               'Resource Directory
 CONST CSIDL_RESOURCES_LOCALIZED = &amp;H39     'Localized Resource Directory
 CONST CSIDL_COMMON_OEM_LINKS = &amp;H3A        'Links to All Users OEM specific apps
 CONST CSIDL_CDBURN_AREA = &amp;H3B             'USERPROFILE\Local Settings\Application Data\Microsoft\CD Burning

                 'See: <a class="external text" href="http://msdn.microsoft.com/en-us/library/bb762181%28v=vs.85%29" rel="nofollow">http://msdn.microsoft.com/en-us/library/bb762181%28v=vs.85%29</a>
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="Windows_Version">
        Windows Version
       </span>
      </h2>
      <center>
       <b>
        Note that QB64 will not run on Windows 95 to ME computers currently!
       </b>
      </center>
      <table cellpadding="15px" width="100%">
       <tbody>
        <tr>
         <td>
          <pre class="codeide"><a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">DECLARE LIBRARY</span></a>
  <a href="/qb64wiki/index.php/FUNCTION" title="FUNCTION"><span style="color:#4593D8;">FUNCTION</span></a> GetVersion ()
<a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY"><span style="color:#4593D8;">END DECLARE</span></a>

'Just grab the "build" number...
b$ = <a href="/qb64wiki/index.php/LTRIM$" title="LTRIM$"><span style="color:#4593D8;">LTRIM$</span></a>(<a href="/qb64wiki/index.php/RTRIM$" title="RTRIM$"><span style="color:#4593D8;">RTRIM$</span></a>(<a href="/qb64wiki/index.php/STR$" title="STR$"><span style="color:#4593D8;">STR$</span></a>((GetVersion <a href="/qb64wiki/index.php/AND_(boolean)" title="AND (boolean)"><span style="color:#4593D8;">AND</span></a> <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>FFFF0000) \ <a href="/qb64wiki/index.php/%26H" title="&amp;H"><span style="color:#4593D8;">&amp;H</span></a>10000)))


<a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "The Windows version is: ";

<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "095") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows 95"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "1111") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows 95"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "1381") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows NT"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "1998") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows 98"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "2222") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows 98 SE"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "3000") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows ME"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "2195") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows 2000"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "2600") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows XP"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "3790") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows Server 2003"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "6000") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows Vista/Server"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "6001") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows Vista/Server"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "6002") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows Vista/Server"
<a href="/qb64wiki/index.php/IF...THEN" title="IF...THEN"><span style="color:#4593D8;">IF</span></a> <a href="/qb64wiki/index.php/INSTR" title="INSTR"><span style="color:#4593D8;">INSTR</span></a>(1, b$, "7600") <a href="/qb64wiki/index.php/THEN" title="THEN"><span style="color:#4593D8;">THEN</span></a> <a href="/qb64wiki/index.php/PRINT" title="PRINT"><span style="color:#4593D8;">PRINT</span></a> "Windows 7"
</pre>
         </td>
        </tr>
       </tbody>
      </table>
      <center>
       <span style="font-family: Courier New, Courier, monospace; font-size: 0.80em; line-height: 50%;">
        Code courtesy of Dav
       </span>
      </center>
      <p>
       <b>
        NOTE
       </b>
       : Microsoft depreciated GetVersion() for Windows 8 and higher -
       <a class="external text" href="https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-getversion" rel="nofollow">
        https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-getversion
       </a>
      </p>
      <p style="text-align: center">
       (
       <a href="#toc">
        Return to Table of Contents
       </a>
       )
      </p>
      <center>
       <b>
        Note: C++ Header files should be placed in the QB64 folder and are not required after a program is compiled.
       </b>
      </center>
      <p>
       <br/>
      </p>
      <center>
       <b>
        <span style="color:magenta;">
         Your code contribution using the Windows Libraries could end up here!
        </span>
       </b>
      </center>
      <p>
       <br/>
      </p>
      <h2>
       <span class="mw-headline" id="See_also">
        See also
       </span>
      </h2>
      <ul>
       <li>
        <a href="/qb64wiki/index.php/WINDOWHANDLE" title="WINDOWHANDLE">
         _WINDOWHANDLE
        </a>
       </li>
       <li>
        <a href="/qb64wiki/index.php/Windows_Environment" title="Windows Environment">
         Windows Environment
        </a>
       </li>
       <li>
        <a href="/qb64wiki/index.php/DECLARE_LIBRARY" title="DECLARE LIBRARY">
         DECLARE LIBRARY
        </a>
        ,
        <a class="mw-redirect" href="/qb64wiki/index.php/BYVAL" title="BYVAL">
         BYVAL
        </a>
        ,
        <a href="/qb64wiki/index.php/ALIAS" title="ALIAS">
         ALIAS
        </a>
       </li>
       <li>
        <a href="/qb64wiki/index.php/OFFSET" title="OFFSET">
         _OFFSET
        </a>
        ,
        <a href="/qb64wiki/index.php/OFFSET_(function)" title="OFFSET (function)">
         _OFFSET (function)
        </a>
       </li>
       <li>
        <a href="/qb64wiki/index.php/DLL_Libraries" title="DLL Libraries">
         DLL Libraries
        </a>
        ,
        <a href="/qb64wiki/index.php/C_Libraries" title="C Libraries">
         C Libraries
        </a>
       </li>
       <li>
        <a href="/qb64wiki/index.php/Libraries#C++_Variable_Types" title="Libraries">
         C++ Variable Types
        </a>
       </li>
       <li>
        <a href="/qb64wiki/index.php/Windows_Printer_Settings" title="Windows Printer Settings">
         Windows Printer Settings
        </a>
       </li>
      </ul>
      <p>
       <br/>
      </p>
      <hr/>
      <center>
       <b>
        Navigation:
       </b>
      </center>
      <center>
       <a href="/qb64wiki/index.php/Main_Page" title="Main Page">
        Main Page with Articles and Tutorials
       </a>
      </center>
      <center>
       <a href="/qb64wiki/index.php/Keyword_Reference_-_Alphabetical" title="Keyword Reference - Alphabetical">
        Keyword Reference - Alphabetical
       </a>
      </center>
      <center>
       <a href="/qb64wiki/index.php/Keyword_Reference_-_By_usage" title="Keyword Reference - By usage">
        Keyword Reference - By usage
       </a>
      </center>
      <center>
       <b>
        <a class="external text" href="https://qb64phoenix.com/forum/showthread.php?tid=2800" rel="nofollow">
         Report a broken link
        </a>
       </b>
       <br/>
      </center>
      <!-- 
NewPP limit report
Cached time: 20240721103947
Cache expiry: 86400
Reduced expiry: false
Complications: []
CPU time usage: 1.155 seconds
Real time usage: 1.180 seconds
Preprocessor visited node count: 30619/1000000
Post‐expand include size: 178901/2097152 bytes
Template argument size: 35795/2097152 bytes
Highest expansion depth: 3/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 32/5000000 bytes
-->
      <!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  300.812      1 -total
 39.59%  119.101   3007 Template:Cl
  5.06%   15.232    314 Template:Cb
  0.84%    2.538      4 Template:TextStart
  0.80%    2.402      3 Template:Text
  0.80%    2.402     35 Template:Small
  0.75%    2.263      1 Template:PageSeeAlso
  0.75%    2.259      3 Template:TextEnd
  0.73%    2.185     39 Template:CodeEnd
  0.67%    2.026     38 Template:CodeStart
-->
      <!-- Saved in parser cache with key qb64pnix_mw19894-mwmb_:pcache:idhash:18-0!canonical and timestamp 20240721103946 and revision id 8807.
 -->
     </div>
     <div class="printfooter" data-nosnippet="">
      Retrieved from "
      <a dir="ltr" href="https://qb64phoenix.com/qb64wiki/index.php?title=Windows_Libraries&amp;oldid=8807">
       https://qb64phoenix.com/qb64wiki/index.php?title=Windows_Libraries&amp;oldid=8807
      </a>
      "
     </div>
    </div>
    <div class="catlinks catlinks-allhidden" data-mw="interface" id="catlinks">
    </div>
   </div>
  </div>
  <div id="mw-navigation">
   <h2>
    Navigation menu
   </h2>
   <div id="mw-head">
    <nav aria-labelledby="p-personal-label" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu-legacy" id="p-personal" role="navigation">
     <h3 class="vector-menu-heading" id="p-personal-label">
      <span class="vector-menu-heading-label">
       Personal tools
      </span>
     </h3>
     <div class="vector-menu-content">
      <ul class="vector-menu-content-list">
       <li class="mw-list-item" id="pt-login">
        <a accesskey="o" href="/qb64wiki/index.php?title=Special:UserLogin&amp;returnto=Windows+Libraries" title="You are encouraged to log in; however, it is not mandatory [o]">
         <span>
          Log in
         </span>
        </a>
       </li>
      </ul>
     </div>
    </nav>
    <div id="left-navigation">
     <nav aria-labelledby="p-namespaces-label" class="vector-menu mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy" id="p-namespaces" role="navigation">
      <h3 class="vector-menu-heading" id="p-namespaces-label">
       <span class="vector-menu-heading-label">
        Namespaces
       </span>
      </h3>
      <div class="vector-menu-content">
       <ul class="vector-menu-content-list">
        <li class="selected mw-list-item" id="ca-nstab-main">
         <a accesskey="c" href="/qb64wiki/index.php/Windows_Libraries" title="View the content page [c]">
          <span>
           Page
          </span>
         </a>
        </li>
        <li class="new mw-list-item" id="ca-talk">
         <a accesskey="t" href="/qb64wiki/index.php?title=Talk:Windows_Libraries&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]">
          <span>
           Discussion
          </span>
         </a>
        </li>
       </ul>
      </div>
     </nav>
     <nav aria-labelledby="p-variants-label" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown" id="p-variants" role="navigation">
      <input aria-haspopup="true" aria-labelledby="p-variants-label" class="vector-menu-checkbox" data-event-name="ui.dropdown-p-variants" id="p-variants-checkbox" role="button" type="checkbox"/>
      <label aria-label="Change language variant" class="vector-menu-heading" id="p-variants-label">
       <span class="vector-menu-heading-label">
        English
       </span>
      </label>
      <div class="vector-menu-content">
       <ul class="vector-menu-content-list">
       </ul>
      </div>
     </nav>
    </div>
    <div id="right-navigation">
     <nav aria-labelledby="p-views-label" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy" id="p-views" role="navigation">
      <h3 class="vector-menu-heading" id="p-views-label">
       <span class="vector-menu-heading-label">
        Views
       </span>
      </h3>
      <div class="vector-menu-content">
       <ul class="vector-menu-content-list">
        <li class="selected mw-list-item" id="ca-view">
         <a href="/qb64wiki/index.php/Windows_Libraries">
          <span>
           Read
          </span>
         </a>
        </li>
        <li class="mw-list-item" id="ca-viewsource">
         <a accesskey="e" href="/qb64wiki/index.php?title=Windows_Libraries&amp;action=edit" title="This page is protected.
You can view its source [e]">
          <span>
           View source
          </span>
         </a>
        </li>
        <li class="mw-list-item" id="ca-history">
         <a accesskey="h" href="/qb64wiki/index.php?title=Windows_Libraries&amp;action=history" title="Past revisions of this page [h]">
          <span>
           View history
          </span>
         </a>
        </li>
       </ul>
      </div>
     </nav>
     <nav aria-labelledby="p-cactions-label" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown" id="p-cactions" role="navigation" title="More options">
      <input aria-haspopup="true" aria-labelledby="p-cactions-label" class="vector-menu-checkbox" data-event-name="ui.dropdown-p-cactions" id="p-cactions-checkbox" role="button" type="checkbox"/>
      <label class="vector-menu-heading" id="p-cactions-label">
       <span class="vector-menu-heading-label">
        More
       </span>
      </label>
      <div class="vector-menu-content">
       <ul class="vector-menu-content-list">
       </ul>
      </div>
     </nav>
     <div class="vector-search-box-vue vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box" id="p-search" role="search">
      <div>
       <h3>
        <label for="searchInput">
         Search
        </label>
       </h3>
       <form action="/qb64wiki/index.php" class="vector-search-box-form" id="searchform">
        <div class="vector-search-box-inner" data-search-loc="header-navigation" id="simpleSearch">
         <input accesskey="f" aria-label="Search QB64 Phoenix Edition Wiki" autocapitalize="sentences" class="vector-search-box-input" id="searchInput" name="search" placeholder="Search QB64 Phoenix Edition Wiki" title="Search QB64 Phoenix Edition Wiki [f]" type="search"/>
         <input name="title" type="hidden" value="Special:Search"/>
         <input class="searchButton mw-fallbackSearchButton" id="mw-searchButton" name="fulltext" title="Search the pages for this text" type="submit" value="Search"/>
         <input class="searchButton" id="searchButton" name="go" title="Go to a page with this exact name if it exists" type="submit" value="Go"/>
        </div>
       </form>
      </div>
     </div>
    </div>
   </div>
   <div id="mw-panel">
    <div id="p-logo" role="banner">
     <a class="mw-wiki-logo" href="/qb64wiki/index.php/Main_Page" title="Visit the main page">
     </a>
    </div>
    <nav aria-labelledby="p-navigation-label" class="vector-menu mw-portlet mw-portlet-navigation vector-menu-portal portal" id="p-navigation" role="navigation">
     <h3 class="vector-menu-heading" id="p-navigation-label">
      <span class="vector-menu-heading-label">
       Navigation
      </span>
     </h3>
     <div class="vector-menu-content">
      <ul class="vector-menu-content-list">
       <li class="mw-list-item" id="n-mainpage-description">
        <a accesskey="z" href="/qb64wiki/index.php/Main_Page" title="Visit the main page [z]">
         <span>
          Main page
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="n-recentchanges">
        <a accesskey="r" href="/qb64wiki/index.php/Special:RecentChanges" title="A list of recent changes in the wiki [r]">
         <span>
          Recent changes
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="n-randompage">
        <a accesskey="x" href="/qb64wiki/index.php/Special:Random" title="Load a random page [x]">
         <span>
          Random page
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="n-help-mediawiki">
        <a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents">
         <span>
          Help about MediaWiki
         </span>
        </a>
       </li>
      </ul>
     </div>
    </nav>
    <nav aria-labelledby="p-tb-label" class="vector-menu mw-portlet mw-portlet-tb vector-menu-portal portal" id="p-tb" role="navigation">
     <h3 class="vector-menu-heading" id="p-tb-label">
      <span class="vector-menu-heading-label">
       Tools
      </span>
     </h3>
     <div class="vector-menu-content">
      <ul class="vector-menu-content-list">
       <li class="mw-list-item" id="t-whatlinkshere">
        <a accesskey="j" href="/qb64wiki/index.php/Special:WhatLinksHere/Windows_Libraries" title="A list of all wiki pages that link here [j]">
         <span>
          What links here
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="t-recentchangeslinked">
        <a accesskey="k" href="/qb64wiki/index.php/Special:RecentChangesLinked/Windows_Libraries" rel="nofollow" title="Recent changes in pages linked from this page [k]">
         <span>
          Related changes
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="t-specialpages">
        <a accesskey="q" href="/qb64wiki/index.php/Special:SpecialPages" title="A list of all special pages [q]">
         <span>
          Special pages
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="t-print">
        <a accesskey="p" href="javascript:print();" rel="alternate" title="Printable version of this page [p]">
         <span>
          Printable version
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="t-permalink">
        <a href="/qb64wiki/index.php?title=Windows_Libraries&amp;oldid=8807" title="Permanent link to this revision of this page">
         <span>
          Permanent link
         </span>
        </a>
       </li>
       <li class="mw-list-item" id="t-info">
        <a href="/qb64wiki/index.php?title=Windows_Libraries&amp;action=info" title="More information about this page">
         <span>
          Page information
         </span>
        </a>
       </li>
      </ul>
     </div>
    </nav>
   </div>
  </div>
  <footer class="mw-footer" id="footer" role="contentinfo">
   <ul id="footer-info">
    <li id="footer-info-lastmod">
     This page was last edited on 27 February 2024, at 23:02.
    </li>
   </ul>
   <ul id="footer-places">
    <li id="footer-places-privacy">
     <a href="/qb64wiki/index.php/QB64_Phoenix_Edition_Wiki:Privacy_policy">
      Privacy policy
     </a>
    </li>
    <li id="footer-places-about">
     <a href="/qb64wiki/index.php/QB64_Phoenix_Edition_Wiki:About">
      About QB64 Phoenix Edition Wiki
     </a>
    </li>
    <li id="footer-places-disclaimer">
     <a href="/qb64wiki/index.php/QB64_Phoenix_Edition_Wiki:General_disclaimer">
      Disclaimers
     </a>
    </li>
   </ul>
   <ul class="noprint" id="footer-icons">
    <li id="footer-poweredbyico">
     <a href="https://www.mediawiki.org/">
      <img alt="Powered by MediaWiki" height="31" loading="lazy" src="/qb64wiki/resources/assets/poweredby_mediawiki_88x31.png" srcset="/qb64wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /qb64wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88"/>
     </a>
    </li>
   </ul>
  </footer>
  <script>
   (RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"1.155","walltime":"1.180","ppvisitednodes":{"value":30619,"limit":1000000},"postexpandincludesize":{"value":178901,"limit":2097152},"templateargumentsize":{"value":35795,"limit":2097152},"expansiondepth":{"value":3,"limit":100},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":32,"limit":5000000},"timingprofile":["100.00%  300.812      1 -total"," 39.59%  119.101   3007 Template:Cl","  5.06%   15.232    314 Template:Cb","  0.84%    2.538      4 Template:TextStart","  0.80%    2.402      3 Template:Text","  0.80%    2.402     35 Template:Small","  0.75%    2.263      1 Template:PageSeeAlso","  0.75%    2.259      3 Template:TextEnd","  0.73%    2.185     39 Template:CodeEnd","  0.67%    2.026     38 Template:CodeStart"]},"cachereport":{"timestamp":"20240721103947","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":124});});
  </script>
 </body>
</html>
